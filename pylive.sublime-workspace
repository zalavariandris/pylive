{
	"auto_complete":
	{
		"selected_items":
		[
			[
				"out",
				"outletGraphicsObject"
			],
			[
				"outl",
				"outletGraphicsObject"
			],
			[
				"P",
				"PenStyle"
			],
			[
				"Networ",
				"NetrowkXGraphEditor"
			],
			[
				"NotImpl",
				"NotImplementedError"
			],
			[
				"child",
				"childrenBoundingRect"
			],
			[
				"oute",
				"outletAt"
			],
			[
				"Qpoin",
				"QPointF"
			],
			[
				"Outlet",
				"OutletGraphicsObject"
			],
			[
				"setAcc",
				"setAcceptHoverEvents"
			],
			[
				"item",
				"itemAt"
			],
			[
				"ungrab",
				"ungrabMouse"
			],
			[
				"Link",
				"LinkGraphicsObject"
			],
			[
				"NotIm",
				"NotImplementedError"
			],
			[
				"isin",
				"isinstance"
			],
			[
				"outlet",
				"outletGraphicsObject"
			],
			[
				"mapFro",
				"mapFromScene"
			],
			[
				"Inlet",
				"InletGraphicsObject"
			],
			[
				"GraphicsSceneMou",
				"GraphicsSceneMousePress"
			],
			[
				"scene",
				"_scene"
			],
			[
				"GraphicsN",
				"GraphicsNodeItem"
			],
			[
				"NXGraphScen",
				"NXGraphSceneMouseTool"
			],
			[
				"make",
				"make_fillet_path"
			],
			[
				"ar",
				"arcMoveTo"
			],
			[
				"mapFrom",
				"mapFromParent"
			],
			[
				"arcTo",
				"arcMoveTo"
			],
			[
				"_in",
				"_inlet_graphics_objects"
			],
			[
				"_inl",
				"_inlet_graphics_objects"
			],
			[
				"nx_grp",
				"nx_graph_graphics_items"
			],
			[
				"Gra",
				"GraphicsPortItem"
			],
			[
				"Graphics",
				"GraphicsVertexItem"
			],
			[
				"graph",
				"graphscene"
			],
			[
				"onNode",
				"onNodeDeleted"
			],
			[
				"onC",
				"onNodeCreated"
			],
			[
				"node",
				"nodesAdded"
			],
			[
				"onLink",
				"onLinkDeleted"
			],
			[
				"edge",
				"edgesAdded"
			],
			[
				"inde",
				"ItemIndexMethod"
			],
			[
				"add",
				"addNode"
			],
			[
				"update",
				"updateAttachedNodes"
			],
			[
				"getN",
				"getNodeProperty"
			],
			[
				"Nx",
				"NXGraphModel"
			],
			[
				"Connection",
				"ConnectionType"
			],
			[
				"Node",
				"NodeGraphicsObject"
			],
			[
				"Item",
				"ItemScenePositionHasChanged"
			],
			[
				"Vertex",
				"VertexElement"
			],
			[
				"Fla",
				"GraphicsItemFlag"
			],
			[
				"setAcce",
				"setAcceptHoverEvents"
			],
			[
				"gr",
				"createItemGroup"
			],
			[
				"GraphicsO",
				"GraphicsPortItem"
			],
			[
				"setL",
				"setLine"
			],
			[
				"QFo",
				"QFont"
			],
			[
				"create",
				"createAttributeEditor"
			],
			[
				"mous",
				"mouseMoveEvent"
			],
			[
				"Mous",
				"MouseButtonPress"
			],
			[
				"T",
				"Type"
			],
			[
				"ins",
				"installEventFilter"
			],
			[
				"_a",
				"_attribute_to_widget_map"
			],
			[
				"parent",
				"parentItem"
			],
			[
				"QFileO",
				"QFileDialog"
			],
			[
				"edge_",
				"_edge_to_widget_map"
			],
			[
				"_widget_to",
				"_widget_to_node_map"
			],
			[
				"up",
				"updateEdgePosition"
			],
			[
				"setAccep",
				"setAcceptHoverEvents"
			],
			[
				"Att",
				"AttributeError"
			],
			[
				"hei",
				"height"
			],
			[
				"setB",
				"setBrush"
			],
			[
				"chil",
				"childrenBoundingRect"
			],
			[
				"NXGra",
				"NXGraphView"
			],
			[
				"_wi",
				"_widget_to_node_map"
			],
			[
				"nodes",
				"nodesPropertiesChanged"
			],
			[
				"setP",
				"setParentItem"
			],
			[
				"_widg",
				"_widget_to_node_map"
			],
			[
				"remove",
				"removeEdge"
			],
			[
				"hover",
				"hoverMoveEvent"
			],
			[
				"isEnd",
				"_isEndHighlighted"
			],
			[
				"widget_t",
				"_widget_to_edge_map"
			],
			[
				"shape",
				"shape_bbox"
			],
			[
				"Connect",
				"ConnectionEvent"
			],
			[
				"model",
				"_model"
			],
			[
				"widget_",
				"_widget_to_node_map"
			],
			[
				"QGraphicsS",
				"QGraphicsScene"
			],
			[
				"pyl",
				"pylive"
			],
			[
				"ConnectionL",
				"ConnectionLeaveType"
			],
			[
				"setSiz",
				"setSizePolicy"
			],
			[
				"se",
				"setAlignment"
			],
			[
				"main",
				"main_layout"
			],
			[
				"header",
				"header_widget"
			],
			[
				"outlet_",
				"outlet_row"
			],
			[
				"QGraphicsLi",
				"QGraphicsLinearLayout"
			],
			[
				"inlet_r",
				"inlet_row_layout"
			],
			[
				"QGraphicsLine",
				"QGraphicsLinearLayout"
			],
			[
				"QGraph",
				"QGraphicsLayout"
			],
			[
				"Q",
				"QGraphicsLinearLayout"
			],
			[
				"size",
				"sizeHint"
			],
			[
				"inlet",
				"inlet_layout"
			],
			[
				"inle",
				"inlet_layout"
			],
			[
				"GraphicsMou",
				"GraphicsSceneMousePress"
			],
			[
				"sceneEven",
				"sceneEventFilter"
			],
			[
				"instal",
				"installSceneEventFilter"
			],
			[
				"NodeW",
				"NodeWidget2"
			],
			[
				"Arrow",
				"QGraphicsArrowItem"
			],
			[
				"_node",
				"_node_edges"
			],
			[
				"trigg",
				"triggered"
			],
			[
				"tri",
				"triggered"
			],
			[
				"setS",
				"setStyle"
			],
			[
				"QMenu",
				"QMenuBar"
			],
			[
				"text",
				"textChanged"
			],
			[
				"_edg",
				"_edge_targets"
			],
			[
				"nx",
				"nx_inspector_view"
			],
			[
				"ce",
				"cellWidget"
			],
			[
				"itemA",
				"itemAt"
			],
			[
				"QTableW",
				"QTableWidgetItem"
			],
			[
				"QTable",
				"QTableWidgetItem"
			],
			[
				"on_",
				"on_item_changed"
			],
			[
				"clear",
				"clearContents"
			],
			[
				"QAbleW",
				"QTableWidgetItem"
			],
			[
				"setVer",
				"setVerticalHeaderItem"
			],
			[
				"inser",
				"insertRow"
			],
			[
				"set",
				"setText"
			],
			[
				"upda",
				"updateView"
			],
			[
				"patch_",
				"patch_list"
			],
			[
				"dic",
				"dict_diff"
			],
			[
				"begin",
				"beginInsertRows"
			],
			[
				"nodelist",
				"nodelistview"
			],
			[
				"nodel",
				"nodelist"
			],
			[
				"QStan",
				"QStandardItemModel"
			],
			[
				"attri",
				"attribute_list"
			]
		]
	},
	"buffers":
	[
		{
			"file": "pylive/NetworkXGraphEditor/nx_network_scene.py",
			"settings":
			{
				"buffer_size": 16231,
				"encoding": "UTF-8",
				"line_ending": "Windows"
			},
			"undo_stack":
			[
				[
					1373,
					1,
					"cut",
					null,
					"AQAAACw8AAAAAAAALDwAAAAAAADVAQAAZGVmIG1vdmUoCiAgICAgICAgc2VsZiwKICAgICAgICBzb3VyY2VfZ3JhcGhpY3NfaXRlbTogUUdyYXBoaWNzSXRlbSwKICAgICAgICB0YXJnZXRfZ3JhcGhpY3NfaXRlbTogUUdyYXBoaWNzSXRlbSwKICAgICk6CiAgICAgICAgbGluZSA9IG1ha2VMaW5lQmV0d2VlblNoYXBlcyhzb3VyY2VfZ3JhcGhpY3NfaXRlbSwgdGFyZ2V0X2dyYXBoaWNzX2l0ZW0pCiAgICAgICAgbGVuZ3RoID0gbGluZS5sZW5ndGgoKQogICAgICAgIGlmIGxlbmd0aCA+IDA6CiAgICAgICAgICAgIG9mZnNldCA9IG1pbig4LCBsZW5ndGggLyAyKQogICAgICAgICAgICBsaW5lID0gUUxpbmVGKAogICAgICAgICAgICAgICAgbGluZS5wb2ludEF0KG9mZnNldCAvIGxlbmd0aCksCiAgICAgICAgICAgICAgICBsaW5lLnBvaW50QXQoKGxlbmd0aCAtIG9mZnNldCkgLyBsZW5ndGgpLAogICAgICAgICAgICApCgogICAgICAgIHNlbGYuc2V0TGluZShsaW5lKQ",
					"AQAAAAAAAAABAAAAAT4AAAAAAAAsPAAAAAAAAAAAAAAAAPC/"
				],
				[
					1376,
					2,
					"left_delete",
					null,
					"AgAAACw8AAAAAAAALDwAAAAAAAABAAAACig8AAAAAAAAKDwAAAAAAAAEAAAAICAgIA",
					"AQAAAAAAAAABAAAALTwAAAAAAAAtPAAAAAAAAAAAAAAAAPC/"
				],
				[
					1378,
					1,
					"left_delete",
					null,
					"AQAAACc8AAAAAAAAJzwAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAAKDwAAAAAAAAoPAAAAAAAAAAAAAAAAPC/"
				],
				[
					1389,
					1,
					"cut",
					null,
					"AQAAAJ0CAAAAAAAAnQIAAAAAAAAyAAAAZnJvbSBweWxpdmUudXRpbHMuZ2VvIGltcG9ydCBtYWtlTGluZUJldHdlZW5TaGFwZXM",
					"AQAAAAAAAAABAAAAzwIAAAAAAACdAgAAAAAAAAAAAAAAAPC/"
				],
				[
					1391,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAzz8AAAAAAADQPwAAIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgVGhlIE5ldHdvcmsgU2NlbmUgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiMKIyBBICdWaWV3JyB0byByZXByZXNlbnQgYSBuZXR3b3JrIG9mIG5vZGVzLCBjb25uZWN0ZWQgYnkgaW5sZXRzIGFuZCBvdXRsZXRzCiMKCiMgSW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoaXMgaXMgYSAnVmlldycuCiMgSXQgaXMgcmVzcG9uc2libGUgdG8gcHJlc2VudCAoYW5kIHBvdGVudGlhbGx5IGVkaXQpIHRoZSBOWEdyYXBoTW9kZWwKIyBHcmFwaFNjZW5lICdpbnRlcm5hbHknIHVzZXMgc3ViY2xhc3NlcyBvZiBHcmFwaFNoYXBlcyB0aGF0IGFyZSBhbHNvICd2aWV3cycuCiMgdGhlc2Ugd2lkZ2V0cyBhcmUgcmVzcG9uc2libGUgdG8gcmVmZXJlbmNlIHRoZSBncmFwaHNjZW5lLAojIGFuZCB0aGUgcmVwcmVzZW50ZWQgbm9kZXMsIGVkZ2UgYW5kIHBvcnRzLgojCiMgVE9ETzogbW92ZSB0aGUgbW9kZWwgZWRpdGluZyBjYXBhYmlsaXRpZXMKIyBmcm9tIHRoZSB3aWRnZXRzIHRvIGEgZGVsZWdhdGUsIG9yIHRoZSBncmFwaHNlbmUgaXRzZWxmCgoKZnJvbSB0eXBpbmcgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0R3VpIGltcG9ydCAqCmZyb20gUHlTaWRlNi5RdENvcmUgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0V2lkZ2V0cyBpbXBvcnQgKgoKCgpDb25uZWN0aW9uRW50ZXJUeXBlID0gUUV2ZW50LlR5cGUoUUV2ZW50LnJlZ2lzdGVyRXZlbnRUeXBlKCkpCkNvbm5lY3Rpb25MZWF2ZVR5cGUgPSBRRXZlbnQuVHlwZShRRXZlbnQucmVnaXN0ZXJFdmVudFR5cGUoKSkKQ29ubmVjdGlvbk1vdmVUeXBlID0gUUV2ZW50LlR5cGUoUUV2ZW50LnJlZ2lzdGVyRXZlbnRUeXBlKCkpCkNvbm5lY3Rpb25Ecm9wVHlwZSA9IFFFdmVudC5UeXBlKFFFdmVudC5yZWdpc3RlckV2ZW50VHlwZSgpKQoKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBuZXR3b3JreCBhcyBueAoKCiMjIyMjIyMjIyMjIyMjIyMjIwojIEdSQVBISUNTIElURU1TICMKIyMjIyMjIyMjIyMjIyMjIyMjCgpmcm9tIHB5bGl2ZS5OZXR3b3JrWEdyYXBoRWRpdG9yLm54X2dyYXBoX3NoYXBlcyBpbXBvcnQgKAogICAgTm9kZVNoYXBlLAogICAgTGlua1NoYXBlLAogICAgUG9ydFNoYXBlLAopCgoKIyMjIyMjIyMjIyMjIyMKIyBHUkFQSFNDRU5FICMKIyMjIyMjIyMjIyMjIyMKCmZyb20gcHlsaXZlLk5ldHdvcmtYR3JhcGhFZGl0b3IubnhfZ3JhcGhfbW9kZWwgaW1wb3J0IE5YR3JhcGhNb2RlbAoKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCgp0eXBlIE5vZGVJZCA9IEhhc2hhYmxlCgoKQGRhdGFjbGFzcyhmcm96ZW49VHJ1ZSkKY2xhc3MgT3V0bGV0SWQ6CiAgICBub2RlSWQ6IE5vZGVJZAogICAgbmFtZTogc3RyCgoKQGRhdGFjbGFzcyhmcm96ZW49VHJ1ZSkKY2xhc3MgSW5sZXRJZDoKICAgIG5vZGVJZDogTm9kZUlkCiAgICBuYW1lOiBzdHIKCgp0eXBlIExpbmtJZCA9IHR1cGxlW05vZGVJZCwgTm9kZUlkLCB0dXBsZVtzdHIsIHN0cl1dCgoKY2xhc3MgTlhHcmFwaFNjZW5lKFFHcmFwaGljc1NjZW5lKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtb2RlbDogTlhHcmFwaE1vZGVsKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLl9tb2RlbCA9IG1vZGVsCiAgICAgICAgc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzOiBkaWN0W05vZGVJZCwgTm9kZUdyYXBoaWNzT2JqZWN0XSA9IGRpY3QoKQogICAgICAgIHNlbGYuX2lubGV0X2dyYXBoaWNzX29iamVjdHM6IGRpY3RbCiAgICAgICAgICAgIElubGV0SWQsIElubGV0R3JhcGhpY3NPYmplY3QKICAgICAgICBdID0gZGljdCgpCiAgICAgICAgc2VsZi5fb3V0bGV0X2dyYXBoaWNzX29iamVjdHM6IGRpY3RbCiAgICAgICAgICAgIE91dGxldElkLCBPdXRsZXRHcmFwaGljc09iamVjdAogICAgICAgIF0gPSBkaWN0KCkKICAgICAgICBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHM6IGRpY3RbTGlua0lkLCBMaW5rR3JhcGhpY3NPYmplY3RdID0gZGljdCgpCiAgICAgICAgc2VsZi5fZHJhZnRfbGluazogTGlua0dyYXBoaWNzT2JqZWN0IHwgTm9uZSA9IE5vbmUKCiAgICAgICAgc2VsZi5zZXRJdGVtSW5kZXhNZXRob2QoUUdyYXBoaWNzU2NlbmUuSXRlbUluZGV4TWV0aG9kLk5vSW5kZXgpCgogICAgICAgIHNlbGYuX21vZGVsLm5vZGVzQWRkZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIG5vZGVzOiBbc2VsZi5vbk5vZGVDcmVhdGVkKG4pIGZvciBuIGluIG5vZGVzXQogICAgICAgICkKICAgICAgICBzZWxmLl9tb2RlbC5ub2Rlc0Fib3V0VG9CZVJlbW92ZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIG5vZGVzOiBbc2VsZi5vbk5vZGVEZWxldGVkKG4pIGZvciBuIGluIG5vZGVzXQogICAgICAgICkKICAgICAgICBzZWxmLl9tb2RlbC5lZGdlc0FkZGVkLmNvbm5lY3QoCiAgICAgICAgICAgIGxhbWJkYSBlZGdlczogW3NlbGYub25MaW5rQ3JlYXRlZChlKSBmb3IgZSBpbiBlZGdlc10KICAgICAgICApCiAgICAgICAgc2VsZi5fbW9kZWwuZWRnZXNBYm91dFRvQmVSZW1vdmVkLmNvbm5lY3QoCiAgICAgICAgICAgIGxhbWJkYSBlZGdlczogW3NlbGYub25MaW5rRGVsZXRlZChlKSBmb3IgZSBpbiBlZGdlc10KICAgICAgICApCgogICAgICAgIHNlbGYudHJhdmVyc2VHcmFwaEFuZFBvcHVsYXRlR3JhcGhpY3NPYmplY3RzKCkKICAgICAgICBzZWxmLmRyYWZ0OiBMaW5rU2hhcGUgfCBOb25lID0gTm9uZSAgIyB0b2RvIHVzZSB0aGUgd2lkZ2V0IGl0c2VsZgogICAgICAgIHNlbGYubGF5b3V0KCkKCiAgICBkZWYgdHJhdmVyc2VHcmFwaEFuZFBvcHVsYXRlR3JhcGhpY3NPYmplY3RzKHNlbGYpOgogICAgICAgIGFsbE5vZGVJZHM6IGxpc3RbTm9kZUlkXSA9IHNlbGYuX21vZGVsLm5vZGVzKCkKCiAgICAgICAgIyBGaXJzdCBjcmVhdGUgYWxsIHRoZSBub2Rlcy4KICAgICAgICBmb3Igbm9kZUlkIGluIGFsbE5vZGVJZHM6CiAgICAgICAgICAgIHNlbGYub25Ob2RlQ3JlYXRlZChub2RlSWQpCgogICAgICAgIGZvciBlIGluIHNlbGYuX21vZGVsLmVkZ2VzKCk6CiAgICAgICAgICAgIHUsIHYsIChvLCBpKSA9IGUKICAgICAgICAgICAgYXNzZXJ0IHUgaW4gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzCiAgICAgICAgICAgIGFzc2VydCB2IGluIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cwogICAgICAgICAgICBhc3NlcnQgKAogICAgICAgICAgICAgICAgT3V0bGV0SWQodSwgbykgaW4gc2VsZi5fb3V0bGV0X2dyYXBoaWNzX29iamVjdHMKICAgICAgICAgICAgKSwgZiJOb2RlICd7dX0nIGhhcyBubyBvdXRsZXQgJ3tvfSchIgogICAgICAgICAgICBhc3NlcnQgKAogICAgICAgICAgICAgICAgSW5sZXRJZCh2LCBpKSBpbiBzZWxmLl9pbmxldF9ncmFwaGljc19vYmplY3RzCiAgICAgICAgICAgICksIGYiTm9kZSAne3Z9JyBoYXMgbm8gaW5sZXQgJ3tpfSchIgoKICAgICAgICAgICAgbGluayA9IExpbmtHcmFwaGljc09iamVjdCgodSwgdiwgKG8sIGkpKSkKICAgICAgICAgICAgc2VsZi5fbGlua19ncmFwaGljc19vYmplY3RzWyh1LCB2LCAobywgaSkpXSA9IGxpbmsKICAgICAgICAgICAgc2VsZi5hZGRJdGVtKGxpbmspCgogICAgICAgICAgICBsaW5rLm1vdmUoCiAgICAgICAgICAgICAgICBzZWxmLm91dGxldEdyYXBoaWNzT2JqZWN0KE91dGxldElkKHUsIG8pKSwKICAgICAgICAgICAgICAgIHNlbGYuaW5sZXRHcmFwaGljc09iamVjdChJbmxldElkKHYsIGkpKSwKICAgICAgICAgICAgKQoKICAgIGRlZiBsaW5rR3JhcGhpY3NPYmplY3Qoc2VsZiwgZTogTGlua0lkKSAtPiAiTGlua0dyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gc2VsZi5fbGlua19ncmFwaGljc19vYmplY3RzW2VdCgogICAgZGVmIG5vZGVHcmFwaGljc09iamVjdChzZWxmLCBuOiBOb2RlSWQpIC0+ICJOb2RlR3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHNbbl0KCiAgICBkZWYgaW5sZXRHcmFwaGljc09iamVjdChzZWxmLCBpOiBJbmxldElkKSAtPiAiSW5sZXRHcmFwaGljc09iamVjdCI6CiAgICAgICAgcmV0dXJuIHNlbGYuX2lubGV0X2dyYXBoaWNzX29iamVjdHNbaV0KCiAgICBkZWYgb3V0bGV0R3JhcGhpY3NPYmplY3Qoc2VsZiwgbzogT3V0bGV0SWQpIC0+ICJPdXRsZXRHcmFwaGljc09iamVjdCI6CiAgICAgICAgcmV0dXJuIHNlbGYuX291dGxldF9ncmFwaGljc19vYmplY3RzW29dCgogICAgZGVmIHVwZGF0ZUF0dGFjaGVkTm9kZXMoc2VsZiwgZTogTGlua0lkLCBraW5kOiBMaXRlcmFsWyJpbiIsICJvdXQiXSk6CiAgICAgICAgdSwgdiwgayA9IGUKICAgICAgICBtYXRjaCBraW5kOgogICAgICAgICAgICBjYXNlICJpbiI6CiAgICAgICAgICAgICAgICBpZiBub2RlIDo9IHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cy5nZXQodSwgTm9uZSk6CiAgICAgICAgICAgICAgICAgICAgbm9kZS51cGRhdGUoKQogICAgICAgICAgICBjYXNlICJvdXQiOgogICAgICAgICAgICAgICAgaWYgbm9kZSA6PSBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHMuZ2V0KHYsIE5vbmUpOgogICAgICAgICAgICAgICAgICAgIG5vZGUudXBkYXRlKCkKCiAgICBkZWYgaXNMaW5rZWQoc2VsZiwgcG9ydDogSW5sZXRJZCB8IE91dGxldElkKSAtPiBib29sOgogICAgICAgIG1hdGNoIHBvcnQ6CiAgICAgICAgICAgIGNhc2UgSW5sZXRJZCgpOgogICAgICAgICAgICAgICAgZm9yIHUsIHYsIChvLCBpKSBpbiBzZWxmLl9tb2RlbC5pbkVkZ2VzKHBvcnQubm9kZUlkKToKICAgICAgICAgICAgICAgICAgICBpZiBpID09IHBvcnQubmFtZToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgY2FzZSBPdXRsZXRJZCgpOgogICAgICAgICAgICAgICAgZm9yIHUsIHYsIChvLCBpKSBpbiBzZWxmLl9tb2RlbC5vdXRFZGdlcyhwb3J0Lm5vZGVJZCk6CiAgICAgICAgICAgICAgICAgICAgaWYgbyA9PSBwb3J0Lm5hbWU6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgIyMjIEhhbmRsZSBNb2RlbCBTaWduYWxzID4+PgogICAgZGVmIG9uTGlua0RlbGV0ZWQoc2VsZiwgZTogTGlua0lkKToKICAgICAgICBzZWxmLnJlbW92ZUl0ZW0oc2VsZi5saW5rR3JhcGhpY3NPYmplY3QoZSkpCiAgICAgICAgaWYgZSBpbiBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHM6CiAgICAgICAgICAgIGRlbCBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHNbZV0KCiAgICAgICAgc2VsZi51cGRhdGVBdHRhY2hlZE5vZGVzKGUsICJpbiIpCiAgICAgICAgc2VsZi51cGRhdGVBdHRhY2hlZE5vZGVzKGUsICJvdXQiKQoKICAgIGRlZiBvbkxpbmtDcmVhdGVkKHNlbGYsIGU6IExpbmtJZCk6CiAgICAgICAgbGluayA9IExpbmtHcmFwaGljc09iamVjdChlKQogICAgICAgIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0c1tlXSA9IGxpbmsKICAgICAgICBzZWxmLmFkZEl0ZW0oc2VsZi5saW5rR3JhcGhpY3NPYmplY3QoZSkpCiAgICAgICAgc2VsZi51cGRhdGVBdHRhY2hlZE5vZGVzKGUsICJpbiIpCiAgICAgICAgc2VsZi51cGRhdGVBdHRhY2hlZE5vZGVzKGUsICJvdXQiKQoKICAgICAgICB1LCB2LCAobywgaSkgPSBlCiAgICAgICAgbGluay5tb3ZlKAogICAgICAgICAgICBzZWxmLm91dGxldEdyYXBoaWNzT2JqZWN0KE91dGxldElkKHUsIG8pKSwKICAgICAgICAgICAgc2VsZi5pbmxldEdyYXBoaWNzT2JqZWN0KElubGV0SWQodiwgaSkpLAogICAgICAgICkKCiAgICBkZWYgbWFrZURyYWZ0TGluayhzZWxmKToKICAgICAgICBzZWxmLmRyYWZ0ID0gTGlua1NoYXBlKCkKICAgICAgICBzZWxmLmRyYWZ0LnNldEFjY2VwdGVkTW91c2VCdXR0b25zKFF0Lk1vdXNlQnV0dG9uLk5vQnV0dG9uKQogICAgICAgIHNlbGYuZHJhZnQuc2V0QWNjZXB0SG92ZXJFdmVudHMoRmFsc2UpCiAgICAgICAgc2VsZi5kcmFmdC5zZXRFbmFibGVkKEZhbHNlKQogICAgICAgIHNlbGYuZHJhZnQuc2V0QWN0aXZlKEZhbHNlKQogICAgICAgIHNlbGYuYWRkSXRlbShzZWxmLmRyYWZ0KQoKICAgIGRlZiByZXNldERyYWZ0TGluayhzZWxmKToKICAgICAgICBhc3NlcnQgc2VsZi5kcmFmdCBpcyBub3QgTm9uZQogICAgICAgIHNlbGYucmVtb3ZlSXRlbShzZWxmLmRyYWZ0KQogICAgICAgIHNlbGYuZHJhZnQgPSBOb25lCgogICAgZGVmIG9uTm9kZUNyZWF0ZWQoc2VsZiwgbjogTm9kZUlkKToKICAgICAgICBpbmxldF9uYW1lcyA9ICgKICAgICAgICAgICAgc2VsZi5fbW9kZWwuZ2V0Tm9kZVByb3BlcnR5KG4sICJpbmxldHMiKQogICAgICAgICAgICBpZiBzZWxmLl9tb2RlbC5oYXNOb2RlUHJvcGVydHkobiwgImlubGV0cyIpCiAgICAgICAgICAgIGVsc2UgW10KICAgICAgICApCgogICAgICAgIGlubGV0cyA9IFtdCiAgICAgICAgaWYgc2VsZi5fbW9kZWwuaGFzTm9kZVByb3BlcnR5KG4sICJpbmxldHMiKToKICAgICAgICAgICAgaW5sZXROYW1lcyA9IHNlbGYuX21vZGVsLmdldE5vZGVQcm9wZXJ0eShuLCAiaW5sZXRzIikKICAgICAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UoaW5sZXROYW1lcywgbGlzdCkgYW5kIGFsbCgKICAgICAgICAgICAgICAgIGlzaW5zdGFuY2UoXywgc3RyKSBmb3IgXyBpbiBpbmxldE5hbWVzCiAgICAgICAgICAgICkKICAgICAgICAgICAgZm9yIGlubGV0TmFtZSBpbiBpbmxldE5hbWVzOgogICAgICAgICAgICAgICAgaW5sZXRfZ3JhcGhpY3Nfb2JqZWN0ID0gSW5sZXRHcmFwaGljc09iamVjdCgKICAgICAgICAgICAgICAgICAgICBJbmxldElkKG4sIGlubGV0TmFtZSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHNlbGYuX2lubGV0X2dyYXBoaWNzX29iamVjdHNbCiAgICAgICAgICAgICAgICAgICAgSW5sZXRJZChuLCBpbmxldE5hbWUpCiAgICAgICAgICAgICAgICBdID0gaW5sZXRfZ3JhcGhpY3Nfb2JqZWN0CiAgICAgICAgICAgICAgICBpbmxldHMuYXBwZW5kKGlubGV0X2dyYXBoaWNzX29iamVjdCkKCiAgICAgICAgb3V0bGV0cyA9IFtdCiAgICAgICAgaWYgc2VsZi5fbW9kZWwuaGFzTm9kZVByb3BlcnR5KG4sICJvdXRsZXRzIik6CiAgICAgICAgICAgIG91dGxldE5hbWVzID0gc2VsZi5fbW9kZWwuZ2V0Tm9kZVByb3BlcnR5KG4sICJvdXRsZXRzIikKICAgICAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2Uob3V0bGV0TmFtZXMsIGxpc3QpIGFuZCBhbGwoCiAgICAgICAgICAgICAgICBpc2luc3RhbmNlKF8sIHN0cikgZm9yIF8gaW4gb3V0bGV0TmFtZXMKICAgICAgICAgICAgKQogICAgICAgICAgICBmb3Igb3V0bGV0TmFtZSBpbiBvdXRsZXROYW1lczoKICAgICAgICAgICAgICAgIG91dGxldF9ncmFwaGljc19vYmplY3QgPSBPdXRsZXRHcmFwaGljc09iamVjdCgKICAgICAgICAgICAgICAgICAgICBPdXRsZXRJZChuLCBvdXRsZXROYW1lKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgc2VsZi5fb3V0bGV0X2dyYXBoaWNzX29iamVjdHNbCiAgICAgICAgICAgICAgICAgICAgT3V0bGV0SWQobiwgb3V0bGV0TmFtZSkKICAgICAgICAgICAgICAgIF0gPSBvdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0CiAgICAgICAgICAgICAgICBvdXRsZXRzLmFwcGVuZChvdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0KQoKICAgICAgICBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHNbbl0gPSBOb2RlR3JhcGhpY3NPYmplY3QoCiAgICAgICAgICAgIG4sIGlubGV0cz1pbmxldHMsIG91dGxldHM9b3V0bGV0cwogICAgICAgICkKCiAgICAgICAgc2VsZi5hZGRJdGVtKHNlbGYubm9kZUdyYXBoaWNzT2JqZWN0KG4pKQoKICAgIGRlZiBvbk5vZGVEZWxldGVkKHNlbGYsIG46IE5vZGVJZCk6CiAgICAgICAgaWYgbiBpbiBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHM6CiAgICAgICAgICAgIG5vZGVfZ3JhcGhpY3Nfb2JqZWN0ID0gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzW25dCiAgICAgICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoKQoKICAgIGRlZiBvbk1vZGVsUmVzZXQoc2VsZik6CiAgICAgICAgc2VsZi5fbGlua19ncmFwaGljc19vYmplY3RzLmNsZWFyKCkKICAgICAgICBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHMuY2xlYXIoKQogICAgICAgIHNlbGYuY2xlYXIoKQoKICAgICAgICBzZWxmLnRyYXZlcnNlR3JhcGhBbmRQb3B1bGF0ZUdyYXBoaWNzT2JqZWN0cygpCgogICAgIyMjIDw8PCBIYW5kbGUgTW9kZWwgU2lnbmFscwogICAgZGVmIF9maW5kR3JhcGhJdGVtQXQoc2VsZiwga2xhc3MsIHBvc2l0aW9uOiBRUG9pbnRGKToKICAgICAgICAjIGZpbmQgb3V0bGV0IHVuZGVyIG1vdXNlCiAgICAgICAgZm9yIGl0ZW0gaW4gc2VsZi5pdGVtcyhwb3NpdGlvbiwgZGV2aWNlVHJhbnNmb3JtPVFUcmFuc2Zvcm0oKSk6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoaXRlbSwga2xhc3MpOgogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0KCiAgICBkZWYgb3V0bGV0QXQoc2VsZiwgcG9zaXRpb246IFFQb2ludEYpIC0+ICJPdXRsZXRHcmFwaGljc09iamVjdCI6CiAgICAgICAgcmV0dXJuIGNhc3QoCiAgICAgICAgICAgIE91dGxldEdyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoT3V0bGV0R3JhcGhpY3NPYmplY3QsIHBvc2l0aW9uKSwKICAgICAgICApCgogICAgZGVmIGlubGV0QXQoc2VsZiwgcG9zaXRpb246IFFQb2ludEYpIC0+ICJJbmxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgSW5sZXRHcmFwaGljc09iamVjdCwKICAgICAgICAgICAgc2VsZi5fZmluZEdyYXBoSXRlbUF0KElubGV0R3JhcGhpY3NPYmplY3QsIHBvc2l0aW9uKSwKICAgICAgICApCgogICAgZGVmIG5vZGVBdChzZWxmLCBwb3NpdGlvbjogUVBvaW50RikgLT4gIk5vZGVHcmFwaGljc09iamVjdCI6CiAgICAgICAgcmV0dXJuIGNhc3QoCiAgICAgICAgICAgIE5vZGVHcmFwaGljc09iamVjdCwKICAgICAgICAgICAgc2VsZi5fZmluZEdyYXBoSXRlbUF0KE5vZGVHcmFwaGljc09iamVjdCwgcG9zaXRpb24pLAogICAgICAgICkKCiAgICBkZWYgbGlua0F0KHNlbGYsIHBvc2l0aW9uOiBRUG9pbnRGKSAtPiAiTGlua0dyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgTGlua0dyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoTGlua0dyYXBoaWNzT2JqZWN0LCBwb3NpdGlvbiksCiAgICAgICAgKQoKICAgIGRlZiBsYXlvdXQoc2VsZik6CiAgICAgICAgZGVmIGhpZWFyY2hpY2FsX2xheW91dF93aXRoX2dyYW5kYWxmKEcsIHNjYWxlPTEpOgogICAgICAgICAgICBpbXBvcnQgZ3JhbmRhbGYKICAgICAgICAgICAgZnJvbSBncmFuZGFsZi5sYXlvdXRzIGltcG9ydCBTdWdpeWFtYUxheW91dAoKICAgICAgICAgICAgZyA9IGdyYW5kYWxmLnV0aWxzLmNvbnZlcnRfbmV4dHdvcmt4X2dyYXBoX3RvX2dyYW5kYWxmKEcpCgogICAgICAgICAgICBjbGFzcyBkZWZhdWx0dmlldyhvYmplY3QpOiAgIyBzZWUgUkVBRE1FIG9mIGdyYW5kYWxmJ3MgZ2l0aHViCiAgICAgICAgICAgICAgICB3LCBoID0gc2NhbGUsIHNjYWxlCgogICAgICAgICAgICBmb3IgdiBpbiBnLkNbMF0uc1Y6CiAgICAgICAgICAgICAgICB2LnZpZXcgPSBkZWZhdWx0dmlldygpCiAgICAgICAgICAgIHN1ZyA9IFN1Z2l5YW1hTGF5b3V0KGcuQ1swXSkKICAgICAgICAgICAgc3VnLmluaXRfYWxsKCkgICMgcm9vdHM9W1ZbMF1dKQogICAgICAgICAgICBzdWcuZHJhdygpCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICB2LmRhdGE6ICh2LnZpZXcueHlbMF0sIHYudmlldy54eVsxXSkgZm9yIHYgaW4gZy5DWzBdLnNWCiAgICAgICAgICAgIH0gICMgRXh0cmFjdHMgdGhlIHBvc2l0aW9ucwoKICAgICAgICBkZWYgaGllYXJjaGljYWxfbGF5b3V0X3dpdGhfbngoRywgc2NhbGU9MTAwKToKICAgICAgICAgICAgZm9yIGxheWVyLCBub2RlcyBpbiBlbnVtZXJhdGUoCiAgICAgICAgICAgICAgICByZXZlcnNlZCh0dXBsZShueC50b3BvbG9naWNhbF9nZW5lcmF0aW9ucyhHKSkpCiAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICAjIGBtdWx0aXBhcnRpdGVfbGF5b3V0YCBleHBlY3RzIHRoZSBsYXllciBhcyBhIG5vZGUgYXR0cmlidXRlLCBzbyBhZGQgdGhlCiAgICAgICAgICAgICAgICAjIG51bWVyaWMgbGF5ZXIgdmFsdWUgYXMgYSBub2RlIGF0dHJpYnV0ZQogICAgICAgICAgICAgICAgZm9yIG5vZGUgaW4gbm9kZXM6CiAgICAgICAgICAgICAgICAgICAgRy5ub2Rlc1tub2RlXVsibGF5ZXIiXSA9IC1sYXllcgoKICAgICAgICAgICAgIyBDb21wdXRlIHRoZSBtdWx0aXBhcnRpdGVfbGF5b3V0IHVzaW5nIHRoZSAibGF5ZXIiIG5vZGUgYXR0cmlidXRlCiAgICAgICAgICAgIHBvcyA9IG54Lm11bHRpcGFydGl0ZV9sYXlvdXQoCiAgICAgICAgICAgICAgICBHLCBzdWJzZXRfa2V5PSJsYXllciIsIGFsaWduPSJob3Jpem9udGFsIgogICAgICAgICAgICApCiAgICAgICAgICAgIGZvciBuLCBwIGluIHBvcy5pdGVtcygpOgogICAgICAgICAgICAgICAgcG9zW25dID0gcFswXSAqIHNjYWxlLCBwWzFdICogc2NhbGUKICAgICAgICAgICAgcmV0dXJuIHBvcwoKICAgICAgICBwb3MgPSBoaWVhcmNoaWNhbF9sYXlvdXRfd2l0aF9ueChzZWxmLl9tb2RlbC5HLCBzY2FsZT0xMDApCiAgICAgICAgZm9yIE4sICh4LCB5KSBpbiBwb3MuaXRlbXMoKToKICAgICAgICAgICAgd2lkZ2V0ID0gc2VsZi5ub2RlR3JhcGhpY3NPYmplY3QoTikKICAgICAgICAgICAgd2lkZ2V0LnNldFBvcyh4LCB5KQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIEFjdGl2ZSBHcmFwaGljcyBPYmplY3RzICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgoKY2xhc3MgT3V0bGV0R3JhcGhpY3NPYmplY3QoUG9ydFNoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBvOiBPdXRsZXRJZCk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhsYWJlbD1mIntvLm5hbWV9IikKICAgICAgICBzZWxmLl9vID0gbwoKICAgIGRlZiBncmFwaHNjZW5lKHNlbGYpIC0+ICJOWEdyYXBoU2NlbmUiOgogICAgICAgIHJldHVybiBjYXN0KE5YR3JhcGhTY2VuZSwgc2VsZi5zY2VuZSgpKQoKICAgIGRlZiBtb3VzZVByZXNzRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBzZWxmLmdyYXBoc2NlbmUoKS5tYWtlRHJhZnRMaW5rKCkKICAgICAgICBzZWxmLmdyYWJNb3VzZSgpCgogICAgZGVmIG1vdXNlTW92ZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZU1vdXNlRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgZHJhZnQgPSBzZWxmLmdyYXBoc2NlbmUoKS5kcmFmdAogICAgICAgIGFzc2VydCBkcmFmdCBpcyBub3QgTm9uZQoKICAgICAgICBpZiBpbmxldCA6PSBzZWxmLmdyYXBoc2NlbmUoKS5pbmxldEF0KGV2ZW50LnNjZW5lUG9zKCkpOgogICAgICAgICAgICBkcmFmdC5zZXRMaW5lKG1ha2VMaW5lQmV0d2VlblNoYXBlcyhzZWxmLCBpbmxldCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZHJhZnQuc2V0TGluZShtYWtlTGluZUJldHdlZW5TaGFwZXMoc2VsZiwgZXZlbnQuc2NlbmVQb3MoKSkpCiAgICAgICAgcmV0dXJuIHN1cGVyKCkubW91c2VNb3ZlRXZlbnQoZXZlbnQpCgogICAgZGVmIG1vdXNlUmVsZWFzZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZU1vdXNlRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi51bmdyYWJNb3VzZSgpCiAgICAgICAgc2VsZi5ncmFwaHNjZW5lKCkucmVzZXREcmFmdExpbmsoKQoKICAgICAgICBpZiBpbmxldCA6PSBzZWxmLmdyYXBoc2NlbmUoKS5pbmxldEF0KGV2ZW50LnNjZW5lUG9zKCkpOgogICAgICAgICAgICBzY2VuZSA9IHNlbGYuZ3JhcGhzY2VuZSgpCiAgICAgICAgICAgIHNjZW5lLl9tb2RlbC5hZGRFZGdlKAogICAgICAgICAgICAgICAgc2VsZi5fby5ub2RlSWQsIGlubGV0Ll9pLm5vZGVJZCwgKHNlbGYuX28ubmFtZSwgaW5sZXQuX2kubmFtZSkKICAgICAgICAgICAgKQoKICAgICAgICByZXR1cm4gc3VwZXIoKS5tb3VzZVJlbGVhc2VFdmVudChldmVudCkKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYnJ1c2ggPSBzdXBlcigpLmJydXNoKCkKICAgICAgICBpZiBzZWxmLmdyYXBoc2NlbmUoKS5pc0xpbmtlZChzZWxmLl9vKToKICAgICAgICAgICAgYnJ1c2ggPSBzZWxmLnBhbGV0dGUoKS50ZXh0KCkKCiAgICAgICAgcmV0dXJuIGJydXNoCgoKY2xhc3MgSW5sZXRHcmFwaGljc09iamVjdChQb3J0U2hhcGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGk6IElubGV0SWQpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18obGFiZWw9ZiJ7aS5uYW1lfSIpCiAgICAgICAgc2VsZi5faSA9IGkKCiAgICBkZWYgZ3JhcGhzY2VuZShzZWxmKSAtPiAiTlhHcmFwaFNjZW5lIjoKICAgICAgICByZXR1cm4gY2FzdChOWEdyYXBoU2NlbmUsIHNlbGYuc2NlbmUoKSkKCiAgICBkZWYgbW91c2VQcmVzc0V2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZU1vdXNlRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5ncmFwaHNjZW5lKCkubWFrZURyYWZ0TGluaygpCiAgICAgICAgc2VsZi5ncmFiTW91c2UoKQoKICAgIGRlZiBtb3VzZU1vdmVFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIGRyYWZ0ID0gc2VsZi5ncmFwaHNjZW5lKCkuZHJhZnQKICAgICAgICBhc3NlcnQgZHJhZnQgaXMgbm90IE5vbmUKCiAgICAgICAgaWYgb3V0bGV0IDo9IHNlbGYuZ3JhcGhzY2VuZSgpLm91dGxldEF0KGV2ZW50LnNjZW5lUG9zKCkpOgogICAgICAgICAgICBkcmFmdC5zZXRMaW5lKG1ha2VMaW5lQmV0d2VlblNoYXBlcyhvdXRsZXQsIHNlbGYpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRyYWZ0LnNldExpbmUobWFrZUxpbmVCZXR3ZWVuU2hhcGVzKGV2ZW50LnNjZW5lUG9zKCksIHNlbGYpKQogICAgICAgIHJldHVybiBzdXBlcigpLm1vdXNlTW92ZUV2ZW50KGV2ZW50KQoKICAgIGRlZiBtb3VzZVJlbGVhc2VFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYudW5ncmFiTW91c2UoKQogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLnJlc2V0RHJhZnRMaW5rKCkKCiAgICAgICAgaWYgb3V0bGV0IDo9IHNlbGYuZ3JhcGhzY2VuZSgpLm91dGxldEF0KGV2ZW50LnNjZW5lUG9zKCkpOgogICAgICAgICAgICBzZWxmLmdyYXBoc2NlbmUoKS5fbW9kZWwuYWRkRWRnZSgKICAgICAgICAgICAgICAgIG91dGxldC5fby5ub2RlSWQsIHNlbGYuX2kubm9kZUlkLCAob3V0bGV0Ll9vLm5hbWUsIHNlbGYuX2kubmFtZSkKICAgICAgICAgICAgKQoKICAgICAgICByZXR1cm4gc3VwZXIoKS5tb3VzZVJlbGVhc2VFdmVudChldmVudCkKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYnJ1c2ggPSBzdXBlcigpLmJydXNoKCkKICAgICAgICBpZiBzZWxmLmdyYXBoc2NlbmUoKS5pc0xpbmtlZChzZWxmLl9pKToKICAgICAgICAgICAgYnJ1c2ggPSBzZWxmLnBhbGV0dGUoKS50ZXh0KCkKCiAgICAgICAgcmV0dXJuIGJydXNoCgoKY2xhc3MgTm9kZUdyYXBoaWNzT2JqZWN0KE5vZGVTaGFwZSk6CiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBuOiBOb2RlSWQsCiAgICAgICAgaW5sZXRzOiBsaXN0W0lubGV0R3JhcGhpY3NPYmplY3RdLAogICAgICAgIG91dGxldHM6IGxpc3RbT3V0bGV0R3JhcGhpY3NPYmplY3RdLAogICAgICAgIHBhcmVudDogUUdyYXBoaWNzSXRlbSB8IE5vbmUgPSBOb25lLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKAogICAgICAgICAgICB0aXRsZT1mIid7bn0nIiwKICAgICAgICAgICAgaW5sZXRzPWlubGV0cywKICAgICAgICAgICAgb3V0bGV0cz1vdXRsZXRzLAogICAgICAgICAgICBwYXJlbnQ9cGFyZW50LAogICAgICAgICkKICAgICAgICBzZWxmLl9uID0gbgogICAgICAgIHNlbGYuc2V0QWNjZXB0SG92ZXJFdmVudHMoRmFsc2UpCgogICAgZGVmIGl0ZW1DaGFuZ2UoCiAgICAgICAgc2VsZiwgY2hhbmdlOiBRR3JhcGhpY3NJdGVtLkdyYXBoaWNzSXRlbUNoYW5nZSwgdmFsdWU6IEFueQogICAgKSAtPiBBbnk6CiAgICAgICAgaWYgKAogICAgICAgICAgICBjaGFuZ2UKICAgICAgICAgICAgPT0gUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1DaGFuZ2UuSXRlbVNjZW5lUG9zaXRpb25IYXNDaGFuZ2VkCiAgICAgICAgKToKICAgICAgICAgICAgc2VsZi5tb3ZlTGlua3MoKQogICAgICAgIHJldHVybiBzdXBlcigpLml0ZW1DaGFuZ2UoY2hhbmdlLCB2YWx1ZSkKCiAgICBkZWYgZ3JhcGhzY2VuZShzZWxmKSAtPiAiTlhHcmFwaFNjZW5lIjoKICAgICAgICByZXR1cm4gY2FzdChOWEdyYXBoU2NlbmUsIHNlbGYuc2NlbmUoKSkKCiAgICBkZWYgbW92ZUxpbmtzKHNlbGYpOgogICAgICAgICIiInJlc3BvbnNpYmxlIHRvIHVwZGF0ZSBjb25uZWN0ZWQgbGluayBwb3NpdGlvbiIiIgogICAgICAgIG1vZGVsID0gc2VsZi5ncmFwaHNjZW5lKCkuX21vZGVsCiAgICAgICAgYWxsX2VkZ2VzID0gbW9kZWwuaW5FZGdlcyhzZWxmLl9uKSArIG1vZGVsLm91dEVkZ2VzKHNlbGYuX24pCiAgICAgICAgZm9yIGUgaW4gYWxsX2VkZ2VzOgogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShlWzJdLCB0dXBsZSkgYW5kIGxlbihlWzJdKSA9PSAyCiAgICAgICAgICAgIHUsIHYsIChvLCBpKSA9IGUKICAgICAgICAgICAgc2VsZi5ncmFwaHNjZW5lKCkKICAgICAgICAgICAgb3V0bGV0ID0gc2VsZi5ncmFwaHNjZW5lKCkub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpCiAgICAgICAgICAgIGlubGV0ID0gc2VsZi5ncmFwaHNjZW5lKCkuaW5sZXRHcmFwaGljc09iamVjdChJbmxldElkKHYsIGkpKQogICAgICAgICAgICBlZGdlID0gc2VsZi5ncmFwaHNjZW5lKCkubGlua0dyYXBoaWNzT2JqZWN0KGUpCiAgICAgICAgICAgIGVkZ2UubW92ZShvdXRsZXQsIGlubGV0KQoKCmNsYXNzIExpbmtHcmFwaGljc09iamVjdChMaW5rU2hhcGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGU6IExpbmtJZCwgcGFyZW50OiBRR3JhcGhpY3NJdGVtIHwgTm9uZSA9IE5vbmUpOgogICAgICAgIHUsIHYsIChvLCBpKSA9IGUKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGxhYmVsPWYie299LT57aX0iLCBwYXJlbnQ9cGFyZW50KQogICAgICAgIHNlbGYuX2UgPSBlCiAgICAgICAgc2VsZi5zZXRaVmFsdWUoLTEpCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgcmV0dXJuIHN1cGVyKCkuYm91bmRpbmdSZWN0KCkuYWRqdXN0ZWQoLTUwLCAtNTAsIDUwLCA1MCkKCgojIyMjIyMjIyMjIwojIEVYQU1QTEUgIwojIyMjIyMjIyMjIwppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaW1wb3J0IHN5cwoKICAgIGFwcCA9IFFBcHBsaWNhdGlvbihzeXMuYXJndikKCiAgICAjIHNldHVwIG1haW4gd2luZG93CiAgICB2aWV3ID0gUUdyYXBoaWNzVmlldygpCiAgICB2aWV3LnNldFdpbmRvd1RpdGxlKCJOWEdyYXBoU2NlbmUiKQogICAgdmlldy5zZXRSZW5kZXJIaW50KFFQYWludGVyLlJlbmRlckhpbnQuQW50aWFsaWFzaW5nLCBUcnVlKQogICAgdmlldy5zZXRSZW5kZXJIaW50KFFQYWludGVyLlJlbmRlckhpbnQuVGV4dEFudGlhbGlhc2luZywgVHJ1ZSkKICAgIHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlNtb290aFBpeG1hcFRyYW5zZm9ybSwgVHJ1ZSkKCiAgICAjIGNyZWF0ZSBncmFwaCBzY2VuZQogICAgZ3JhcGggPSBOWEdyYXBoTW9kZWwoKQogICAgZ3JhcGguYWRkTm9kZSgiTjEiLCBvdXRsZXRzPVsib3V0Il0pCiAgICBncmFwaC5hZGROb2RlKCJOMiIsIGlubGV0cz1bImluIl0pCiAgICBncmFwaC5hZGROb2RlKCJOMyIsIGlubGV0cz1bImluIl0sIG91dGxldHM9WyJvdXQiXSkKICAgIGdyYXBoLmFkZEVkZ2UoIk4xIiwgIk4yIiwgKCJvdXQiLCAiaW4iKSkKICAgIGdyYXBoc2NlbmUgPSBOWEdyYXBoU2NlbmUoZ3JhcGgpCiAgICBncmFwaHNjZW5lLnNldFNjZW5lUmVjdChRUmVjdEYoLTQwMCwgLTQwMCwgODAwLCA4MDApKQogICAgdmlldy5zZXRTY2VuZShncmFwaHNjZW5lKQoKICAgICMgZ3JhcGhzY2VuZS5hZGRJdGVtKEdyYXBoaWNzVmVydGV4SXRlbSgiSFdFTExPIikpCgogICAgIyBzaG93IHdpbmRvdwogICAgdmlldy5zaG93KCkKICAgIHN5cy5leGl0KGFwcC5leGVjKCkpCg",
					"AQAAAAAAAAABAAAAnQIAAAAAAACdAgAAAAAAAAAAAAAAAPC/"
				],
				[
					1395,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAzz8AAAAAAADPPwAAIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgVGhlIE5ldHdvcmsgU2NlbmUgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiMKIyBBICdWaWV3JyB0byByZXByZXNlbnQgYSBuZXR3b3JrIG9mIG5vZGVzLCBjb25uZWN0ZWQgYnkgaW5sZXRzIGFuZCBvdXRsZXRzCiMKCiMgSW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoaXMgaXMgYSAnVmlldycuCiMgSXQgaXMgcmVzcG9uc2libGUgdG8gcHJlc2VudCAoYW5kIHBvdGVudGlhbGx5IGVkaXQpIHRoZSBOWEdyYXBoTW9kZWwKIyBHcmFwaFNjZW5lICdpbnRlcm5hbHknIHVzZXMgc3ViY2xhc3NlcyBvZiBHcmFwaFNoYXBlcyB0aGF0IGFyZSBhbHNvICd2aWV3cycuCiMgdGhlc2Ugd2lkZ2V0cyBhcmUgcmVzcG9uc2libGUgdG8gcmVmZXJlbmNlIHRoZSBncmFwaHNjZW5lLAojIGFuZCB0aGUgcmVwcmVzZW50ZWQgbm9kZXMsIGVkZ2UgYW5kIHBvcnRzLgojCiMgVE9ETzogbW92ZSB0aGUgbW9kZWwgZWRpdGluZyBjYXBhYmlsaXRpZXMKIyBmcm9tIHRoZSB3aWRnZXRzIHRvIGEgZGVsZWdhdGUsIG9yIHRoZSBncmFwaHNlbmUgaXRzZWxmCgoKZnJvbSB0eXBpbmcgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0R3VpIGltcG9ydCAqCmZyb20gUHlTaWRlNi5RdENvcmUgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0V2lkZ2V0cyBpbXBvcnQgKgoKCkNvbm5lY3Rpb25FbnRlclR5cGUgPSBRRXZlbnQuVHlwZShRRXZlbnQucmVnaXN0ZXJFdmVudFR5cGUoKSkKQ29ubmVjdGlvbkxlYXZlVHlwZSA9IFFFdmVudC5UeXBlKFFFdmVudC5yZWdpc3RlckV2ZW50VHlwZSgpKQpDb25uZWN0aW9uTW92ZVR5cGUgPSBRRXZlbnQuVHlwZShRRXZlbnQucmVnaXN0ZXJFdmVudFR5cGUoKSkKQ29ubmVjdGlvbkRyb3BUeXBlID0gUUV2ZW50LlR5cGUoUUV2ZW50LnJlZ2lzdGVyRXZlbnRUeXBlKCkpCgppbXBvcnQgbnVtcHkgYXMgbnAKaW1wb3J0IG5ldHdvcmt4IGFzIG54CgoKIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCmZyb20gcHlsaXZlLk5ldHdvcmtYR3JhcGhFZGl0b3IubnhfZ3JhcGhfc2hhcGVzIGltcG9ydCAoCiAgICBOb2RlU2hhcGUsCiAgICBMaW5rU2hhcGUsCiAgICBQb3J0U2hhcGUsCikKCgojIyMjIyMjIyMjIyMjIwojIEdSQVBIU0NFTkUgIwojIyMjIyMjIyMjIyMjIwoKZnJvbSBweWxpdmUuTmV0d29ya1hHcmFwaEVkaXRvci5ueF9ncmFwaF9tb2RlbCBpbXBvcnQgTlhHcmFwaE1vZGVsCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKCnR5cGUgTm9kZUlkID0gSGFzaGFibGUKCgpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBPdXRsZXRJZDoKICAgIG5vZGVJZDogTm9kZUlkCiAgICBuYW1lOiBzdHIKCgpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBJbmxldElkOgogICAgbm9kZUlkOiBOb2RlSWQKICAgIG5hbWU6IHN0cgoKCnR5cGUgTGlua0lkID0gdHVwbGVbTm9kZUlkLCBOb2RlSWQsIHR1cGxlW3N0ciwgc3RyXV0KCgpjbGFzcyBOWEdyYXBoU2NlbmUoUUdyYXBoaWNzU2NlbmUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1vZGVsOiBOWEdyYXBoTW9kZWwpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuX21vZGVsID0gbW9kZWwKICAgICAgICBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHM6IGRpY3RbTm9kZUlkLCBOb2RlR3JhcGhpY3NPYmplY3RdID0gZGljdCgpCiAgICAgICAgc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFsKICAgICAgICAgICAgSW5sZXRJZCwgSW5sZXRHcmFwaGljc09iamVjdAogICAgICAgIF0gPSBkaWN0KCkKICAgICAgICBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFsKICAgICAgICAgICAgT3V0bGV0SWQsIE91dGxldEdyYXBoaWNzT2JqZWN0CiAgICAgICAgXSA9IGRpY3QoKQogICAgICAgIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFtMaW5rSWQsIExpbmtHcmFwaGljc09iamVjdF0gPSBkaWN0KCkKICAgICAgICBzZWxmLl9kcmFmdF9saW5rOiBMaW5rR3JhcGhpY3NPYmplY3QgfCBOb25lID0gTm9uZQoKICAgICAgICBzZWxmLnNldEl0ZW1JbmRleE1ldGhvZChRR3JhcGhpY3NTY2VuZS5JdGVtSW5kZXhNZXRob2QuTm9JbmRleCkKCiAgICAgICAgc2VsZi5fbW9kZWwubm9kZXNBZGRlZC5jb25uZWN0KAogICAgICAgICAgICBsYW1iZGEgbm9kZXM6IFtzZWxmLm9uTm9kZUNyZWF0ZWQobikgZm9yIG4gaW4gbm9kZXNdCiAgICAgICAgKQogICAgICAgIHNlbGYuX21vZGVsLm5vZGVzQWJvdXRUb0JlUmVtb3ZlZC5jb25uZWN0KAogICAgICAgICAgICBsYW1iZGEgbm9kZXM6IFtzZWxmLm9uTm9kZURlbGV0ZWQobikgZm9yIG4gaW4gbm9kZXNdCiAgICAgICAgKQogICAgICAgIHNlbGYuX21vZGVsLmVkZ2VzQWRkZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIGVkZ2VzOiBbc2VsZi5vbkxpbmtDcmVhdGVkKGUpIGZvciBlIGluIGVkZ2VzXQogICAgICAgICkKICAgICAgICBzZWxmLl9tb2RlbC5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIGVkZ2VzOiBbc2VsZi5vbkxpbmtEZWxldGVkKGUpIGZvciBlIGluIGVkZ2VzXQogICAgICAgICkKCiAgICAgICAgc2VsZi50cmF2ZXJzZUdyYXBoQW5kUG9wdWxhdGVHcmFwaGljc09iamVjdHMoKQogICAgICAgIHNlbGYuZHJhZnQ6IExpbmtTaGFwZSB8IE5vbmUgPSBOb25lICAjIHRvZG8gdXNlIHRoZSB3aWRnZXQgaXRzZWxmCiAgICAgICAgc2VsZi5sYXlvdXQoKQoKICAgIGRlZiB0cmF2ZXJzZUdyYXBoQW5kUG9wdWxhdGVHcmFwaGljc09iamVjdHMoc2VsZik6CiAgICAgICAgYWxsTm9kZUlkczogbGlzdFtOb2RlSWRdID0gc2VsZi5fbW9kZWwubm9kZXMoKQoKICAgICAgICAjIEZpcnN0IGNyZWF0ZSBhbGwgdGhlIG5vZGVzLgogICAgICAgIGZvciBub2RlSWQgaW4gYWxsTm9kZUlkczoKICAgICAgICAgICAgc2VsZi5vbk5vZGVDcmVhdGVkKG5vZGVJZCkKCiAgICAgICAgZm9yIGUgaW4gc2VsZi5fbW9kZWwuZWRnZXMoKToKICAgICAgICAgICAgdSwgdiwgKG8sIGkpID0gZQogICAgICAgICAgICBhc3NlcnQgdSBpbiBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHMKICAgICAgICAgICAgYXNzZXJ0IHYgaW4gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzCiAgICAgICAgICAgIGFzc2VydCAoCiAgICAgICAgICAgICAgICBPdXRsZXRJZCh1LCBvKSBpbiBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0cwogICAgICAgICAgICApLCBmIk5vZGUgJ3t1fScgaGFzIG5vIG91dGxldCAne299JyEiCiAgICAgICAgICAgIGFzc2VydCAoCiAgICAgICAgICAgICAgICBJbmxldElkKHYsIGkpIGluIHNlbGYuX2lubGV0X2dyYXBoaWNzX29iamVjdHMKICAgICAgICAgICAgKSwgZiJOb2RlICd7dn0nIGhhcyBubyBpbmxldCAne2l9JyEiCgogICAgICAgICAgICBsaW5rID0gTGlua0dyYXBoaWNzT2JqZWN0KCh1LCB2LCAobywgaSkpKQogICAgICAgICAgICBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHNbKHUsIHYsIChvLCBpKSldID0gbGluawogICAgICAgICAgICBzZWxmLmFkZEl0ZW0obGluaykKCiAgICAgICAgICAgIGxpbmsubW92ZSgKICAgICAgICAgICAgICAgIHNlbGYub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpLAogICAgICAgICAgICAgICAgc2VsZi5pbmxldEdyYXBoaWNzT2JqZWN0KElubGV0SWQodiwgaSkpLAogICAgICAgICAgICApCgogICAgZGVmIGxpbmtHcmFwaGljc09iamVjdChzZWxmLCBlOiBMaW5rSWQpIC0+ICJMaW5rR3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHNbZV0KCiAgICBkZWYgbm9kZUdyYXBoaWNzT2JqZWN0KHNlbGYsIG46IE5vZGVJZCkgLT4gIk5vZGVHcmFwaGljc09iamVjdCI6CiAgICAgICAgcmV0dXJuIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0c1tuXQoKICAgIGRlZiBpbmxldEdyYXBoaWNzT2JqZWN0KHNlbGYsIGk6IElubGV0SWQpIC0+ICJJbmxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0c1tpXQoKICAgIGRlZiBvdXRsZXRHcmFwaGljc09iamVjdChzZWxmLCBvOiBPdXRsZXRJZCkgLT4gIk91dGxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gc2VsZi5fb3V0bGV0X2dyYXBoaWNzX29iamVjdHNbb10KCiAgICBkZWYgdXBkYXRlQXR0YWNoZWROb2RlcyhzZWxmLCBlOiBMaW5rSWQsIGtpbmQ6IExpdGVyYWxbImluIiwgIm91dCJdKToKICAgICAgICB1LCB2LCBrID0gZQogICAgICAgIG1hdGNoIGtpbmQ6CiAgICAgICAgICAgIGNhc2UgImluIjoKICAgICAgICAgICAgICAgIGlmIG5vZGUgOj0gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzLmdldCh1LCBOb25lKToKICAgICAgICAgICAgICAgICAgICBub2RlLnVwZGF0ZSgpCiAgICAgICAgICAgIGNhc2UgIm91dCI6CiAgICAgICAgICAgICAgICBpZiBub2RlIDo9IHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cy5nZXQodiwgTm9uZSk6CiAgICAgICAgICAgICAgICAgICAgbm9kZS51cGRhdGUoKQoKICAgIGRlZiBpc0xpbmtlZChzZWxmLCBwb3J0OiBJbmxldElkIHwgT3V0bGV0SWQpIC0+IGJvb2w6CiAgICAgICAgbWF0Y2ggcG9ydDoKICAgICAgICAgICAgY2FzZSBJbmxldElkKCk6CiAgICAgICAgICAgICAgICBmb3IgdSwgdiwgKG8sIGkpIGluIHNlbGYuX21vZGVsLmluRWRnZXMocG9ydC5ub2RlSWQpOgogICAgICAgICAgICAgICAgICAgIGlmIGkgPT0gcG9ydC5uYW1lOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICBjYXNlIE91dGxldElkKCk6CiAgICAgICAgICAgICAgICBmb3IgdSwgdiwgKG8sIGkpIGluIHNlbGYuX21vZGVsLm91dEVkZ2VzKHBvcnQubm9kZUlkKToKICAgICAgICAgICAgICAgICAgICBpZiBvID09IHBvcnQubmFtZToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAjIyMgSGFuZGxlIE1vZGVsIFNpZ25hbHMgPj4+CiAgICBkZWYgb25MaW5rRGVsZXRlZChzZWxmLCBlOiBMaW5rSWQpOgogICAgICAgIHNlbGYucmVtb3ZlSXRlbShzZWxmLmxpbmtHcmFwaGljc09iamVjdChlKSkKICAgICAgICBpZiBlIGluIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0czoKICAgICAgICAgICAgZGVsIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0c1tlXQoKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgImluIikKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgIm91dCIpCgogICAgZGVmIG9uTGlua0NyZWF0ZWQoc2VsZiwgZTogTGlua0lkKToKICAgICAgICBsaW5rID0gTGlua0dyYXBoaWNzT2JqZWN0KGUpCiAgICAgICAgc2VsZi5fbGlua19ncmFwaGljc19vYmplY3RzW2VdID0gbGluawogICAgICAgIHNlbGYuYWRkSXRlbShzZWxmLmxpbmtHcmFwaGljc09iamVjdChlKSkKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgImluIikKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgIm91dCIpCgogICAgICAgIHUsIHYsIChvLCBpKSA9IGUKICAgICAgICBsaW5rLm1vdmUoCiAgICAgICAgICAgIHNlbGYub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpLAogICAgICAgICAgICBzZWxmLmlubGV0R3JhcGhpY3NPYmplY3QoSW5sZXRJZCh2LCBpKSksCiAgICAgICAgKQoKICAgIGRlZiBtYWtlRHJhZnRMaW5rKHNlbGYpOgogICAgICAgIHNlbGYuZHJhZnQgPSBMaW5rU2hhcGUoKQogICAgICAgIHNlbGYuZHJhZnQuc2V0QWNjZXB0ZWRNb3VzZUJ1dHRvbnMoUXQuTW91c2VCdXR0b24uTm9CdXR0b24pCiAgICAgICAgc2VsZi5kcmFmdC5zZXRBY2NlcHRIb3ZlckV2ZW50cyhGYWxzZSkKICAgICAgICBzZWxmLmRyYWZ0LnNldEVuYWJsZWQoRmFsc2UpCiAgICAgICAgc2VsZi5kcmFmdC5zZXRBY3RpdmUoRmFsc2UpCiAgICAgICAgc2VsZi5hZGRJdGVtKHNlbGYuZHJhZnQpCgogICAgZGVmIHJlc2V0RHJhZnRMaW5rKHNlbGYpOgogICAgICAgIGFzc2VydCBzZWxmLmRyYWZ0IGlzIG5vdCBOb25lCiAgICAgICAgc2VsZi5yZW1vdmVJdGVtKHNlbGYuZHJhZnQpCiAgICAgICAgc2VsZi5kcmFmdCA9IE5vbmUKCiAgICBkZWYgb25Ob2RlQ3JlYXRlZChzZWxmLCBuOiBOb2RlSWQpOgogICAgICAgIGlubGV0X25hbWVzID0gKAogICAgICAgICAgICBzZWxmLl9tb2RlbC5nZXROb2RlUHJvcGVydHkobiwgImlubGV0cyIpCiAgICAgICAgICAgIGlmIHNlbGYuX21vZGVsLmhhc05vZGVQcm9wZXJ0eShuLCAiaW5sZXRzIikKICAgICAgICAgICAgZWxzZSBbXQogICAgICAgICkKCiAgICAgICAgaW5sZXRzID0gW10KICAgICAgICBpZiBzZWxmLl9tb2RlbC5oYXNOb2RlUHJvcGVydHkobiwgImlubGV0cyIpOgogICAgICAgICAgICBpbmxldE5hbWVzID0gc2VsZi5fbW9kZWwuZ2V0Tm9kZVByb3BlcnR5KG4sICJpbmxldHMiKQogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShpbmxldE5hbWVzLCBsaXN0KSBhbmQgYWxsKAogICAgICAgICAgICAgICAgaXNpbnN0YW5jZShfLCBzdHIpIGZvciBfIGluIGlubGV0TmFtZXMKICAgICAgICAgICAgKQogICAgICAgICAgICBmb3IgaW5sZXROYW1lIGluIGlubGV0TmFtZXM6CiAgICAgICAgICAgICAgICBpbmxldF9ncmFwaGljc19vYmplY3QgPSBJbmxldEdyYXBoaWNzT2JqZWN0KAogICAgICAgICAgICAgICAgICAgIElubGV0SWQobiwgaW5sZXROYW1lKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0c1sKICAgICAgICAgICAgICAgICAgICBJbmxldElkKG4sIGlubGV0TmFtZSkKICAgICAgICAgICAgICAgIF0gPSBpbmxldF9ncmFwaGljc19vYmplY3QKICAgICAgICAgICAgICAgIGlubGV0cy5hcHBlbmQoaW5sZXRfZ3JhcGhpY3Nfb2JqZWN0KQoKICAgICAgICBvdXRsZXRzID0gW10KICAgICAgICBpZiBzZWxmLl9tb2RlbC5oYXNOb2RlUHJvcGVydHkobiwgIm91dGxldHMiKToKICAgICAgICAgICAgb3V0bGV0TmFtZXMgPSBzZWxmLl9tb2RlbC5nZXROb2RlUHJvcGVydHkobiwgIm91dGxldHMiKQogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShvdXRsZXROYW1lcywgbGlzdCkgYW5kIGFsbCgKICAgICAgICAgICAgICAgIGlzaW5zdGFuY2UoXywgc3RyKSBmb3IgXyBpbiBvdXRsZXROYW1lcwogICAgICAgICAgICApCiAgICAgICAgICAgIGZvciBvdXRsZXROYW1lIGluIG91dGxldE5hbWVzOgogICAgICAgICAgICAgICAgb3V0bGV0X2dyYXBoaWNzX29iamVjdCA9IE91dGxldEdyYXBoaWNzT2JqZWN0KAogICAgICAgICAgICAgICAgICAgIE91dGxldElkKG4sIG91dGxldE5hbWUpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0c1sKICAgICAgICAgICAgICAgICAgICBPdXRsZXRJZChuLCBvdXRsZXROYW1lKQogICAgICAgICAgICAgICAgXSA9IG91dGxldF9ncmFwaGljc19vYmplY3QKICAgICAgICAgICAgICAgIG91dGxldHMuYXBwZW5kKG91dGxldF9ncmFwaGljc19vYmplY3QpCgogICAgICAgIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0c1tuXSA9IE5vZGVHcmFwaGljc09iamVjdCgKICAgICAgICAgICAgbiwgaW5sZXRzPWlubGV0cywgb3V0bGV0cz1vdXRsZXRzCiAgICAgICAgKQoKICAgICAgICBzZWxmLmFkZEl0ZW0oc2VsZi5ub2RlR3JhcGhpY3NPYmplY3QobikpCgogICAgZGVmIG9uTm9kZURlbGV0ZWQoc2VsZiwgbjogTm9kZUlkKToKICAgICAgICBpZiBuIGluIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0czoKICAgICAgICAgICAgbm9kZV9ncmFwaGljc19vYmplY3QgPSBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHNbbl0KICAgICAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcigpCgogICAgZGVmIG9uTW9kZWxSZXNldChzZWxmKToKICAgICAgICBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHMuY2xlYXIoKQogICAgICAgIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cy5jbGVhcigpCiAgICAgICAgc2VsZi5jbGVhcigpCgogICAgICAgIHNlbGYudHJhdmVyc2VHcmFwaEFuZFBvcHVsYXRlR3JhcGhpY3NPYmplY3RzKCkKCiAgICAjIyMgPDw8IEhhbmRsZSBNb2RlbCBTaWduYWxzCiAgICBkZWYgX2ZpbmRHcmFwaEl0ZW1BdChzZWxmLCBrbGFzcywgcG9zaXRpb246IFFQb2ludEYpOgogICAgICAgICMgZmluZCBvdXRsZXQgdW5kZXIgbW91c2UKICAgICAgICBmb3IgaXRlbSBpbiBzZWxmLml0ZW1zKHBvc2l0aW9uLCBkZXZpY2VUcmFuc2Zvcm09UVRyYW5zZm9ybSgpKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVtLCBrbGFzcyk6CiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbQoKICAgIGRlZiBvdXRsZXRBdChzZWxmLCBwb3NpdGlvbjogUVBvaW50RikgLT4gIk91dGxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgT3V0bGV0R3JhcGhpY3NPYmplY3QsCiAgICAgICAgICAgIHNlbGYuX2ZpbmRHcmFwaEl0ZW1BdChPdXRsZXRHcmFwaGljc09iamVjdCwgcG9zaXRpb24pLAogICAgICAgICkKCiAgICBkZWYgaW5sZXRBdChzZWxmLCBwb3NpdGlvbjogUVBvaW50RikgLT4gIklubGV0R3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBjYXN0KAogICAgICAgICAgICBJbmxldEdyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoSW5sZXRHcmFwaGljc09iamVjdCwgcG9zaXRpb24pLAogICAgICAgICkKCiAgICBkZWYgbm9kZUF0KHNlbGYsIHBvc2l0aW9uOiBRUG9pbnRGKSAtPiAiTm9kZUdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgTm9kZUdyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoTm9kZUdyYXBoaWNzT2JqZWN0LCBwb3NpdGlvbiksCiAgICAgICAgKQoKICAgIGRlZiBsaW5rQXQoc2VsZiwgcG9zaXRpb246IFFQb2ludEYpIC0+ICJMaW5rR3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBjYXN0KAogICAgICAgICAgICBMaW5rR3JhcGhpY3NPYmplY3QsCiAgICAgICAgICAgIHNlbGYuX2ZpbmRHcmFwaEl0ZW1BdChMaW5rR3JhcGhpY3NPYmplY3QsIHBvc2l0aW9uKSwKICAgICAgICApCgogICAgZGVmIGxheW91dChzZWxmKToKICAgICAgICBkZWYgaGllYXJjaGljYWxfbGF5b3V0X3dpdGhfZ3JhbmRhbGYoRywgc2NhbGU9MSk6CiAgICAgICAgICAgIGltcG9ydCBncmFuZGFsZgogICAgICAgICAgICBmcm9tIGdyYW5kYWxmLmxheW91dHMgaW1wb3J0IFN1Z2l5YW1hTGF5b3V0CgogICAgICAgICAgICBnID0gZ3JhbmRhbGYudXRpbHMuY29udmVydF9uZXh0d29ya3hfZ3JhcGhfdG9fZ3JhbmRhbGYoRykKCiAgICAgICAgICAgIGNsYXNzIGRlZmF1bHR2aWV3KG9iamVjdCk6ICAjIHNlZSBSRUFETUUgb2YgZ3JhbmRhbGYncyBnaXRodWIKICAgICAgICAgICAgICAgIHcsIGggPSBzY2FsZSwgc2NhbGUKCiAgICAgICAgICAgIGZvciB2IGluIGcuQ1swXS5zVjoKICAgICAgICAgICAgICAgIHYudmlldyA9IGRlZmF1bHR2aWV3KCkKICAgICAgICAgICAgc3VnID0gU3VnaXlhbWFMYXlvdXQoZy5DWzBdKQogICAgICAgICAgICBzdWcuaW5pdF9hbGwoKSAgIyByb290cz1bVlswXV0pCiAgICAgICAgICAgIHN1Zy5kcmF3KCkKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHYuZGF0YTogKHYudmlldy54eVswXSwgdi52aWV3Lnh5WzFdKSBmb3IgdiBpbiBnLkNbMF0uc1YKICAgICAgICAgICAgfSAgIyBFeHRyYWN0cyB0aGUgcG9zaXRpb25zCgogICAgICAgIGRlZiBoaWVhcmNoaWNhbF9sYXlvdXRfd2l0aF9ueChHLCBzY2FsZT0xMDApOgogICAgICAgICAgICBmb3IgbGF5ZXIsIG5vZGVzIGluIGVudW1lcmF0ZSgKICAgICAgICAgICAgICAgIHJldmVyc2VkKHR1cGxlKG54LnRvcG9sb2dpY2FsX2dlbmVyYXRpb25zKEcpKSkKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICMgYG11bHRpcGFydGl0ZV9sYXlvdXRgIGV4cGVjdHMgdGhlIGxheWVyIGFzIGEgbm9kZSBhdHRyaWJ1dGUsIHNvIGFkZCB0aGUKICAgICAgICAgICAgICAgICMgbnVtZXJpYyBsYXllciB2YWx1ZSBhcyBhIG5vZGUgYXR0cmlidXRlCiAgICAgICAgICAgICAgICBmb3Igbm9kZSBpbiBub2RlczoKICAgICAgICAgICAgICAgICAgICBHLm5vZGVzW25vZGVdWyJsYXllciJdID0gLWxheWVyCgogICAgICAgICAgICAjIENvbXB1dGUgdGhlIG11bHRpcGFydGl0ZV9sYXlvdXQgdXNpbmcgdGhlICJsYXllciIgbm9kZSBhdHRyaWJ1dGUKICAgICAgICAgICAgcG9zID0gbngubXVsdGlwYXJ0aXRlX2xheW91dCgKICAgICAgICAgICAgICAgIEcsIHN1YnNldF9rZXk9ImxheWVyIiwgYWxpZ249Imhvcml6b250YWwiCiAgICAgICAgICAgICkKICAgICAgICAgICAgZm9yIG4sIHAgaW4gcG9zLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBwb3Nbbl0gPSBwWzBdICogc2NhbGUsIHBbMV0gKiBzY2FsZQogICAgICAgICAgICByZXR1cm4gcG9zCgogICAgICAgIHBvcyA9IGhpZWFyY2hpY2FsX2xheW91dF93aXRoX254KHNlbGYuX21vZGVsLkcsIHNjYWxlPTEwMCkKICAgICAgICBmb3IgTiwgKHgsIHkpIGluIHBvcy5pdGVtcygpOgogICAgICAgICAgICB3aWRnZXQgPSBzZWxmLm5vZGVHcmFwaGljc09iamVjdChOKQogICAgICAgICAgICB3aWRnZXQuc2V0UG9zKHgsIHkpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgQWN0aXZlIEdyYXBoaWNzIE9iamVjdHMgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgpjbGFzcyBPdXRsZXRHcmFwaGljc09iamVjdChQb3J0U2hhcGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG86IE91dGxldElkKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGxhYmVsPWYie28ubmFtZX0iKQogICAgICAgIHNlbGYuX28gPSBvCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIG1vdXNlUHJlc3NFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLm1ha2VEcmFmdExpbmsoKQogICAgICAgIHNlbGYuZ3JhYk1vdXNlKCkKCiAgICBkZWYgbW91c2VNb3ZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBkcmFmdCA9IHNlbGYuZ3JhcGhzY2VuZSgpLmRyYWZ0CiAgICAgICAgYXNzZXJ0IGRyYWZ0IGlzIG5vdCBOb25lCgogICAgICAgIGlmIGlubGV0IDo9IHNlbGYuZ3JhcGhzY2VuZSgpLmlubGV0QXQoZXZlbnQuc2NlbmVQb3MoKSk6CiAgICAgICAgICAgIGRyYWZ0LnNldExpbmUobWFrZUxpbmVCZXR3ZWVuU2hhcGVzKHNlbGYsIGlubGV0KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBkcmFmdC5zZXRMaW5lKG1ha2VMaW5lQmV0d2VlblNoYXBlcyhzZWxmLCBldmVudC5zY2VuZVBvcygpKSkKICAgICAgICByZXR1cm4gc3VwZXIoKS5tb3VzZU1vdmVFdmVudChldmVudCkKCiAgICBkZWYgbW91c2VSZWxlYXNlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBzZWxmLnVuZ3JhYk1vdXNlKCkKICAgICAgICBzZWxmLmdyYXBoc2NlbmUoKS5yZXNldERyYWZ0TGluaygpCgogICAgICAgIGlmIGlubGV0IDo9IHNlbGYuZ3JhcGhzY2VuZSgpLmlubGV0QXQoZXZlbnQuc2NlbmVQb3MoKSk6CiAgICAgICAgICAgIHNjZW5lID0gc2VsZi5ncmFwaHNjZW5lKCkKICAgICAgICAgICAgc2NlbmUuX21vZGVsLmFkZEVkZ2UoCiAgICAgICAgICAgICAgICBzZWxmLl9vLm5vZGVJZCwgaW5sZXQuX2kubm9kZUlkLCAoc2VsZi5fby5uYW1lLCBpbmxldC5faS5uYW1lKQogICAgICAgICAgICApCgogICAgICAgIHJldHVybiBzdXBlcigpLm1vdXNlUmVsZWFzZUV2ZW50KGV2ZW50KQoKICAgIGRlZiBicnVzaChzZWxmKToKICAgICAgICBicnVzaCA9IHN1cGVyKCkuYnJ1c2goKQogICAgICAgIGlmIHNlbGYuZ3JhcGhzY2VuZSgpLmlzTGlua2VkKHNlbGYuX28pOgogICAgICAgICAgICBicnVzaCA9IHNlbGYucGFsZXR0ZSgpLnRleHQoKQoKICAgICAgICByZXR1cm4gYnJ1c2gKCgpjbGFzcyBJbmxldEdyYXBoaWNzT2JqZWN0KFBvcnRTaGFwZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaTogSW5sZXRJZCk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhsYWJlbD1mIntpLm5hbWV9IikKICAgICAgICBzZWxmLl9pID0gaQoKICAgIGRlZiBncmFwaHNjZW5lKHNlbGYpIC0+ICJOWEdyYXBoU2NlbmUiOgogICAgICAgIHJldHVybiBjYXN0KE5YR3JhcGhTY2VuZSwgc2VsZi5zY2VuZSgpKQoKICAgIGRlZiBtb3VzZVByZXNzRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBzZWxmLmdyYXBoc2NlbmUoKS5tYWtlRHJhZnRMaW5rKCkKICAgICAgICBzZWxmLmdyYWJNb3VzZSgpCgogICAgZGVmIG1vdXNlTW92ZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZU1vdXNlRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgZHJhZnQgPSBzZWxmLmdyYXBoc2NlbmUoKS5kcmFmdAogICAgICAgIGFzc2VydCBkcmFmdCBpcyBub3QgTm9uZQoKICAgICAgICBpZiBvdXRsZXQgOj0gc2VsZi5ncmFwaHNjZW5lKCkub3V0bGV0QXQoZXZlbnQuc2NlbmVQb3MoKSk6CiAgICAgICAgICAgIGRyYWZ0LnNldExpbmUobWFrZUxpbmVCZXR3ZWVuU2hhcGVzKG91dGxldCwgc2VsZikpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZHJhZnQuc2V0TGluZShtYWtlTGluZUJldHdlZW5TaGFwZXMoZXZlbnQuc2NlbmVQb3MoKSwgc2VsZikpCiAgICAgICAgcmV0dXJuIHN1cGVyKCkubW91c2VNb3ZlRXZlbnQoZXZlbnQpCgogICAgZGVmIG1vdXNlUmVsZWFzZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZU1vdXNlRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi51bmdyYWJNb3VzZSgpCiAgICAgICAgc2VsZi5ncmFwaHNjZW5lKCkucmVzZXREcmFmdExpbmsoKQoKICAgICAgICBpZiBvdXRsZXQgOj0gc2VsZi5ncmFwaHNjZW5lKCkub3V0bGV0QXQoZXZlbnQuc2NlbmVQb3MoKSk6CiAgICAgICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLl9tb2RlbC5hZGRFZGdlKAogICAgICAgICAgICAgICAgb3V0bGV0Ll9vLm5vZGVJZCwgc2VsZi5faS5ub2RlSWQsIChvdXRsZXQuX28ubmFtZSwgc2VsZi5faS5uYW1lKQogICAgICAgICAgICApCgogICAgICAgIHJldHVybiBzdXBlcigpLm1vdXNlUmVsZWFzZUV2ZW50KGV2ZW50KQoKICAgIGRlZiBicnVzaChzZWxmKToKICAgICAgICBicnVzaCA9IHN1cGVyKCkuYnJ1c2goKQogICAgICAgIGlmIHNlbGYuZ3JhcGhzY2VuZSgpLmlzTGlua2VkKHNlbGYuX2kpOgogICAgICAgICAgICBicnVzaCA9IHNlbGYucGFsZXR0ZSgpLnRleHQoKQoKICAgICAgICByZXR1cm4gYnJ1c2gKCgpjbGFzcyBOb2RlR3JhcGhpY3NPYmplY3QoTm9kZVNoYXBlKToKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIG46IE5vZGVJZCwKICAgICAgICBpbmxldHM6IGxpc3RbSW5sZXRHcmFwaGljc09iamVjdF0sCiAgICAgICAgb3V0bGV0czogbGlzdFtPdXRsZXRHcmFwaGljc09iamVjdF0sCiAgICAgICAgcGFyZW50OiBRR3JhcGhpY3NJdGVtIHwgTm9uZSA9IE5vbmUsCiAgICApOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oCiAgICAgICAgICAgIHRpdGxlPWYiJ3tufSciLAogICAgICAgICAgICBpbmxldHM9aW5sZXRzLAogICAgICAgICAgICBvdXRsZXRzPW91dGxldHMsCiAgICAgICAgICAgIHBhcmVudD1wYXJlbnQsCiAgICAgICAgKQogICAgICAgIHNlbGYuX24gPSBuCiAgICAgICAgc2VsZi5zZXRBY2NlcHRIb3ZlckV2ZW50cyhGYWxzZSkKCiAgICBkZWYgaXRlbUNoYW5nZSgKICAgICAgICBzZWxmLCBjaGFuZ2U6IFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtQ2hhbmdlLCB2YWx1ZTogQW55CiAgICApIC0+IEFueToKICAgICAgICBpZiAoCiAgICAgICAgICAgIGNoYW5nZQogICAgICAgICAgICA9PSBRR3JhcGhpY3NJdGVtLkdyYXBoaWNzSXRlbUNoYW5nZS5JdGVtU2NlbmVQb3NpdGlvbkhhc0NoYW5nZWQKICAgICAgICApOgogICAgICAgICAgICBzZWxmLm1vdmVMaW5rcygpCiAgICAgICAgcmV0dXJuIHN1cGVyKCkuaXRlbUNoYW5nZShjaGFuZ2UsIHZhbHVlKQoKICAgIGRlZiBncmFwaHNjZW5lKHNlbGYpIC0+ICJOWEdyYXBoU2NlbmUiOgogICAgICAgIHJldHVybiBjYXN0KE5YR3JhcGhTY2VuZSwgc2VsZi5zY2VuZSgpKQoKICAgIGRlZiBtb3ZlTGlua3Moc2VsZik6CiAgICAgICAgIiIicmVzcG9uc2libGUgdG8gdXBkYXRlIGNvbm5lY3RlZCBsaW5rIHBvc2l0aW9uIiIiCiAgICAgICAgbW9kZWwgPSBzZWxmLmdyYXBoc2NlbmUoKS5fbW9kZWwKICAgICAgICBhbGxfZWRnZXMgPSBtb2RlbC5pbkVkZ2VzKHNlbGYuX24pICsgbW9kZWwub3V0RWRnZXMoc2VsZi5fbikKICAgICAgICBmb3IgZSBpbiBhbGxfZWRnZXM6CiAgICAgICAgICAgIGFzc2VydCBpc2luc3RhbmNlKGVbMl0sIHR1cGxlKSBhbmQgbGVuKGVbMl0pID09IDIKICAgICAgICAgICAgdSwgdiwgKG8sIGkpID0gZQogICAgICAgICAgICBzZWxmLmdyYXBoc2NlbmUoKQogICAgICAgICAgICBvdXRsZXQgPSBzZWxmLmdyYXBoc2NlbmUoKS5vdXRsZXRHcmFwaGljc09iamVjdChPdXRsZXRJZCh1LCBvKSkKICAgICAgICAgICAgaW5sZXQgPSBzZWxmLmdyYXBoc2NlbmUoKS5pbmxldEdyYXBoaWNzT2JqZWN0KElubGV0SWQodiwgaSkpCiAgICAgICAgICAgIGVkZ2UgPSBzZWxmLmdyYXBoc2NlbmUoKS5saW5rR3JhcGhpY3NPYmplY3QoZSkKICAgICAgICAgICAgZWRnZS5tb3ZlKG91dGxldCwgaW5sZXQpCgoKY2xhc3MgTGlua0dyYXBoaWNzT2JqZWN0KExpbmtTaGFwZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZTogTGlua0lkLCBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSk6CiAgICAgICAgdSwgdiwgKG8sIGkpID0gZQogICAgICAgIHN1cGVyKCkuX19pbml0X18obGFiZWw9ZiJ7b30tPntpfSIsIHBhcmVudD1wYXJlbnQpCiAgICAgICAgc2VsZi5fZSA9IGUKICAgICAgICBzZWxmLnNldFpWYWx1ZSgtMSkKCiAgICBkZWYgZ3JhcGhzY2VuZShzZWxmKSAtPiAiTlhHcmFwaFNjZW5lIjoKICAgICAgICByZXR1cm4gY2FzdChOWEdyYXBoU2NlbmUsIHNlbGYuc2NlbmUoKSkKCiAgICBkZWYgYm91bmRpbmdSZWN0KHNlbGYpIC0+IFFSZWN0RjoKICAgICAgICByZXR1cm4gc3VwZXIoKS5ib3VuZGluZ1JlY3QoKS5hZGp1c3RlZCgtNTAsIC01MCwgNTAsIDUwKQoKCiMjIyMjIyMjIyMjCiMgRVhBTVBMRSAjCiMjIyMjIyMjIyMjCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpbXBvcnQgc3lzCgogICAgYXBwID0gUUFwcGxpY2F0aW9uKHN5cy5hcmd2KQoKICAgICMgc2V0dXAgbWFpbiB3aW5kb3cKICAgIHZpZXcgPSBRR3JhcGhpY3NWaWV3KCkKICAgIHZpZXcuc2V0V2luZG93VGl0bGUoIk5YR3JhcGhTY2VuZSIpCiAgICB2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5BbnRpYWxpYXNpbmcsIFRydWUpCiAgICB2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5UZXh0QW50aWFsaWFzaW5nLCBUcnVlKQogICAgdmlldy5zZXRSZW5kZXJIaW50KFFQYWludGVyLlJlbmRlckhpbnQuU21vb3RoUGl4bWFwVHJhbnNmb3JtLCBUcnVlKQoKICAgICMgY3JlYXRlIGdyYXBoIHNjZW5lCiAgICBncmFwaCA9IE5YR3JhcGhNb2RlbCgpCiAgICBncmFwaC5hZGROb2RlKCJOMSIsIG91dGxldHM9WyJvdXQiXSkKICAgIGdyYXBoLmFkZE5vZGUoIk4yIiwgaW5sZXRzPVsiaW4iXSkKICAgIGdyYXBoLmFkZE5vZGUoIk4zIiwgaW5sZXRzPVsiaW4iXSwgb3V0bGV0cz1bIm91dCJdKQogICAgZ3JhcGguYWRkRWRnZSgiTjEiLCAiTjIiLCAoIm91dCIsICJpbiIpKQogICAgZ3JhcGhzY2VuZSA9IE5YR3JhcGhTY2VuZShncmFwaCkKICAgIGdyYXBoc2NlbmUuc2V0U2NlbmVSZWN0KFFSZWN0RigtNDAwLCAtNDAwLCA4MDAsIDgwMCkpCiAgICB2aWV3LnNldFNjZW5lKGdyYXBoc2NlbmUpCgogICAgIyBncmFwaHNjZW5lLmFkZEl0ZW0oR3JhcGhpY3NWZXJ0ZXhJdGVtKCJIV0VMTE8iKSkKCiAgICAjIHNob3cgd2luZG93CiAgICB2aWV3LnNob3coKQogICAgc3lzLmV4aXQoYXBwLmV4ZWMoKSkK",
					"AQAAAAAAAAABAAAAnQIAAAAAAACdAgAAAAAAAAAAAAAAAPC/"
				],
				[
					1402,
					1,
					"insert",
					{
						"characters": "\ndraft."
					},
					"CQAAAMEsAAAAAAAAwiwAAAAAAAAAAAAAwiwAAAAAAADKLAAAAAAAAAAAAADKLAAAAAAAAM4sAAAAAAAAAAAAAM4sAAAAAAAAzywAAAAAAAAAAAAAzywAAAAAAADQLAAAAAAAAAAAAADQLAAAAAAAANEsAAAAAAAAAAAAANEsAAAAAAAA0iwAAAAAAAAAAAAA0iwAAAAAAADTLAAAAAAAAAAAAADTLAAAAAAAANQsAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAwSwAAAAAAADBLAAAAAAAAAAAAAAAAPC/"
				],
				[
					1403,
					1,
					"insert",
					{
						"characters": "move"
					},
					"BAAAANQsAAAAAAAA1SwAAAAAAAAAAAAA1SwAAAAAAADWLAAAAAAAAAAAAADWLAAAAAAAANcsAAAAAAAAAAAAANcsAAAAAAAA2CwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA1CwAAAAAAADULAAAAAAAAAAAAAAAAPC/"
				],
				[
					1404,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAANgsAAAAAAAA2iwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA2CwAAAAAAADYLAAAAAAAAAAAAAAAAPC/"
				],
				[
					1405,
					1,
					"insert",
					{
						"characters": "self,"
					},
					"BQAAANksAAAAAAAA2iwAAAAAAAAAAAAA2iwAAAAAAADbLAAAAAAAAAAAAADbLAAAAAAAANwsAAAAAAAAAAAAANwsAAAAAAAA3SwAAAAAAAAAAAAA3SwAAAAAAADeLAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA2SwAAAAAAADZLAAAAAAAAAAAAAAAAPC/"
				],
				[
					1406,
					1,
					"insert",
					{
						"characters": " inlet"
					},
					"BgAAAN4sAAAAAAAA3ywAAAAAAAAAAAAA3ywAAAAAAADgLAAAAAAAAAAAAADgLAAAAAAAAOEsAAAAAAAAAAAAAOEsAAAAAAAA4iwAAAAAAAAAAAAA4iwAAAAAAADjLAAAAAAAAAAAAADjLAAAAAAAAOQsAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA3iwAAAAAAADeLAAAAAAAAAAAAAAAAPC/"
				],
				[
					1411,
					2,
					"left_delete",
					null,
					"AgAAAOYsAAAAAAAA5iwAAAAAAAA9AAAAICAgICAgICAgICAgZHJhZnQuc2V0TGluZShtYWtlTGluZUJldHdlZW5TaGFwZXMoc2VsZiwgaW5sZXQpKeUsAAAAAAAA5SwAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAAIy0AAAAAAADmLAAAAAAAAAAAAAAAAPC/"
				],
				[
					1415,
					1,
					"left_delete",
					null,
					"AQAAAA4tAAAAAAAADi0AAAAAAAAWAAAAbWFrZUxpbmVCZXR3ZWVuU2hhcGVzKA",
					"AQAAAAAAAAABAAAADi0AAAAAAAAkLQAAAAAAAAAAAAAAAPC/"
				],
				[
					1418,
					1,
					"left_delete",
					null,
					"AQAAACUtAAAAAAAAJS0AAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAAJi0AAAAAAAAmLQAAAAAAAAAAAAAAAPC/"
				],
				[
					1427,
					1,
					"insert",
					{
						"characters": "move"
					},
					"BQAAAAYtAAAAAAAABy0AAAAAAAAAAAAABy0AAAAAAAAHLQAAAAAAAAcAAABzZXRMaW5lBy0AAAAAAAAILQAAAAAAAAAAAAAILQAAAAAAAAktAAAAAAAAAAAAAAktAAAAAAAACi0AAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAABi0AAAAAAAANLQAAAAAAAAAAAAAAAPC/"
				],
				[
					1428,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAmz8AAAAAAACbPwAAIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgVGhlIE5ldHdvcmsgU2NlbmUgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiMKIyBBICdWaWV3JyB0byByZXByZXNlbnQgYSBuZXR3b3JrIG9mIG5vZGVzLCBjb25uZWN0ZWQgYnkgaW5sZXRzIGFuZCBvdXRsZXRzCiMKCiMgSW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoaXMgaXMgYSAnVmlldycuCiMgSXQgaXMgcmVzcG9uc2libGUgdG8gcHJlc2VudCAoYW5kIHBvdGVudGlhbGx5IGVkaXQpIHRoZSBOWEdyYXBoTW9kZWwKIyBHcmFwaFNjZW5lICdpbnRlcm5hbHknIHVzZXMgc3ViY2xhc3NlcyBvZiBHcmFwaFNoYXBlcyB0aGF0IGFyZSBhbHNvICd2aWV3cycuCiMgdGhlc2Ugd2lkZ2V0cyBhcmUgcmVzcG9uc2libGUgdG8gcmVmZXJlbmNlIHRoZSBncmFwaHNjZW5lLAojIGFuZCB0aGUgcmVwcmVzZW50ZWQgbm9kZXMsIGVkZ2UgYW5kIHBvcnRzLgojCiMgVE9ETzogbW92ZSB0aGUgbW9kZWwgZWRpdGluZyBjYXBhYmlsaXRpZXMKIyBmcm9tIHRoZSB3aWRnZXRzIHRvIGEgZGVsZWdhdGUsIG9yIHRoZSBncmFwaHNlbmUgaXRzZWxmCgoKZnJvbSB0eXBpbmcgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0R3VpIGltcG9ydCAqCmZyb20gUHlTaWRlNi5RdENvcmUgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0V2lkZ2V0cyBpbXBvcnQgKgoKCkNvbm5lY3Rpb25FbnRlclR5cGUgPSBRRXZlbnQuVHlwZShRRXZlbnQucmVnaXN0ZXJFdmVudFR5cGUoKSkKQ29ubmVjdGlvbkxlYXZlVHlwZSA9IFFFdmVudC5UeXBlKFFFdmVudC5yZWdpc3RlckV2ZW50VHlwZSgpKQpDb25uZWN0aW9uTW92ZVR5cGUgPSBRRXZlbnQuVHlwZShRRXZlbnQucmVnaXN0ZXJFdmVudFR5cGUoKSkKQ29ubmVjdGlvbkRyb3BUeXBlID0gUUV2ZW50LlR5cGUoUUV2ZW50LnJlZ2lzdGVyRXZlbnRUeXBlKCkpCgppbXBvcnQgbnVtcHkgYXMgbnAKaW1wb3J0IG5ldHdvcmt4IGFzIG54CgoKIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCmZyb20gcHlsaXZlLk5ldHdvcmtYR3JhcGhFZGl0b3IubnhfZ3JhcGhfc2hhcGVzIGltcG9ydCAoCiAgICBOb2RlU2hhcGUsCiAgICBMaW5rU2hhcGUsCiAgICBQb3J0U2hhcGUsCikKCgojIyMjIyMjIyMjIyMjIwojIEdSQVBIU0NFTkUgIwojIyMjIyMjIyMjIyMjIwoKZnJvbSBweWxpdmUuTmV0d29ya1hHcmFwaEVkaXRvci5ueF9ncmFwaF9tb2RlbCBpbXBvcnQgTlhHcmFwaE1vZGVsCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKCnR5cGUgTm9kZUlkID0gSGFzaGFibGUKCgpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBPdXRsZXRJZDoKICAgIG5vZGVJZDogTm9kZUlkCiAgICBuYW1lOiBzdHIKCgpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBJbmxldElkOgogICAgbm9kZUlkOiBOb2RlSWQKICAgIG5hbWU6IHN0cgoKCnR5cGUgTGlua0lkID0gdHVwbGVbTm9kZUlkLCBOb2RlSWQsIHR1cGxlW3N0ciwgc3RyXV0KCgpjbGFzcyBOWEdyYXBoU2NlbmUoUUdyYXBoaWNzU2NlbmUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1vZGVsOiBOWEdyYXBoTW9kZWwpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuX21vZGVsID0gbW9kZWwKICAgICAgICBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHM6IGRpY3RbTm9kZUlkLCBOb2RlR3JhcGhpY3NPYmplY3RdID0gZGljdCgpCiAgICAgICAgc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFsKICAgICAgICAgICAgSW5sZXRJZCwgSW5sZXRHcmFwaGljc09iamVjdAogICAgICAgIF0gPSBkaWN0KCkKICAgICAgICBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFsKICAgICAgICAgICAgT3V0bGV0SWQsIE91dGxldEdyYXBoaWNzT2JqZWN0CiAgICAgICAgXSA9IGRpY3QoKQogICAgICAgIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFtMaW5rSWQsIExpbmtHcmFwaGljc09iamVjdF0gPSBkaWN0KCkKICAgICAgICBzZWxmLl9kcmFmdF9saW5rOiBMaW5rR3JhcGhpY3NPYmplY3QgfCBOb25lID0gTm9uZQoKICAgICAgICBzZWxmLnNldEl0ZW1JbmRleE1ldGhvZChRR3JhcGhpY3NTY2VuZS5JdGVtSW5kZXhNZXRob2QuTm9JbmRleCkKCiAgICAgICAgc2VsZi5fbW9kZWwubm9kZXNBZGRlZC5jb25uZWN0KAogICAgICAgICAgICBsYW1iZGEgbm9kZXM6IFtzZWxmLm9uTm9kZUNyZWF0ZWQobikgZm9yIG4gaW4gbm9kZXNdCiAgICAgICAgKQogICAgICAgIHNlbGYuX21vZGVsLm5vZGVzQWJvdXRUb0JlUmVtb3ZlZC5jb25uZWN0KAogICAgICAgICAgICBsYW1iZGEgbm9kZXM6IFtzZWxmLm9uTm9kZURlbGV0ZWQobikgZm9yIG4gaW4gbm9kZXNdCiAgICAgICAgKQogICAgICAgIHNlbGYuX21vZGVsLmVkZ2VzQWRkZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIGVkZ2VzOiBbc2VsZi5vbkxpbmtDcmVhdGVkKGUpIGZvciBlIGluIGVkZ2VzXQogICAgICAgICkKICAgICAgICBzZWxmLl9tb2RlbC5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIGVkZ2VzOiBbc2VsZi5vbkxpbmtEZWxldGVkKGUpIGZvciBlIGluIGVkZ2VzXQogICAgICAgICkKCiAgICAgICAgc2VsZi50cmF2ZXJzZUdyYXBoQW5kUG9wdWxhdGVHcmFwaGljc09iamVjdHMoKQogICAgICAgIHNlbGYuZHJhZnQ6IExpbmtTaGFwZSB8IE5vbmUgPSBOb25lICAjIHRvZG8gdXNlIHRoZSB3aWRnZXQgaXRzZWxmCiAgICAgICAgc2VsZi5sYXlvdXQoKQoKICAgIGRlZiB0cmF2ZXJzZUdyYXBoQW5kUG9wdWxhdGVHcmFwaGljc09iamVjdHMoc2VsZik6CiAgICAgICAgYWxsTm9kZUlkczogbGlzdFtOb2RlSWRdID0gc2VsZi5fbW9kZWwubm9kZXMoKQoKICAgICAgICAjIEZpcnN0IGNyZWF0ZSBhbGwgdGhlIG5vZGVzLgogICAgICAgIGZvciBub2RlSWQgaW4gYWxsTm9kZUlkczoKICAgICAgICAgICAgc2VsZi5vbk5vZGVDcmVhdGVkKG5vZGVJZCkKCiAgICAgICAgZm9yIGUgaW4gc2VsZi5fbW9kZWwuZWRnZXMoKToKICAgICAgICAgICAgdSwgdiwgKG8sIGkpID0gZQogICAgICAgICAgICBhc3NlcnQgdSBpbiBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHMKICAgICAgICAgICAgYXNzZXJ0IHYgaW4gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzCiAgICAgICAgICAgIGFzc2VydCAoCiAgICAgICAgICAgICAgICBPdXRsZXRJZCh1LCBvKSBpbiBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0cwogICAgICAgICAgICApLCBmIk5vZGUgJ3t1fScgaGFzIG5vIG91dGxldCAne299JyEiCiAgICAgICAgICAgIGFzc2VydCAoCiAgICAgICAgICAgICAgICBJbmxldElkKHYsIGkpIGluIHNlbGYuX2lubGV0X2dyYXBoaWNzX29iamVjdHMKICAgICAgICAgICAgKSwgZiJOb2RlICd7dn0nIGhhcyBubyBpbmxldCAne2l9JyEiCgogICAgICAgICAgICBsaW5rID0gTGlua0dyYXBoaWNzT2JqZWN0KCh1LCB2LCAobywgaSkpKQogICAgICAgICAgICBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHNbKHUsIHYsIChvLCBpKSldID0gbGluawogICAgICAgICAgICBzZWxmLmFkZEl0ZW0obGluaykKCiAgICAgICAgICAgIGxpbmsubW92ZSgKICAgICAgICAgICAgICAgIHNlbGYub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpLAogICAgICAgICAgICAgICAgc2VsZi5pbmxldEdyYXBoaWNzT2JqZWN0KElubGV0SWQodiwgaSkpLAogICAgICAgICAgICApCgogICAgZGVmIGxpbmtHcmFwaGljc09iamVjdChzZWxmLCBlOiBMaW5rSWQpIC0+ICJMaW5rR3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHNbZV0KCiAgICBkZWYgbm9kZUdyYXBoaWNzT2JqZWN0KHNlbGYsIG46IE5vZGVJZCkgLT4gIk5vZGVHcmFwaGljc09iamVjdCI6CiAgICAgICAgcmV0dXJuIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0c1tuXQoKICAgIGRlZiBpbmxldEdyYXBoaWNzT2JqZWN0KHNlbGYsIGk6IElubGV0SWQpIC0+ICJJbmxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0c1tpXQoKICAgIGRlZiBvdXRsZXRHcmFwaGljc09iamVjdChzZWxmLCBvOiBPdXRsZXRJZCkgLT4gIk91dGxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gc2VsZi5fb3V0bGV0X2dyYXBoaWNzX29iamVjdHNbb10KCiAgICBkZWYgdXBkYXRlQXR0YWNoZWROb2RlcyhzZWxmLCBlOiBMaW5rSWQsIGtpbmQ6IExpdGVyYWxbImluIiwgIm91dCJdKToKICAgICAgICB1LCB2LCBrID0gZQogICAgICAgIG1hdGNoIGtpbmQ6CiAgICAgICAgICAgIGNhc2UgImluIjoKICAgICAgICAgICAgICAgIGlmIG5vZGUgOj0gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzLmdldCh1LCBOb25lKToKICAgICAgICAgICAgICAgICAgICBub2RlLnVwZGF0ZSgpCiAgICAgICAgICAgIGNhc2UgIm91dCI6CiAgICAgICAgICAgICAgICBpZiBub2RlIDo9IHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cy5nZXQodiwgTm9uZSk6CiAgICAgICAgICAgICAgICAgICAgbm9kZS51cGRhdGUoKQoKICAgIGRlZiBpc0xpbmtlZChzZWxmLCBwb3J0OiBJbmxldElkIHwgT3V0bGV0SWQpIC0+IGJvb2w6CiAgICAgICAgbWF0Y2ggcG9ydDoKICAgICAgICAgICAgY2FzZSBJbmxldElkKCk6CiAgICAgICAgICAgICAgICBmb3IgdSwgdiwgKG8sIGkpIGluIHNlbGYuX21vZGVsLmluRWRnZXMocG9ydC5ub2RlSWQpOgogICAgICAgICAgICAgICAgICAgIGlmIGkgPT0gcG9ydC5uYW1lOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICBjYXNlIE91dGxldElkKCk6CiAgICAgICAgICAgICAgICBmb3IgdSwgdiwgKG8sIGkpIGluIHNlbGYuX21vZGVsLm91dEVkZ2VzKHBvcnQubm9kZUlkKToKICAgICAgICAgICAgICAgICAgICBpZiBvID09IHBvcnQubmFtZToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAjIyMgSGFuZGxlIE1vZGVsIFNpZ25hbHMgPj4+CiAgICBkZWYgb25MaW5rRGVsZXRlZChzZWxmLCBlOiBMaW5rSWQpOgogICAgICAgIHNlbGYucmVtb3ZlSXRlbShzZWxmLmxpbmtHcmFwaGljc09iamVjdChlKSkKICAgICAgICBpZiBlIGluIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0czoKICAgICAgICAgICAgZGVsIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0c1tlXQoKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgImluIikKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgIm91dCIpCgogICAgZGVmIG9uTGlua0NyZWF0ZWQoc2VsZiwgZTogTGlua0lkKToKICAgICAgICBsaW5rID0gTGlua0dyYXBoaWNzT2JqZWN0KGUpCiAgICAgICAgc2VsZi5fbGlua19ncmFwaGljc19vYmplY3RzW2VdID0gbGluawogICAgICAgIHNlbGYuYWRkSXRlbShzZWxmLmxpbmtHcmFwaGljc09iamVjdChlKSkKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgImluIikKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgIm91dCIpCgogICAgICAgIHUsIHYsIChvLCBpKSA9IGUKICAgICAgICBsaW5rLm1vdmUoCiAgICAgICAgICAgIHNlbGYub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpLAogICAgICAgICAgICBzZWxmLmlubGV0R3JhcGhpY3NPYmplY3QoSW5sZXRJZCh2LCBpKSksCiAgICAgICAgKQoKICAgIGRlZiBtYWtlRHJhZnRMaW5rKHNlbGYpOgogICAgICAgIHNlbGYuZHJhZnQgPSBMaW5rU2hhcGUoKQogICAgICAgIHNlbGYuZHJhZnQuc2V0QWNjZXB0ZWRNb3VzZUJ1dHRvbnMoUXQuTW91c2VCdXR0b24uTm9CdXR0b24pCiAgICAgICAgc2VsZi5kcmFmdC5zZXRBY2NlcHRIb3ZlckV2ZW50cyhGYWxzZSkKICAgICAgICBzZWxmLmRyYWZ0LnNldEVuYWJsZWQoRmFsc2UpCiAgICAgICAgc2VsZi5kcmFmdC5zZXRBY3RpdmUoRmFsc2UpCiAgICAgICAgc2VsZi5hZGRJdGVtKHNlbGYuZHJhZnQpCgogICAgZGVmIHJlc2V0RHJhZnRMaW5rKHNlbGYpOgogICAgICAgIGFzc2VydCBzZWxmLmRyYWZ0IGlzIG5vdCBOb25lCiAgICAgICAgc2VsZi5yZW1vdmVJdGVtKHNlbGYuZHJhZnQpCiAgICAgICAgc2VsZi5kcmFmdCA9IE5vbmUKCiAgICBkZWYgb25Ob2RlQ3JlYXRlZChzZWxmLCBuOiBOb2RlSWQpOgogICAgICAgIGlubGV0X25hbWVzID0gKAogICAgICAgICAgICBzZWxmLl9tb2RlbC5nZXROb2RlUHJvcGVydHkobiwgImlubGV0cyIpCiAgICAgICAgICAgIGlmIHNlbGYuX21vZGVsLmhhc05vZGVQcm9wZXJ0eShuLCAiaW5sZXRzIikKICAgICAgICAgICAgZWxzZSBbXQogICAgICAgICkKCiAgICAgICAgaW5sZXRzID0gW10KICAgICAgICBpZiBzZWxmLl9tb2RlbC5oYXNOb2RlUHJvcGVydHkobiwgImlubGV0cyIpOgogICAgICAgICAgICBpbmxldE5hbWVzID0gc2VsZi5fbW9kZWwuZ2V0Tm9kZVByb3BlcnR5KG4sICJpbmxldHMiKQogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShpbmxldE5hbWVzLCBsaXN0KSBhbmQgYWxsKAogICAgICAgICAgICAgICAgaXNpbnN0YW5jZShfLCBzdHIpIGZvciBfIGluIGlubGV0TmFtZXMKICAgICAgICAgICAgKQogICAgICAgICAgICBmb3IgaW5sZXROYW1lIGluIGlubGV0TmFtZXM6CiAgICAgICAgICAgICAgICBpbmxldF9ncmFwaGljc19vYmplY3QgPSBJbmxldEdyYXBoaWNzT2JqZWN0KAogICAgICAgICAgICAgICAgICAgIElubGV0SWQobiwgaW5sZXROYW1lKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0c1sKICAgICAgICAgICAgICAgICAgICBJbmxldElkKG4sIGlubGV0TmFtZSkKICAgICAgICAgICAgICAgIF0gPSBpbmxldF9ncmFwaGljc19vYmplY3QKICAgICAgICAgICAgICAgIGlubGV0cy5hcHBlbmQoaW5sZXRfZ3JhcGhpY3Nfb2JqZWN0KQoKICAgICAgICBvdXRsZXRzID0gW10KICAgICAgICBpZiBzZWxmLl9tb2RlbC5oYXNOb2RlUHJvcGVydHkobiwgIm91dGxldHMiKToKICAgICAgICAgICAgb3V0bGV0TmFtZXMgPSBzZWxmLl9tb2RlbC5nZXROb2RlUHJvcGVydHkobiwgIm91dGxldHMiKQogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShvdXRsZXROYW1lcywgbGlzdCkgYW5kIGFsbCgKICAgICAgICAgICAgICAgIGlzaW5zdGFuY2UoXywgc3RyKSBmb3IgXyBpbiBvdXRsZXROYW1lcwogICAgICAgICAgICApCiAgICAgICAgICAgIGZvciBvdXRsZXROYW1lIGluIG91dGxldE5hbWVzOgogICAgICAgICAgICAgICAgb3V0bGV0X2dyYXBoaWNzX29iamVjdCA9IE91dGxldEdyYXBoaWNzT2JqZWN0KAogICAgICAgICAgICAgICAgICAgIE91dGxldElkKG4sIG91dGxldE5hbWUpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0c1sKICAgICAgICAgICAgICAgICAgICBPdXRsZXRJZChuLCBvdXRsZXROYW1lKQogICAgICAgICAgICAgICAgXSA9IG91dGxldF9ncmFwaGljc19vYmplY3QKICAgICAgICAgICAgICAgIG91dGxldHMuYXBwZW5kKG91dGxldF9ncmFwaGljc19vYmplY3QpCgogICAgICAgIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0c1tuXSA9IE5vZGVHcmFwaGljc09iamVjdCgKICAgICAgICAgICAgbiwgaW5sZXRzPWlubGV0cywgb3V0bGV0cz1vdXRsZXRzCiAgICAgICAgKQoKICAgICAgICBzZWxmLmFkZEl0ZW0oc2VsZi5ub2RlR3JhcGhpY3NPYmplY3QobikpCgogICAgZGVmIG9uTm9kZURlbGV0ZWQoc2VsZiwgbjogTm9kZUlkKToKICAgICAgICBpZiBuIGluIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0czoKICAgICAgICAgICAgbm9kZV9ncmFwaGljc19vYmplY3QgPSBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHNbbl0KICAgICAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcigpCgogICAgZGVmIG9uTW9kZWxSZXNldChzZWxmKToKICAgICAgICBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHMuY2xlYXIoKQogICAgICAgIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cy5jbGVhcigpCiAgICAgICAgc2VsZi5jbGVhcigpCgogICAgICAgIHNlbGYudHJhdmVyc2VHcmFwaEFuZFBvcHVsYXRlR3JhcGhpY3NPYmplY3RzKCkKCiAgICAjIyMgPDw8IEhhbmRsZSBNb2RlbCBTaWduYWxzCiAgICBkZWYgX2ZpbmRHcmFwaEl0ZW1BdChzZWxmLCBrbGFzcywgcG9zaXRpb246IFFQb2ludEYpOgogICAgICAgICMgZmluZCBvdXRsZXQgdW5kZXIgbW91c2UKICAgICAgICBmb3IgaXRlbSBpbiBzZWxmLml0ZW1zKHBvc2l0aW9uLCBkZXZpY2VUcmFuc2Zvcm09UVRyYW5zZm9ybSgpKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVtLCBrbGFzcyk6CiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbQoKICAgIGRlZiBvdXRsZXRBdChzZWxmLCBwb3NpdGlvbjogUVBvaW50RikgLT4gIk91dGxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgT3V0bGV0R3JhcGhpY3NPYmplY3QsCiAgICAgICAgICAgIHNlbGYuX2ZpbmRHcmFwaEl0ZW1BdChPdXRsZXRHcmFwaGljc09iamVjdCwgcG9zaXRpb24pLAogICAgICAgICkKCiAgICBkZWYgaW5sZXRBdChzZWxmLCBwb3NpdGlvbjogUVBvaW50RikgLT4gIklubGV0R3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBjYXN0KAogICAgICAgICAgICBJbmxldEdyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoSW5sZXRHcmFwaGljc09iamVjdCwgcG9zaXRpb24pLAogICAgICAgICkKCiAgICBkZWYgbm9kZUF0KHNlbGYsIHBvc2l0aW9uOiBRUG9pbnRGKSAtPiAiTm9kZUdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgTm9kZUdyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoTm9kZUdyYXBoaWNzT2JqZWN0LCBwb3NpdGlvbiksCiAgICAgICAgKQoKICAgIGRlZiBsaW5rQXQoc2VsZiwgcG9zaXRpb246IFFQb2ludEYpIC0+ICJMaW5rR3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBjYXN0KAogICAgICAgICAgICBMaW5rR3JhcGhpY3NPYmplY3QsCiAgICAgICAgICAgIHNlbGYuX2ZpbmRHcmFwaEl0ZW1BdChMaW5rR3JhcGhpY3NPYmplY3QsIHBvc2l0aW9uKSwKICAgICAgICApCgogICAgZGVmIGxheW91dChzZWxmKToKICAgICAgICBkZWYgaGllYXJjaGljYWxfbGF5b3V0X3dpdGhfZ3JhbmRhbGYoRywgc2NhbGU9MSk6CiAgICAgICAgICAgIGltcG9ydCBncmFuZGFsZgogICAgICAgICAgICBmcm9tIGdyYW5kYWxmLmxheW91dHMgaW1wb3J0IFN1Z2l5YW1hTGF5b3V0CgogICAgICAgICAgICBnID0gZ3JhbmRhbGYudXRpbHMuY29udmVydF9uZXh0d29ya3hfZ3JhcGhfdG9fZ3JhbmRhbGYoRykKCiAgICAgICAgICAgIGNsYXNzIGRlZmF1bHR2aWV3KG9iamVjdCk6ICAjIHNlZSBSRUFETUUgb2YgZ3JhbmRhbGYncyBnaXRodWIKICAgICAgICAgICAgICAgIHcsIGggPSBzY2FsZSwgc2NhbGUKCiAgICAgICAgICAgIGZvciB2IGluIGcuQ1swXS5zVjoKICAgICAgICAgICAgICAgIHYudmlldyA9IGRlZmF1bHR2aWV3KCkKICAgICAgICAgICAgc3VnID0gU3VnaXlhbWFMYXlvdXQoZy5DWzBdKQogICAgICAgICAgICBzdWcuaW5pdF9hbGwoKSAgIyByb290cz1bVlswXV0pCiAgICAgICAgICAgIHN1Zy5kcmF3KCkKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHYuZGF0YTogKHYudmlldy54eVswXSwgdi52aWV3Lnh5WzFdKSBmb3IgdiBpbiBnLkNbMF0uc1YKICAgICAgICAgICAgfSAgIyBFeHRyYWN0cyB0aGUgcG9zaXRpb25zCgogICAgICAgIGRlZiBoaWVhcmNoaWNhbF9sYXlvdXRfd2l0aF9ueChHLCBzY2FsZT0xMDApOgogICAgICAgICAgICBmb3IgbGF5ZXIsIG5vZGVzIGluIGVudW1lcmF0ZSgKICAgICAgICAgICAgICAgIHJldmVyc2VkKHR1cGxlKG54LnRvcG9sb2dpY2FsX2dlbmVyYXRpb25zKEcpKSkKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICMgYG11bHRpcGFydGl0ZV9sYXlvdXRgIGV4cGVjdHMgdGhlIGxheWVyIGFzIGEgbm9kZSBhdHRyaWJ1dGUsIHNvIGFkZCB0aGUKICAgICAgICAgICAgICAgICMgbnVtZXJpYyBsYXllciB2YWx1ZSBhcyBhIG5vZGUgYXR0cmlidXRlCiAgICAgICAgICAgICAgICBmb3Igbm9kZSBpbiBub2RlczoKICAgICAgICAgICAgICAgICAgICBHLm5vZGVzW25vZGVdWyJsYXllciJdID0gLWxheWVyCgogICAgICAgICAgICAjIENvbXB1dGUgdGhlIG11bHRpcGFydGl0ZV9sYXlvdXQgdXNpbmcgdGhlICJsYXllciIgbm9kZSBhdHRyaWJ1dGUKICAgICAgICAgICAgcG9zID0gbngubXVsdGlwYXJ0aXRlX2xheW91dCgKICAgICAgICAgICAgICAgIEcsIHN1YnNldF9rZXk9ImxheWVyIiwgYWxpZ249Imhvcml6b250YWwiCiAgICAgICAgICAgICkKICAgICAgICAgICAgZm9yIG4sIHAgaW4gcG9zLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBwb3Nbbl0gPSBwWzBdICogc2NhbGUsIHBbMV0gKiBzY2FsZQogICAgICAgICAgICByZXR1cm4gcG9zCgogICAgICAgIHBvcyA9IGhpZWFyY2hpY2FsX2xheW91dF93aXRoX254KHNlbGYuX21vZGVsLkcsIHNjYWxlPTEwMCkKICAgICAgICBmb3IgTiwgKHgsIHkpIGluIHBvcy5pdGVtcygpOgogICAgICAgICAgICB3aWRnZXQgPSBzZWxmLm5vZGVHcmFwaGljc09iamVjdChOKQogICAgICAgICAgICB3aWRnZXQuc2V0UG9zKHgsIHkpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgQWN0aXZlIEdyYXBoaWNzIE9iamVjdHMgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgpjbGFzcyBPdXRsZXRHcmFwaGljc09iamVjdChQb3J0U2hhcGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG86IE91dGxldElkKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGxhYmVsPWYie28ubmFtZX0iKQogICAgICAgIHNlbGYuX28gPSBvCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIG1vdXNlUHJlc3NFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLm1ha2VEcmFmdExpbmsoKQogICAgICAgIHNlbGYuZ3JhYk1vdXNlKCkKCiAgICBkZWYgbW91c2VNb3ZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBkcmFmdCA9IHNlbGYuZ3JhcGhzY2VuZSgpLmRyYWZ0CiAgICAgICAgYXNzZXJ0IGRyYWZ0IGlzIG5vdCBOb25lCgogICAgICAgIGlmIGlubGV0IDo9IHNlbGYuZ3JhcGhzY2VuZSgpLmlubGV0QXQoZXZlbnQuc2NlbmVQb3MoKSk6CiAgICAgICAgICAgIGRyYWZ0Lm1vdmUoc2VsZiwgaW5sZXQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZHJhZnQubW92ZShzZWxmLCBldmVudC5zY2VuZVBvcygpKQogICAgICAgIHJldHVybiBzdXBlcigpLm1vdXNlTW92ZUV2ZW50KGV2ZW50KQoKICAgIGRlZiBtb3VzZVJlbGVhc2VFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYudW5ncmFiTW91c2UoKQogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLnJlc2V0RHJhZnRMaW5rKCkKCiAgICAgICAgaWYgaW5sZXQgOj0gc2VsZi5ncmFwaHNjZW5lKCkuaW5sZXRBdChldmVudC5zY2VuZVBvcygpKToKICAgICAgICAgICAgc2NlbmUgPSBzZWxmLmdyYXBoc2NlbmUoKQogICAgICAgICAgICBzY2VuZS5fbW9kZWwuYWRkRWRnZSgKICAgICAgICAgICAgICAgIHNlbGYuX28ubm9kZUlkLCBpbmxldC5faS5ub2RlSWQsIChzZWxmLl9vLm5hbWUsIGlubGV0Ll9pLm5hbWUpCiAgICAgICAgICAgICkKCiAgICAgICAgcmV0dXJuIHN1cGVyKCkubW91c2VSZWxlYXNlRXZlbnQoZXZlbnQpCgogICAgZGVmIGJydXNoKHNlbGYpOgogICAgICAgIGJydXNoID0gc3VwZXIoKS5icnVzaCgpCiAgICAgICAgaWYgc2VsZi5ncmFwaHNjZW5lKCkuaXNMaW5rZWQoc2VsZi5fbyk6CiAgICAgICAgICAgIGJydXNoID0gc2VsZi5wYWxldHRlKCkudGV4dCgpCgogICAgICAgIHJldHVybiBicnVzaAoKCmNsYXNzIElubGV0R3JhcGhpY3NPYmplY3QoUG9ydFNoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpOiBJbmxldElkKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGxhYmVsPWYie2kubmFtZX0iKQogICAgICAgIHNlbGYuX2kgPSBpCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIG1vdXNlUHJlc3NFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLm1ha2VEcmFmdExpbmsoKQogICAgICAgIHNlbGYuZ3JhYk1vdXNlKCkKCiAgICBkZWYgbW91c2VNb3ZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBkcmFmdCA9IHNlbGYuZ3JhcGhzY2VuZSgpLmRyYWZ0CiAgICAgICAgYXNzZXJ0IGRyYWZ0IGlzIG5vdCBOb25lCgogICAgICAgIGlmIG91dGxldCA6PSBzZWxmLmdyYXBoc2NlbmUoKS5vdXRsZXRBdChldmVudC5zY2VuZVBvcygpKToKICAgICAgICAgICAgZHJhZnQuc2V0TGluZShtYWtlTGluZUJldHdlZW5TaGFwZXMob3V0bGV0LCBzZWxmKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBkcmFmdC5zZXRMaW5lKG1ha2VMaW5lQmV0d2VlblNoYXBlcyhldmVudC5zY2VuZVBvcygpLCBzZWxmKSkKICAgICAgICByZXR1cm4gc3VwZXIoKS5tb3VzZU1vdmVFdmVudChldmVudCkKCiAgICBkZWYgbW91c2VSZWxlYXNlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBzZWxmLnVuZ3JhYk1vdXNlKCkKICAgICAgICBzZWxmLmdyYXBoc2NlbmUoKS5yZXNldERyYWZ0TGluaygpCgogICAgICAgIGlmIG91dGxldCA6PSBzZWxmLmdyYXBoc2NlbmUoKS5vdXRsZXRBdChldmVudC5zY2VuZVBvcygpKToKICAgICAgICAgICAgc2VsZi5ncmFwaHNjZW5lKCkuX21vZGVsLmFkZEVkZ2UoCiAgICAgICAgICAgICAgICBvdXRsZXQuX28ubm9kZUlkLCBzZWxmLl9pLm5vZGVJZCwgKG91dGxldC5fby5uYW1lLCBzZWxmLl9pLm5hbWUpCiAgICAgICAgICAgICkKCiAgICAgICAgcmV0dXJuIHN1cGVyKCkubW91c2VSZWxlYXNlRXZlbnQoZXZlbnQpCgogICAgZGVmIGJydXNoKHNlbGYpOgogICAgICAgIGJydXNoID0gc3VwZXIoKS5icnVzaCgpCiAgICAgICAgaWYgc2VsZi5ncmFwaHNjZW5lKCkuaXNMaW5rZWQoc2VsZi5faSk6CiAgICAgICAgICAgIGJydXNoID0gc2VsZi5wYWxldHRlKCkudGV4dCgpCgogICAgICAgIHJldHVybiBicnVzaAoKCmNsYXNzIE5vZGVHcmFwaGljc09iamVjdChOb2RlU2hhcGUpOgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgbjogTm9kZUlkLAogICAgICAgIGlubGV0czogbGlzdFtJbmxldEdyYXBoaWNzT2JqZWN0XSwKICAgICAgICBvdXRsZXRzOiBsaXN0W091dGxldEdyYXBoaWNzT2JqZWN0XSwKICAgICAgICBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygKICAgICAgICAgICAgdGl0bGU9ZiIne259JyIsCiAgICAgICAgICAgIGlubGV0cz1pbmxldHMsCiAgICAgICAgICAgIG91dGxldHM9b3V0bGV0cywKICAgICAgICAgICAgcGFyZW50PXBhcmVudCwKICAgICAgICApCiAgICAgICAgc2VsZi5fbiA9IG4KICAgICAgICBzZWxmLnNldEFjY2VwdEhvdmVyRXZlbnRzKEZhbHNlKQoKICAgIGRlZiBpdGVtQ2hhbmdlKAogICAgICAgIHNlbGYsIGNoYW5nZTogUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1DaGFuZ2UsIHZhbHVlOiBBbnkKICAgICkgLT4gQW55OgogICAgICAgIGlmICgKICAgICAgICAgICAgY2hhbmdlCiAgICAgICAgICAgID09IFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtQ2hhbmdlLkl0ZW1TY2VuZVBvc2l0aW9uSGFzQ2hhbmdlZAogICAgICAgICk6CiAgICAgICAgICAgIHNlbGYubW92ZUxpbmtzKCkKICAgICAgICByZXR1cm4gc3VwZXIoKS5pdGVtQ2hhbmdlKGNoYW5nZSwgdmFsdWUpCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIG1vdmVMaW5rcyhzZWxmKToKICAgICAgICAiIiJyZXNwb25zaWJsZSB0byB1cGRhdGUgY29ubmVjdGVkIGxpbmsgcG9zaXRpb24iIiIKICAgICAgICBtb2RlbCA9IHNlbGYuZ3JhcGhzY2VuZSgpLl9tb2RlbAogICAgICAgIGFsbF9lZGdlcyA9IG1vZGVsLmluRWRnZXMoc2VsZi5fbikgKyBtb2RlbC5vdXRFZGdlcyhzZWxmLl9uKQogICAgICAgIGZvciBlIGluIGFsbF9lZGdlczoKICAgICAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UoZVsyXSwgdHVwbGUpIGFuZCBsZW4oZVsyXSkgPT0gMgogICAgICAgICAgICB1LCB2LCAobywgaSkgPSBlCiAgICAgICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpCiAgICAgICAgICAgIG91dGxldCA9IHNlbGYuZ3JhcGhzY2VuZSgpLm91dGxldEdyYXBoaWNzT2JqZWN0KE91dGxldElkKHUsIG8pKQogICAgICAgICAgICBpbmxldCA9IHNlbGYuZ3JhcGhzY2VuZSgpLmlubGV0R3JhcGhpY3NPYmplY3QoSW5sZXRJZCh2LCBpKSkKICAgICAgICAgICAgZWRnZSA9IHNlbGYuZ3JhcGhzY2VuZSgpLmxpbmtHcmFwaGljc09iamVjdChlKQogICAgICAgICAgICBlZGdlLm1vdmUob3V0bGV0LCBpbmxldCkKCgpjbGFzcyBMaW5rR3JhcGhpY3NPYmplY3QoTGlua1NoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBlOiBMaW5rSWQsIHBhcmVudDogUUdyYXBoaWNzSXRlbSB8IE5vbmUgPSBOb25lKToKICAgICAgICB1LCB2LCAobywgaSkgPSBlCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhsYWJlbD1mIntvfS0+e2l9IiwgcGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9lID0gZQogICAgICAgIHNlbGYuc2V0WlZhbHVlKC0xKQoKICAgIGRlZiBncmFwaHNjZW5lKHNlbGYpIC0+ICJOWEdyYXBoU2NlbmUiOgogICAgICAgIHJldHVybiBjYXN0KE5YR3JhcGhTY2VuZSwgc2VsZi5zY2VuZSgpKQoKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIHJldHVybiBzdXBlcigpLmJvdW5kaW5nUmVjdCgpLmFkanVzdGVkKC01MCwgLTUwLCA1MCwgNTApCgoKIyMjIyMjIyMjIyMKIyBFWEFNUExFICMKIyMjIyMjIyMjIyMKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGltcG9ydCBzeXMKCiAgICBhcHAgPSBRQXBwbGljYXRpb24oc3lzLmFyZ3YpCgogICAgIyBzZXR1cCBtYWluIHdpbmRvdwogICAgdmlldyA9IFFHcmFwaGljc1ZpZXcoKQogICAgdmlldy5zZXRXaW5kb3dUaXRsZSgiTlhHcmFwaFNjZW5lIikKICAgIHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LkFudGlhbGlhc2luZywgVHJ1ZSkKICAgIHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlRleHRBbnRpYWxpYXNpbmcsIFRydWUpCiAgICB2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5TbW9vdGhQaXhtYXBUcmFuc2Zvcm0sIFRydWUpCgogICAgIyBjcmVhdGUgZ3JhcGggc2NlbmUKICAgIGdyYXBoID0gTlhHcmFwaE1vZGVsKCkKICAgIGdyYXBoLmFkZE5vZGUoIk4xIiwgb3V0bGV0cz1bIm91dCJdKQogICAgZ3JhcGguYWRkTm9kZSgiTjIiLCBpbmxldHM9WyJpbiJdKQogICAgZ3JhcGguYWRkTm9kZSgiTjMiLCBpbmxldHM9WyJpbiJdLCBvdXRsZXRzPVsib3V0Il0pCiAgICBncmFwaC5hZGRFZGdlKCJOMSIsICJOMiIsICgib3V0IiwgImluIikpCiAgICBncmFwaHNjZW5lID0gTlhHcmFwaFNjZW5lKGdyYXBoKQogICAgZ3JhcGhzY2VuZS5zZXRTY2VuZVJlY3QoUVJlY3RGKC00MDAsIC00MDAsIDgwMCwgODAwKSkKICAgIHZpZXcuc2V0U2NlbmUoZ3JhcGhzY2VuZSkKCiAgICAjIGdyYXBoc2NlbmUuYWRkSXRlbShHcmFwaGljc1ZlcnRleEl0ZW0oIkhXRUxMTyIpKQoKICAgICMgc2hvdyB3aW5kb3cKICAgIHZpZXcuc2hvdygpCiAgICBzeXMuZXhpdChhcHAuZXhlYygpKQo",
					"AQAAAAAAAAABAAAACi0AAAAAAAAKLQAAAAAAAAAAAAAAAPC/"
				],
				[
					1432,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAmz8AAAAAAACbPwAAIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgVGhlIE5ldHdvcmsgU2NlbmUgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiMKIyBBICdWaWV3JyB0byByZXByZXNlbnQgYSBuZXR3b3JrIG9mIG5vZGVzLCBjb25uZWN0ZWQgYnkgaW5sZXRzIGFuZCBvdXRsZXRzCiMKCiMgSW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoaXMgaXMgYSAnVmlldycuCiMgSXQgaXMgcmVzcG9uc2libGUgdG8gcHJlc2VudCAoYW5kIHBvdGVudGlhbGx5IGVkaXQpIHRoZSBOWEdyYXBoTW9kZWwKIyBHcmFwaFNjZW5lICdpbnRlcm5hbHknIHVzZXMgc3ViY2xhc3NlcyBvZiBHcmFwaFNoYXBlcyB0aGF0IGFyZSBhbHNvICd2aWV3cycuCiMgdGhlc2Ugd2lkZ2V0cyBhcmUgcmVzcG9uc2libGUgdG8gcmVmZXJlbmNlIHRoZSBncmFwaHNjZW5lLAojIGFuZCB0aGUgcmVwcmVzZW50ZWQgbm9kZXMsIGVkZ2UgYW5kIHBvcnRzLgojCiMgVE9ETzogbW92ZSB0aGUgbW9kZWwgZWRpdGluZyBjYXBhYmlsaXRpZXMKIyBmcm9tIHRoZSB3aWRnZXRzIHRvIGEgZGVsZWdhdGUsIG9yIHRoZSBncmFwaHNlbmUgaXRzZWxmCgoKZnJvbSB0eXBpbmcgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0R3VpIGltcG9ydCAqCmZyb20gUHlTaWRlNi5RdENvcmUgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0V2lkZ2V0cyBpbXBvcnQgKgoKCkNvbm5lY3Rpb25FbnRlclR5cGUgPSBRRXZlbnQuVHlwZShRRXZlbnQucmVnaXN0ZXJFdmVudFR5cGUoKSkKQ29ubmVjdGlvbkxlYXZlVHlwZSA9IFFFdmVudC5UeXBlKFFFdmVudC5yZWdpc3RlckV2ZW50VHlwZSgpKQpDb25uZWN0aW9uTW92ZVR5cGUgPSBRRXZlbnQuVHlwZShRRXZlbnQucmVnaXN0ZXJFdmVudFR5cGUoKSkKQ29ubmVjdGlvbkRyb3BUeXBlID0gUUV2ZW50LlR5cGUoUUV2ZW50LnJlZ2lzdGVyRXZlbnRUeXBlKCkpCgppbXBvcnQgbnVtcHkgYXMgbnAKaW1wb3J0IG5ldHdvcmt4IGFzIG54CgoKIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCmZyb20gcHlsaXZlLk5ldHdvcmtYR3JhcGhFZGl0b3IubnhfZ3JhcGhfc2hhcGVzIGltcG9ydCAoCiAgICBOb2RlU2hhcGUsCiAgICBMaW5rU2hhcGUsCiAgICBQb3J0U2hhcGUsCikKCgojIyMjIyMjIyMjIyMjIwojIEdSQVBIU0NFTkUgIwojIyMjIyMjIyMjIyMjIwoKZnJvbSBweWxpdmUuTmV0d29ya1hHcmFwaEVkaXRvci5ueF9ncmFwaF9tb2RlbCBpbXBvcnQgTlhHcmFwaE1vZGVsCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKCnR5cGUgTm9kZUlkID0gSGFzaGFibGUKCgpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBPdXRsZXRJZDoKICAgIG5vZGVJZDogTm9kZUlkCiAgICBuYW1lOiBzdHIKCgpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBJbmxldElkOgogICAgbm9kZUlkOiBOb2RlSWQKICAgIG5hbWU6IHN0cgoKCnR5cGUgTGlua0lkID0gdHVwbGVbTm9kZUlkLCBOb2RlSWQsIHR1cGxlW3N0ciwgc3RyXV0KCgpjbGFzcyBOWEdyYXBoU2NlbmUoUUdyYXBoaWNzU2NlbmUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1vZGVsOiBOWEdyYXBoTW9kZWwpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuX21vZGVsID0gbW9kZWwKICAgICAgICBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHM6IGRpY3RbTm9kZUlkLCBOb2RlR3JhcGhpY3NPYmplY3RdID0gZGljdCgpCiAgICAgICAgc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFsKICAgICAgICAgICAgSW5sZXRJZCwgSW5sZXRHcmFwaGljc09iamVjdAogICAgICAgIF0gPSBkaWN0KCkKICAgICAgICBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFsKICAgICAgICAgICAgT3V0bGV0SWQsIE91dGxldEdyYXBoaWNzT2JqZWN0CiAgICAgICAgXSA9IGRpY3QoKQogICAgICAgIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFtMaW5rSWQsIExpbmtHcmFwaGljc09iamVjdF0gPSBkaWN0KCkKICAgICAgICBzZWxmLl9kcmFmdF9saW5rOiBMaW5rR3JhcGhpY3NPYmplY3QgfCBOb25lID0gTm9uZQoKICAgICAgICBzZWxmLnNldEl0ZW1JbmRleE1ldGhvZChRR3JhcGhpY3NTY2VuZS5JdGVtSW5kZXhNZXRob2QuTm9JbmRleCkKCiAgICAgICAgc2VsZi5fbW9kZWwubm9kZXNBZGRlZC5jb25uZWN0KAogICAgICAgICAgICBsYW1iZGEgbm9kZXM6IFtzZWxmLm9uTm9kZUNyZWF0ZWQobikgZm9yIG4gaW4gbm9kZXNdCiAgICAgICAgKQogICAgICAgIHNlbGYuX21vZGVsLm5vZGVzQWJvdXRUb0JlUmVtb3ZlZC5jb25uZWN0KAogICAgICAgICAgICBsYW1iZGEgbm9kZXM6IFtzZWxmLm9uTm9kZURlbGV0ZWQobikgZm9yIG4gaW4gbm9kZXNdCiAgICAgICAgKQogICAgICAgIHNlbGYuX21vZGVsLmVkZ2VzQWRkZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIGVkZ2VzOiBbc2VsZi5vbkxpbmtDcmVhdGVkKGUpIGZvciBlIGluIGVkZ2VzXQogICAgICAgICkKICAgICAgICBzZWxmLl9tb2RlbC5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIGVkZ2VzOiBbc2VsZi5vbkxpbmtEZWxldGVkKGUpIGZvciBlIGluIGVkZ2VzXQogICAgICAgICkKCiAgICAgICAgc2VsZi50cmF2ZXJzZUdyYXBoQW5kUG9wdWxhdGVHcmFwaGljc09iamVjdHMoKQogICAgICAgIHNlbGYuZHJhZnQ6IExpbmtTaGFwZSB8IE5vbmUgPSBOb25lICAjIHRvZG8gdXNlIHRoZSB3aWRnZXQgaXRzZWxmCiAgICAgICAgc2VsZi5sYXlvdXQoKQoKICAgIGRlZiB0cmF2ZXJzZUdyYXBoQW5kUG9wdWxhdGVHcmFwaGljc09iamVjdHMoc2VsZik6CiAgICAgICAgYWxsTm9kZUlkczogbGlzdFtOb2RlSWRdID0gc2VsZi5fbW9kZWwubm9kZXMoKQoKICAgICAgICAjIEZpcnN0IGNyZWF0ZSBhbGwgdGhlIG5vZGVzLgogICAgICAgIGZvciBub2RlSWQgaW4gYWxsTm9kZUlkczoKICAgICAgICAgICAgc2VsZi5vbk5vZGVDcmVhdGVkKG5vZGVJZCkKCiAgICAgICAgZm9yIGUgaW4gc2VsZi5fbW9kZWwuZWRnZXMoKToKICAgICAgICAgICAgdSwgdiwgKG8sIGkpID0gZQogICAgICAgICAgICBhc3NlcnQgdSBpbiBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHMKICAgICAgICAgICAgYXNzZXJ0IHYgaW4gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzCiAgICAgICAgICAgIGFzc2VydCAoCiAgICAgICAgICAgICAgICBPdXRsZXRJZCh1LCBvKSBpbiBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0cwogICAgICAgICAgICApLCBmIk5vZGUgJ3t1fScgaGFzIG5vIG91dGxldCAne299JyEiCiAgICAgICAgICAgIGFzc2VydCAoCiAgICAgICAgICAgICAgICBJbmxldElkKHYsIGkpIGluIHNlbGYuX2lubGV0X2dyYXBoaWNzX29iamVjdHMKICAgICAgICAgICAgKSwgZiJOb2RlICd7dn0nIGhhcyBubyBpbmxldCAne2l9JyEiCgogICAgICAgICAgICBsaW5rID0gTGlua0dyYXBoaWNzT2JqZWN0KCh1LCB2LCAobywgaSkpKQogICAgICAgICAgICBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHNbKHUsIHYsIChvLCBpKSldID0gbGluawogICAgICAgICAgICBzZWxmLmFkZEl0ZW0obGluaykKCiAgICAgICAgICAgIGxpbmsubW92ZSgKICAgICAgICAgICAgICAgIHNlbGYub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpLAogICAgICAgICAgICAgICAgc2VsZi5pbmxldEdyYXBoaWNzT2JqZWN0KElubGV0SWQodiwgaSkpLAogICAgICAgICAgICApCgogICAgZGVmIGxpbmtHcmFwaGljc09iamVjdChzZWxmLCBlOiBMaW5rSWQpIC0+ICJMaW5rR3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHNbZV0KCiAgICBkZWYgbm9kZUdyYXBoaWNzT2JqZWN0KHNlbGYsIG46IE5vZGVJZCkgLT4gIk5vZGVHcmFwaGljc09iamVjdCI6CiAgICAgICAgcmV0dXJuIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0c1tuXQoKICAgIGRlZiBpbmxldEdyYXBoaWNzT2JqZWN0KHNlbGYsIGk6IElubGV0SWQpIC0+ICJJbmxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0c1tpXQoKICAgIGRlZiBvdXRsZXRHcmFwaGljc09iamVjdChzZWxmLCBvOiBPdXRsZXRJZCkgLT4gIk91dGxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gc2VsZi5fb3V0bGV0X2dyYXBoaWNzX29iamVjdHNbb10KCiAgICBkZWYgdXBkYXRlQXR0YWNoZWROb2RlcyhzZWxmLCBlOiBMaW5rSWQsIGtpbmQ6IExpdGVyYWxbImluIiwgIm91dCJdKToKICAgICAgICB1LCB2LCBrID0gZQogICAgICAgIG1hdGNoIGtpbmQ6CiAgICAgICAgICAgIGNhc2UgImluIjoKICAgICAgICAgICAgICAgIGlmIG5vZGUgOj0gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzLmdldCh1LCBOb25lKToKICAgICAgICAgICAgICAgICAgICBub2RlLnVwZGF0ZSgpCiAgICAgICAgICAgIGNhc2UgIm91dCI6CiAgICAgICAgICAgICAgICBpZiBub2RlIDo9IHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cy5nZXQodiwgTm9uZSk6CiAgICAgICAgICAgICAgICAgICAgbm9kZS51cGRhdGUoKQoKICAgIGRlZiBpc0xpbmtlZChzZWxmLCBwb3J0OiBJbmxldElkIHwgT3V0bGV0SWQpIC0+IGJvb2w6CiAgICAgICAgbWF0Y2ggcG9ydDoKICAgICAgICAgICAgY2FzZSBJbmxldElkKCk6CiAgICAgICAgICAgICAgICBmb3IgdSwgdiwgKG8sIGkpIGluIHNlbGYuX21vZGVsLmluRWRnZXMocG9ydC5ub2RlSWQpOgogICAgICAgICAgICAgICAgICAgIGlmIGkgPT0gcG9ydC5uYW1lOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICBjYXNlIE91dGxldElkKCk6CiAgICAgICAgICAgICAgICBmb3IgdSwgdiwgKG8sIGkpIGluIHNlbGYuX21vZGVsLm91dEVkZ2VzKHBvcnQubm9kZUlkKToKICAgICAgICAgICAgICAgICAgICBpZiBvID09IHBvcnQubmFtZToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAjIyMgSGFuZGxlIE1vZGVsIFNpZ25hbHMgPj4+CiAgICBkZWYgb25MaW5rRGVsZXRlZChzZWxmLCBlOiBMaW5rSWQpOgogICAgICAgIHNlbGYucmVtb3ZlSXRlbShzZWxmLmxpbmtHcmFwaGljc09iamVjdChlKSkKICAgICAgICBpZiBlIGluIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0czoKICAgICAgICAgICAgZGVsIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0c1tlXQoKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgImluIikKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgIm91dCIpCgogICAgZGVmIG9uTGlua0NyZWF0ZWQoc2VsZiwgZTogTGlua0lkKToKICAgICAgICBsaW5rID0gTGlua0dyYXBoaWNzT2JqZWN0KGUpCiAgICAgICAgc2VsZi5fbGlua19ncmFwaGljc19vYmplY3RzW2VdID0gbGluawogICAgICAgIHNlbGYuYWRkSXRlbShzZWxmLmxpbmtHcmFwaGljc09iamVjdChlKSkKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgImluIikKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgIm91dCIpCgogICAgICAgIHUsIHYsIChvLCBpKSA9IGUKICAgICAgICBsaW5rLm1vdmUoCiAgICAgICAgICAgIHNlbGYub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpLAogICAgICAgICAgICBzZWxmLmlubGV0R3JhcGhpY3NPYmplY3QoSW5sZXRJZCh2LCBpKSksCiAgICAgICAgKQoKICAgIGRlZiBtYWtlRHJhZnRMaW5rKHNlbGYpOgogICAgICAgIHNlbGYuZHJhZnQgPSBMaW5rU2hhcGUoKQogICAgICAgIHNlbGYuZHJhZnQuc2V0QWNjZXB0ZWRNb3VzZUJ1dHRvbnMoUXQuTW91c2VCdXR0b24uTm9CdXR0b24pCiAgICAgICAgc2VsZi5kcmFmdC5zZXRBY2NlcHRIb3ZlckV2ZW50cyhGYWxzZSkKICAgICAgICBzZWxmLmRyYWZ0LnNldEVuYWJsZWQoRmFsc2UpCiAgICAgICAgc2VsZi5kcmFmdC5zZXRBY3RpdmUoRmFsc2UpCiAgICAgICAgc2VsZi5hZGRJdGVtKHNlbGYuZHJhZnQpCgogICAgZGVmIHJlc2V0RHJhZnRMaW5rKHNlbGYpOgogICAgICAgIGFzc2VydCBzZWxmLmRyYWZ0IGlzIG5vdCBOb25lCiAgICAgICAgc2VsZi5yZW1vdmVJdGVtKHNlbGYuZHJhZnQpCiAgICAgICAgc2VsZi5kcmFmdCA9IE5vbmUKCiAgICBkZWYgb25Ob2RlQ3JlYXRlZChzZWxmLCBuOiBOb2RlSWQpOgogICAgICAgIGlubGV0X25hbWVzID0gKAogICAgICAgICAgICBzZWxmLl9tb2RlbC5nZXROb2RlUHJvcGVydHkobiwgImlubGV0cyIpCiAgICAgICAgICAgIGlmIHNlbGYuX21vZGVsLmhhc05vZGVQcm9wZXJ0eShuLCAiaW5sZXRzIikKICAgICAgICAgICAgZWxzZSBbXQogICAgICAgICkKCiAgICAgICAgaW5sZXRzID0gW10KICAgICAgICBpZiBzZWxmLl9tb2RlbC5oYXNOb2RlUHJvcGVydHkobiwgImlubGV0cyIpOgogICAgICAgICAgICBpbmxldE5hbWVzID0gc2VsZi5fbW9kZWwuZ2V0Tm9kZVByb3BlcnR5KG4sICJpbmxldHMiKQogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShpbmxldE5hbWVzLCBsaXN0KSBhbmQgYWxsKAogICAgICAgICAgICAgICAgaXNpbnN0YW5jZShfLCBzdHIpIGZvciBfIGluIGlubGV0TmFtZXMKICAgICAgICAgICAgKQogICAgICAgICAgICBmb3IgaW5sZXROYW1lIGluIGlubGV0TmFtZXM6CiAgICAgICAgICAgICAgICBpbmxldF9ncmFwaGljc19vYmplY3QgPSBJbmxldEdyYXBoaWNzT2JqZWN0KAogICAgICAgICAgICAgICAgICAgIElubGV0SWQobiwgaW5sZXROYW1lKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0c1sKICAgICAgICAgICAgICAgICAgICBJbmxldElkKG4sIGlubGV0TmFtZSkKICAgICAgICAgICAgICAgIF0gPSBpbmxldF9ncmFwaGljc19vYmplY3QKICAgICAgICAgICAgICAgIGlubGV0cy5hcHBlbmQoaW5sZXRfZ3JhcGhpY3Nfb2JqZWN0KQoKICAgICAgICBvdXRsZXRzID0gW10KICAgICAgICBpZiBzZWxmLl9tb2RlbC5oYXNOb2RlUHJvcGVydHkobiwgIm91dGxldHMiKToKICAgICAgICAgICAgb3V0bGV0TmFtZXMgPSBzZWxmLl9tb2RlbC5nZXROb2RlUHJvcGVydHkobiwgIm91dGxldHMiKQogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShvdXRsZXROYW1lcywgbGlzdCkgYW5kIGFsbCgKICAgICAgICAgICAgICAgIGlzaW5zdGFuY2UoXywgc3RyKSBmb3IgXyBpbiBvdXRsZXROYW1lcwogICAgICAgICAgICApCiAgICAgICAgICAgIGZvciBvdXRsZXROYW1lIGluIG91dGxldE5hbWVzOgogICAgICAgICAgICAgICAgb3V0bGV0X2dyYXBoaWNzX29iamVjdCA9IE91dGxldEdyYXBoaWNzT2JqZWN0KAogICAgICAgICAgICAgICAgICAgIE91dGxldElkKG4sIG91dGxldE5hbWUpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0c1sKICAgICAgICAgICAgICAgICAgICBPdXRsZXRJZChuLCBvdXRsZXROYW1lKQogICAgICAgICAgICAgICAgXSA9IG91dGxldF9ncmFwaGljc19vYmplY3QKICAgICAgICAgICAgICAgIG91dGxldHMuYXBwZW5kKG91dGxldF9ncmFwaGljc19vYmplY3QpCgogICAgICAgIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0c1tuXSA9IE5vZGVHcmFwaGljc09iamVjdCgKICAgICAgICAgICAgbiwgaW5sZXRzPWlubGV0cywgb3V0bGV0cz1vdXRsZXRzCiAgICAgICAgKQoKICAgICAgICBzZWxmLmFkZEl0ZW0oc2VsZi5ub2RlR3JhcGhpY3NPYmplY3QobikpCgogICAgZGVmIG9uTm9kZURlbGV0ZWQoc2VsZiwgbjogTm9kZUlkKToKICAgICAgICBpZiBuIGluIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0czoKICAgICAgICAgICAgbm9kZV9ncmFwaGljc19vYmplY3QgPSBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHNbbl0KICAgICAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcigpCgogICAgZGVmIG9uTW9kZWxSZXNldChzZWxmKToKICAgICAgICBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHMuY2xlYXIoKQogICAgICAgIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cy5jbGVhcigpCiAgICAgICAgc2VsZi5jbGVhcigpCgogICAgICAgIHNlbGYudHJhdmVyc2VHcmFwaEFuZFBvcHVsYXRlR3JhcGhpY3NPYmplY3RzKCkKCiAgICAjIyMgPDw8IEhhbmRsZSBNb2RlbCBTaWduYWxzCiAgICBkZWYgX2ZpbmRHcmFwaEl0ZW1BdChzZWxmLCBrbGFzcywgcG9zaXRpb246IFFQb2ludEYpOgogICAgICAgICMgZmluZCBvdXRsZXQgdW5kZXIgbW91c2UKICAgICAgICBmb3IgaXRlbSBpbiBzZWxmLml0ZW1zKHBvc2l0aW9uLCBkZXZpY2VUcmFuc2Zvcm09UVRyYW5zZm9ybSgpKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVtLCBrbGFzcyk6CiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbQoKICAgIGRlZiBvdXRsZXRBdChzZWxmLCBwb3NpdGlvbjogUVBvaW50RikgLT4gIk91dGxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgT3V0bGV0R3JhcGhpY3NPYmplY3QsCiAgICAgICAgICAgIHNlbGYuX2ZpbmRHcmFwaEl0ZW1BdChPdXRsZXRHcmFwaGljc09iamVjdCwgcG9zaXRpb24pLAogICAgICAgICkKCiAgICBkZWYgaW5sZXRBdChzZWxmLCBwb3NpdGlvbjogUVBvaW50RikgLT4gIklubGV0R3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBjYXN0KAogICAgICAgICAgICBJbmxldEdyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoSW5sZXRHcmFwaGljc09iamVjdCwgcG9zaXRpb24pLAogICAgICAgICkKCiAgICBkZWYgbm9kZUF0KHNlbGYsIHBvc2l0aW9uOiBRUG9pbnRGKSAtPiAiTm9kZUdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgTm9kZUdyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoTm9kZUdyYXBoaWNzT2JqZWN0LCBwb3NpdGlvbiksCiAgICAgICAgKQoKICAgIGRlZiBsaW5rQXQoc2VsZiwgcG9zaXRpb246IFFQb2ludEYpIC0+ICJMaW5rR3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBjYXN0KAogICAgICAgICAgICBMaW5rR3JhcGhpY3NPYmplY3QsCiAgICAgICAgICAgIHNlbGYuX2ZpbmRHcmFwaEl0ZW1BdChMaW5rR3JhcGhpY3NPYmplY3QsIHBvc2l0aW9uKSwKICAgICAgICApCgogICAgZGVmIGxheW91dChzZWxmKToKICAgICAgICBkZWYgaGllYXJjaGljYWxfbGF5b3V0X3dpdGhfZ3JhbmRhbGYoRywgc2NhbGU9MSk6CiAgICAgICAgICAgIGltcG9ydCBncmFuZGFsZgogICAgICAgICAgICBmcm9tIGdyYW5kYWxmLmxheW91dHMgaW1wb3J0IFN1Z2l5YW1hTGF5b3V0CgogICAgICAgICAgICBnID0gZ3JhbmRhbGYudXRpbHMuY29udmVydF9uZXh0d29ya3hfZ3JhcGhfdG9fZ3JhbmRhbGYoRykKCiAgICAgICAgICAgIGNsYXNzIGRlZmF1bHR2aWV3KG9iamVjdCk6ICAjIHNlZSBSRUFETUUgb2YgZ3JhbmRhbGYncyBnaXRodWIKICAgICAgICAgICAgICAgIHcsIGggPSBzY2FsZSwgc2NhbGUKCiAgICAgICAgICAgIGZvciB2IGluIGcuQ1swXS5zVjoKICAgICAgICAgICAgICAgIHYudmlldyA9IGRlZmF1bHR2aWV3KCkKICAgICAgICAgICAgc3VnID0gU3VnaXlhbWFMYXlvdXQoZy5DWzBdKQogICAgICAgICAgICBzdWcuaW5pdF9hbGwoKSAgIyByb290cz1bVlswXV0pCiAgICAgICAgICAgIHN1Zy5kcmF3KCkKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHYuZGF0YTogKHYudmlldy54eVswXSwgdi52aWV3Lnh5WzFdKSBmb3IgdiBpbiBnLkNbMF0uc1YKICAgICAgICAgICAgfSAgIyBFeHRyYWN0cyB0aGUgcG9zaXRpb25zCgogICAgICAgIGRlZiBoaWVhcmNoaWNhbF9sYXlvdXRfd2l0aF9ueChHLCBzY2FsZT0xMDApOgogICAgICAgICAgICBmb3IgbGF5ZXIsIG5vZGVzIGluIGVudW1lcmF0ZSgKICAgICAgICAgICAgICAgIHJldmVyc2VkKHR1cGxlKG54LnRvcG9sb2dpY2FsX2dlbmVyYXRpb25zKEcpKSkKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICMgYG11bHRpcGFydGl0ZV9sYXlvdXRgIGV4cGVjdHMgdGhlIGxheWVyIGFzIGEgbm9kZSBhdHRyaWJ1dGUsIHNvIGFkZCB0aGUKICAgICAgICAgICAgICAgICMgbnVtZXJpYyBsYXllciB2YWx1ZSBhcyBhIG5vZGUgYXR0cmlidXRlCiAgICAgICAgICAgICAgICBmb3Igbm9kZSBpbiBub2RlczoKICAgICAgICAgICAgICAgICAgICBHLm5vZGVzW25vZGVdWyJsYXllciJdID0gLWxheWVyCgogICAgICAgICAgICAjIENvbXB1dGUgdGhlIG11bHRpcGFydGl0ZV9sYXlvdXQgdXNpbmcgdGhlICJsYXllciIgbm9kZSBhdHRyaWJ1dGUKICAgICAgICAgICAgcG9zID0gbngubXVsdGlwYXJ0aXRlX2xheW91dCgKICAgICAgICAgICAgICAgIEcsIHN1YnNldF9rZXk9ImxheWVyIiwgYWxpZ249Imhvcml6b250YWwiCiAgICAgICAgICAgICkKICAgICAgICAgICAgZm9yIG4sIHAgaW4gcG9zLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBwb3Nbbl0gPSBwWzBdICogc2NhbGUsIHBbMV0gKiBzY2FsZQogICAgICAgICAgICByZXR1cm4gcG9zCgogICAgICAgIHBvcyA9IGhpZWFyY2hpY2FsX2xheW91dF93aXRoX254KHNlbGYuX21vZGVsLkcsIHNjYWxlPTEwMCkKICAgICAgICBmb3IgTiwgKHgsIHkpIGluIHBvcy5pdGVtcygpOgogICAgICAgICAgICB3aWRnZXQgPSBzZWxmLm5vZGVHcmFwaGljc09iamVjdChOKQogICAgICAgICAgICB3aWRnZXQuc2V0UG9zKHgsIHkpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgQWN0aXZlIEdyYXBoaWNzIE9iamVjdHMgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgpjbGFzcyBPdXRsZXRHcmFwaGljc09iamVjdChQb3J0U2hhcGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG86IE91dGxldElkKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGxhYmVsPWYie28ubmFtZX0iKQogICAgICAgIHNlbGYuX28gPSBvCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIG1vdXNlUHJlc3NFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLm1ha2VEcmFmdExpbmsoKQogICAgICAgIHNlbGYuZ3JhYk1vdXNlKCkKCiAgICBkZWYgbW91c2VNb3ZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBkcmFmdCA9IHNlbGYuZ3JhcGhzY2VuZSgpLmRyYWZ0CiAgICAgICAgYXNzZXJ0IGRyYWZ0IGlzIG5vdCBOb25lCgogICAgICAgIGlmIGlubGV0IDo9IHNlbGYuZ3JhcGhzY2VuZSgpLmlubGV0QXQoZXZlbnQuc2NlbmVQb3MoKSk6CiAgICAgICAgICAgIGRyYWZ0Lm1vdmUoc2VsZiwgaW5sZXQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZHJhZnQubW92ZShzZWxmLCBldmVudC5zY2VuZVBvcygpKQogICAgICAgIHJldHVybiBzdXBlcigpLm1vdXNlTW92ZUV2ZW50KGV2ZW50KQoKICAgIGRlZiBtb3VzZVJlbGVhc2VFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYudW5ncmFiTW91c2UoKQogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLnJlc2V0RHJhZnRMaW5rKCkKCiAgICAgICAgaWYgaW5sZXQgOj0gc2VsZi5ncmFwaHNjZW5lKCkuaW5sZXRBdChldmVudC5zY2VuZVBvcygpKToKICAgICAgICAgICAgc2NlbmUgPSBzZWxmLmdyYXBoc2NlbmUoKQogICAgICAgICAgICBzY2VuZS5fbW9kZWwuYWRkRWRnZSgKICAgICAgICAgICAgICAgIHNlbGYuX28ubm9kZUlkLCBpbmxldC5faS5ub2RlSWQsIChzZWxmLl9vLm5hbWUsIGlubGV0Ll9pLm5hbWUpCiAgICAgICAgICAgICkKCiAgICAgICAgcmV0dXJuIHN1cGVyKCkubW91c2VSZWxlYXNlRXZlbnQoZXZlbnQpCgogICAgZGVmIGJydXNoKHNlbGYpOgogICAgICAgIGJydXNoID0gc3VwZXIoKS5icnVzaCgpCiAgICAgICAgaWYgc2VsZi5ncmFwaHNjZW5lKCkuaXNMaW5rZWQoc2VsZi5fbyk6CiAgICAgICAgICAgIGJydXNoID0gc2VsZi5wYWxldHRlKCkudGV4dCgpCgogICAgICAgIHJldHVybiBicnVzaAoKCmNsYXNzIElubGV0R3JhcGhpY3NPYmplY3QoUG9ydFNoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpOiBJbmxldElkKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGxhYmVsPWYie2kubmFtZX0iKQogICAgICAgIHNlbGYuX2kgPSBpCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIG1vdXNlUHJlc3NFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLm1ha2VEcmFmdExpbmsoKQogICAgICAgIHNlbGYuZ3JhYk1vdXNlKCkKCiAgICBkZWYgbW91c2VNb3ZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBkcmFmdCA9IHNlbGYuZ3JhcGhzY2VuZSgpLmRyYWZ0CiAgICAgICAgYXNzZXJ0IGRyYWZ0IGlzIG5vdCBOb25lCgogICAgICAgIGlmIG91dGxldCA6PSBzZWxmLmdyYXBoc2NlbmUoKS5vdXRsZXRBdChldmVudC5zY2VuZVBvcygpKToKICAgICAgICAgICAgZHJhZnQuc2V0TGluZShtYWtlTGluZUJldHdlZW5TaGFwZXMob3V0bGV0LCBzZWxmKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBkcmFmdC5zZXRMaW5lKG1ha2VMaW5lQmV0d2VlblNoYXBlcyhldmVudC5zY2VuZVBvcygpLCBzZWxmKSkKICAgICAgICByZXR1cm4gc3VwZXIoKS5tb3VzZU1vdmVFdmVudChldmVudCkKCiAgICBkZWYgbW91c2VSZWxlYXNlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBzZWxmLnVuZ3JhYk1vdXNlKCkKICAgICAgICBzZWxmLmdyYXBoc2NlbmUoKS5yZXNldERyYWZ0TGluaygpCgogICAgICAgIGlmIG91dGxldCA6PSBzZWxmLmdyYXBoc2NlbmUoKS5vdXRsZXRBdChldmVudC5zY2VuZVBvcygpKToKICAgICAgICAgICAgc2VsZi5ncmFwaHNjZW5lKCkuX21vZGVsLmFkZEVkZ2UoCiAgICAgICAgICAgICAgICBvdXRsZXQuX28ubm9kZUlkLCBzZWxmLl9pLm5vZGVJZCwgKG91dGxldC5fby5uYW1lLCBzZWxmLl9pLm5hbWUpCiAgICAgICAgICAgICkKCiAgICAgICAgcmV0dXJuIHN1cGVyKCkubW91c2VSZWxlYXNlRXZlbnQoZXZlbnQpCgogICAgZGVmIGJydXNoKHNlbGYpOgogICAgICAgIGJydXNoID0gc3VwZXIoKS5icnVzaCgpCiAgICAgICAgaWYgc2VsZi5ncmFwaHNjZW5lKCkuaXNMaW5rZWQoc2VsZi5faSk6CiAgICAgICAgICAgIGJydXNoID0gc2VsZi5wYWxldHRlKCkudGV4dCgpCgogICAgICAgIHJldHVybiBicnVzaAoKCmNsYXNzIE5vZGVHcmFwaGljc09iamVjdChOb2RlU2hhcGUpOgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgbjogTm9kZUlkLAogICAgICAgIGlubGV0czogbGlzdFtJbmxldEdyYXBoaWNzT2JqZWN0XSwKICAgICAgICBvdXRsZXRzOiBsaXN0W091dGxldEdyYXBoaWNzT2JqZWN0XSwKICAgICAgICBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygKICAgICAgICAgICAgdGl0bGU9ZiIne259JyIsCiAgICAgICAgICAgIGlubGV0cz1pbmxldHMsCiAgICAgICAgICAgIG91dGxldHM9b3V0bGV0cywKICAgICAgICAgICAgcGFyZW50PXBhcmVudCwKICAgICAgICApCiAgICAgICAgc2VsZi5fbiA9IG4KICAgICAgICBzZWxmLnNldEFjY2VwdEhvdmVyRXZlbnRzKEZhbHNlKQoKICAgIGRlZiBpdGVtQ2hhbmdlKAogICAgICAgIHNlbGYsIGNoYW5nZTogUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1DaGFuZ2UsIHZhbHVlOiBBbnkKICAgICkgLT4gQW55OgogICAgICAgIGlmICgKICAgICAgICAgICAgY2hhbmdlCiAgICAgICAgICAgID09IFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtQ2hhbmdlLkl0ZW1TY2VuZVBvc2l0aW9uSGFzQ2hhbmdlZAogICAgICAgICk6CiAgICAgICAgICAgIHNlbGYubW92ZUxpbmtzKCkKICAgICAgICByZXR1cm4gc3VwZXIoKS5pdGVtQ2hhbmdlKGNoYW5nZSwgdmFsdWUpCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIG1vdmVMaW5rcyhzZWxmKToKICAgICAgICAiIiJyZXNwb25zaWJsZSB0byB1cGRhdGUgY29ubmVjdGVkIGxpbmsgcG9zaXRpb24iIiIKICAgICAgICBtb2RlbCA9IHNlbGYuZ3JhcGhzY2VuZSgpLl9tb2RlbAogICAgICAgIGFsbF9lZGdlcyA9IG1vZGVsLmluRWRnZXMoc2VsZi5fbikgKyBtb2RlbC5vdXRFZGdlcyhzZWxmLl9uKQogICAgICAgIGZvciBlIGluIGFsbF9lZGdlczoKICAgICAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UoZVsyXSwgdHVwbGUpIGFuZCBsZW4oZVsyXSkgPT0gMgogICAgICAgICAgICB1LCB2LCAobywgaSkgPSBlCiAgICAgICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpCiAgICAgICAgICAgIG91dGxldCA9IHNlbGYuZ3JhcGhzY2VuZSgpLm91dGxldEdyYXBoaWNzT2JqZWN0KE91dGxldElkKHUsIG8pKQogICAgICAgICAgICBpbmxldCA9IHNlbGYuZ3JhcGhzY2VuZSgpLmlubGV0R3JhcGhpY3NPYmplY3QoSW5sZXRJZCh2LCBpKSkKICAgICAgICAgICAgZWRnZSA9IHNlbGYuZ3JhcGhzY2VuZSgpLmxpbmtHcmFwaGljc09iamVjdChlKQogICAgICAgICAgICBlZGdlLm1vdmUob3V0bGV0LCBpbmxldCkKCgpjbGFzcyBMaW5rR3JhcGhpY3NPYmplY3QoTGlua1NoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBlOiBMaW5rSWQsIHBhcmVudDogUUdyYXBoaWNzSXRlbSB8IE5vbmUgPSBOb25lKToKICAgICAgICB1LCB2LCAobywgaSkgPSBlCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhsYWJlbD1mIntvfS0+e2l9IiwgcGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9lID0gZQogICAgICAgIHNlbGYuc2V0WlZhbHVlKC0xKQoKICAgIGRlZiBncmFwaHNjZW5lKHNlbGYpIC0+ICJOWEdyYXBoU2NlbmUiOgogICAgICAgIHJldHVybiBjYXN0KE5YR3JhcGhTY2VuZSwgc2VsZi5zY2VuZSgpKQoKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIHJldHVybiBzdXBlcigpLmJvdW5kaW5nUmVjdCgpLmFkanVzdGVkKC01MCwgLTUwLCA1MCwgNTApCgoKIyMjIyMjIyMjIyMKIyBFWEFNUExFICMKIyMjIyMjIyMjIyMKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGltcG9ydCBzeXMKCiAgICBhcHAgPSBRQXBwbGljYXRpb24oc3lzLmFyZ3YpCgogICAgIyBzZXR1cCBtYWluIHdpbmRvdwogICAgdmlldyA9IFFHcmFwaGljc1ZpZXcoKQogICAgdmlldy5zZXRXaW5kb3dUaXRsZSgiTlhHcmFwaFNjZW5lIikKICAgIHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LkFudGlhbGlhc2luZywgVHJ1ZSkKICAgIHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlRleHRBbnRpYWxpYXNpbmcsIFRydWUpCiAgICB2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5TbW9vdGhQaXhtYXBUcmFuc2Zvcm0sIFRydWUpCgogICAgIyBjcmVhdGUgZ3JhcGggc2NlbmUKICAgIGdyYXBoID0gTlhHcmFwaE1vZGVsKCkKICAgIGdyYXBoLmFkZE5vZGUoIk4xIiwgb3V0bGV0cz1bIm91dCJdKQogICAgZ3JhcGguYWRkTm9kZSgiTjIiLCBpbmxldHM9WyJpbiJdKQogICAgZ3JhcGguYWRkTm9kZSgiTjMiLCBpbmxldHM9WyJpbiJdLCBvdXRsZXRzPVsib3V0Il0pCiAgICBncmFwaC5hZGRFZGdlKCJOMSIsICJOMiIsICgib3V0IiwgImluIikpCiAgICBncmFwaHNjZW5lID0gTlhHcmFwaFNjZW5lKGdyYXBoKQogICAgZ3JhcGhzY2VuZS5zZXRTY2VuZVJlY3QoUVJlY3RGKC00MDAsIC00MDAsIDgwMCwgODAwKSkKICAgIHZpZXcuc2V0U2NlbmUoZ3JhcGhzY2VuZSkKCiAgICAjIGdyYXBoc2NlbmUuYWRkSXRlbShHcmFwaGljc1ZlcnRleEl0ZW0oIkhXRUxMTyIpKQoKICAgICMgc2hvdyB3aW5kb3cKICAgIHZpZXcuc2hvdygpCiAgICBzeXMuZXhpdChhcHAuZXhlYygpKQo",
					"AQAAAAAAAAABAAAAEiwAAAAAAAASLAAAAAAAAAAAAAAAAPC/"
				],
				[
					1442,
					1,
					"insert",
					{
						"characters": "move"
					},
					"BQAAAPsxAAAAAAAA/DEAAAAAAAAAAAAA/DEAAAAAAAD8MQAAAAAAAB0AAABzZXRMaW5lKG1ha2VMaW5lQmV0d2VlblNoYXBlc/wxAAAAAAAA/TEAAAAAAAAAAAAA/TEAAAAAAAD+MQAAAAAAAAAAAAD+MQAAAAAAAP8xAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGDIAAAAAAAD7MQAAAAAAAAAAAAAAAPC/"
				],
				[
					1446,
					1,
					"insert",
					{
						"characters": "move"
					},
					"BQAAAC8yAAAAAAAAMDIAAAAAAAAAAAAAMDIAAAAAAAAwMgAAAAAAAB0AAABzZXRMaW5lKG1ha2VMaW5lQmV0d2VlblNoYXBlczAyAAAAAAAAMTIAAAAAAAAAAAAAMTIAAAAAAAAyMgAAAAAAAAAAAAAyMgAAAAAAADMyAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATDIAAAAAAAAvMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1451,
					1,
					"left_delete",
					null,
					"AQAAAA0yAAAAAAAADTIAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAADjIAAAAAAAAOMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1454,
					1,
					"right_delete",
					null,
					"AQAAAEoyAAAAAAAASjIAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAASjIAAAAAAABKMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1464,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAZz8AAAAAAABnPwAAIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgVGhlIE5ldHdvcmsgU2NlbmUgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiMKIyBBICdWaWV3JyB0byByZXByZXNlbnQgYSBuZXR3b3JrIG9mIG5vZGVzLCBjb25uZWN0ZWQgYnkgaW5sZXRzIGFuZCBvdXRsZXRzCiMKCiMgSW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoaXMgaXMgYSAnVmlldycuCiMgSXQgaXMgcmVzcG9uc2libGUgdG8gcHJlc2VudCAoYW5kIHBvdGVudGlhbGx5IGVkaXQpIHRoZSBOWEdyYXBoTW9kZWwKIyBHcmFwaFNjZW5lICdpbnRlcm5hbHknIHVzZXMgc3ViY2xhc3NlcyBvZiBHcmFwaFNoYXBlcyB0aGF0IGFyZSBhbHNvICd2aWV3cycuCiMgdGhlc2Ugd2lkZ2V0cyBhcmUgcmVzcG9uc2libGUgdG8gcmVmZXJlbmNlIHRoZSBncmFwaHNjZW5lLAojIGFuZCB0aGUgcmVwcmVzZW50ZWQgbm9kZXMsIGVkZ2UgYW5kIHBvcnRzLgojCiMgVE9ETzogbW92ZSB0aGUgbW9kZWwgZWRpdGluZyBjYXBhYmlsaXRpZXMKIyBmcm9tIHRoZSB3aWRnZXRzIHRvIGEgZGVsZWdhdGUsIG9yIHRoZSBncmFwaHNlbmUgaXRzZWxmCgoKZnJvbSB0eXBpbmcgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0R3VpIGltcG9ydCAqCmZyb20gUHlTaWRlNi5RdENvcmUgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0V2lkZ2V0cyBpbXBvcnQgKgoKCkNvbm5lY3Rpb25FbnRlclR5cGUgPSBRRXZlbnQuVHlwZShRRXZlbnQucmVnaXN0ZXJFdmVudFR5cGUoKSkKQ29ubmVjdGlvbkxlYXZlVHlwZSA9IFFFdmVudC5UeXBlKFFFdmVudC5yZWdpc3RlckV2ZW50VHlwZSgpKQpDb25uZWN0aW9uTW92ZVR5cGUgPSBRRXZlbnQuVHlwZShRRXZlbnQucmVnaXN0ZXJFdmVudFR5cGUoKSkKQ29ubmVjdGlvbkRyb3BUeXBlID0gUUV2ZW50LlR5cGUoUUV2ZW50LnJlZ2lzdGVyRXZlbnRUeXBlKCkpCgppbXBvcnQgbnVtcHkgYXMgbnAKaW1wb3J0IG5ldHdvcmt4IGFzIG54CgoKIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCmZyb20gcHlsaXZlLk5ldHdvcmtYR3JhcGhFZGl0b3IubnhfZ3JhcGhfc2hhcGVzIGltcG9ydCAoCiAgICBOb2RlU2hhcGUsCiAgICBMaW5rU2hhcGUsCiAgICBQb3J0U2hhcGUsCikKCgojIyMjIyMjIyMjIyMjIwojIEdSQVBIU0NFTkUgIwojIyMjIyMjIyMjIyMjIwoKZnJvbSBweWxpdmUuTmV0d29ya1hHcmFwaEVkaXRvci5ueF9ncmFwaF9tb2RlbCBpbXBvcnQgTlhHcmFwaE1vZGVsCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKCnR5cGUgTm9kZUlkID0gSGFzaGFibGUKCgpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBPdXRsZXRJZDoKICAgIG5vZGVJZDogTm9kZUlkCiAgICBuYW1lOiBzdHIKCgpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBJbmxldElkOgogICAgbm9kZUlkOiBOb2RlSWQKICAgIG5hbWU6IHN0cgoKCnR5cGUgTGlua0lkID0gdHVwbGVbTm9kZUlkLCBOb2RlSWQsIHR1cGxlW3N0ciwgc3RyXV0KCgpjbGFzcyBOWEdyYXBoU2NlbmUoUUdyYXBoaWNzU2NlbmUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1vZGVsOiBOWEdyYXBoTW9kZWwpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuX21vZGVsID0gbW9kZWwKICAgICAgICBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHM6IGRpY3RbTm9kZUlkLCBOb2RlR3JhcGhpY3NPYmplY3RdID0gZGljdCgpCiAgICAgICAgc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFsKICAgICAgICAgICAgSW5sZXRJZCwgSW5sZXRHcmFwaGljc09iamVjdAogICAgICAgIF0gPSBkaWN0KCkKICAgICAgICBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFsKICAgICAgICAgICAgT3V0bGV0SWQsIE91dGxldEdyYXBoaWNzT2JqZWN0CiAgICAgICAgXSA9IGRpY3QoKQogICAgICAgIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0czogZGljdFtMaW5rSWQsIExpbmtHcmFwaGljc09iamVjdF0gPSBkaWN0KCkKICAgICAgICBzZWxmLl9kcmFmdF9saW5rOiBMaW5rR3JhcGhpY3NPYmplY3QgfCBOb25lID0gTm9uZQoKICAgICAgICBzZWxmLnNldEl0ZW1JbmRleE1ldGhvZChRR3JhcGhpY3NTY2VuZS5JdGVtSW5kZXhNZXRob2QuTm9JbmRleCkKCiAgICAgICAgc2VsZi5fbW9kZWwubm9kZXNBZGRlZC5jb25uZWN0KAogICAgICAgICAgICBsYW1iZGEgbm9kZXM6IFtzZWxmLm9uTm9kZUNyZWF0ZWQobikgZm9yIG4gaW4gbm9kZXNdCiAgICAgICAgKQogICAgICAgIHNlbGYuX21vZGVsLm5vZGVzQWJvdXRUb0JlUmVtb3ZlZC5jb25uZWN0KAogICAgICAgICAgICBsYW1iZGEgbm9kZXM6IFtzZWxmLm9uTm9kZURlbGV0ZWQobikgZm9yIG4gaW4gbm9kZXNdCiAgICAgICAgKQogICAgICAgIHNlbGYuX21vZGVsLmVkZ2VzQWRkZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIGVkZ2VzOiBbc2VsZi5vbkxpbmtDcmVhdGVkKGUpIGZvciBlIGluIGVkZ2VzXQogICAgICAgICkKICAgICAgICBzZWxmLl9tb2RlbC5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuY29ubmVjdCgKICAgICAgICAgICAgbGFtYmRhIGVkZ2VzOiBbc2VsZi5vbkxpbmtEZWxldGVkKGUpIGZvciBlIGluIGVkZ2VzXQogICAgICAgICkKCiAgICAgICAgc2VsZi50cmF2ZXJzZUdyYXBoQW5kUG9wdWxhdGVHcmFwaGljc09iamVjdHMoKQogICAgICAgIHNlbGYuZHJhZnQ6IExpbmtTaGFwZSB8IE5vbmUgPSBOb25lICAjIHRvZG8gdXNlIHRoZSB3aWRnZXQgaXRzZWxmCiAgICAgICAgc2VsZi5sYXlvdXQoKQoKICAgIGRlZiB0cmF2ZXJzZUdyYXBoQW5kUG9wdWxhdGVHcmFwaGljc09iamVjdHMoc2VsZik6CiAgICAgICAgYWxsTm9kZUlkczogbGlzdFtOb2RlSWRdID0gc2VsZi5fbW9kZWwubm9kZXMoKQoKICAgICAgICAjIEZpcnN0IGNyZWF0ZSBhbGwgdGhlIG5vZGVzLgogICAgICAgIGZvciBub2RlSWQgaW4gYWxsTm9kZUlkczoKICAgICAgICAgICAgc2VsZi5vbk5vZGVDcmVhdGVkKG5vZGVJZCkKCiAgICAgICAgZm9yIGUgaW4gc2VsZi5fbW9kZWwuZWRnZXMoKToKICAgICAgICAgICAgdSwgdiwgKG8sIGkpID0gZQogICAgICAgICAgICBhc3NlcnQgdSBpbiBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHMKICAgICAgICAgICAgYXNzZXJ0IHYgaW4gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzCiAgICAgICAgICAgIGFzc2VydCAoCiAgICAgICAgICAgICAgICBPdXRsZXRJZCh1LCBvKSBpbiBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0cwogICAgICAgICAgICApLCBmIk5vZGUgJ3t1fScgaGFzIG5vIG91dGxldCAne299JyEiCiAgICAgICAgICAgIGFzc2VydCAoCiAgICAgICAgICAgICAgICBJbmxldElkKHYsIGkpIGluIHNlbGYuX2lubGV0X2dyYXBoaWNzX29iamVjdHMKICAgICAgICAgICAgKSwgZiJOb2RlICd7dn0nIGhhcyBubyBpbmxldCAne2l9JyEiCgogICAgICAgICAgICBsaW5rID0gTGlua0dyYXBoaWNzT2JqZWN0KCh1LCB2LCAobywgaSkpKQogICAgICAgICAgICBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHNbKHUsIHYsIChvLCBpKSldID0gbGluawogICAgICAgICAgICBzZWxmLmFkZEl0ZW0obGluaykKCiAgICAgICAgICAgIGxpbmsubW92ZSgKICAgICAgICAgICAgICAgIHNlbGYub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpLAogICAgICAgICAgICAgICAgc2VsZi5pbmxldEdyYXBoaWNzT2JqZWN0KElubGV0SWQodiwgaSkpLAogICAgICAgICAgICApCgogICAgZGVmIGxpbmtHcmFwaGljc09iamVjdChzZWxmLCBlOiBMaW5rSWQpIC0+ICJMaW5rR3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHNbZV0KCiAgICBkZWYgbm9kZUdyYXBoaWNzT2JqZWN0KHNlbGYsIG46IE5vZGVJZCkgLT4gIk5vZGVHcmFwaGljc09iamVjdCI6CiAgICAgICAgcmV0dXJuIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0c1tuXQoKICAgIGRlZiBpbmxldEdyYXBoaWNzT2JqZWN0KHNlbGYsIGk6IElubGV0SWQpIC0+ICJJbmxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0c1tpXQoKICAgIGRlZiBvdXRsZXRHcmFwaGljc09iamVjdChzZWxmLCBvOiBPdXRsZXRJZCkgLT4gIk91dGxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gc2VsZi5fb3V0bGV0X2dyYXBoaWNzX29iamVjdHNbb10KCiAgICBkZWYgdXBkYXRlQXR0YWNoZWROb2RlcyhzZWxmLCBlOiBMaW5rSWQsIGtpbmQ6IExpdGVyYWxbImluIiwgIm91dCJdKToKICAgICAgICB1LCB2LCBrID0gZQogICAgICAgIG1hdGNoIGtpbmQ6CiAgICAgICAgICAgIGNhc2UgImluIjoKICAgICAgICAgICAgICAgIGlmIG5vZGUgOj0gc2VsZi5fbm9kZV9ncmFwaGljc19vYmplY3RzLmdldCh1LCBOb25lKToKICAgICAgICAgICAgICAgICAgICBub2RlLnVwZGF0ZSgpCiAgICAgICAgICAgIGNhc2UgIm91dCI6CiAgICAgICAgICAgICAgICBpZiBub2RlIDo9IHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cy5nZXQodiwgTm9uZSk6CiAgICAgICAgICAgICAgICAgICAgbm9kZS51cGRhdGUoKQoKICAgIGRlZiBpc0xpbmtlZChzZWxmLCBwb3J0OiBJbmxldElkIHwgT3V0bGV0SWQpIC0+IGJvb2w6CiAgICAgICAgbWF0Y2ggcG9ydDoKICAgICAgICAgICAgY2FzZSBJbmxldElkKCk6CiAgICAgICAgICAgICAgICBmb3IgdSwgdiwgKG8sIGkpIGluIHNlbGYuX21vZGVsLmluRWRnZXMocG9ydC5ub2RlSWQpOgogICAgICAgICAgICAgICAgICAgIGlmIGkgPT0gcG9ydC5uYW1lOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICBjYXNlIE91dGxldElkKCk6CiAgICAgICAgICAgICAgICBmb3IgdSwgdiwgKG8sIGkpIGluIHNlbGYuX21vZGVsLm91dEVkZ2VzKHBvcnQubm9kZUlkKToKICAgICAgICAgICAgICAgICAgICBpZiBvID09IHBvcnQubmFtZToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAjIyMgSGFuZGxlIE1vZGVsIFNpZ25hbHMgPj4+CiAgICBkZWYgb25MaW5rRGVsZXRlZChzZWxmLCBlOiBMaW5rSWQpOgogICAgICAgIHNlbGYucmVtb3ZlSXRlbShzZWxmLmxpbmtHcmFwaGljc09iamVjdChlKSkKICAgICAgICBpZiBlIGluIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0czoKICAgICAgICAgICAgZGVsIHNlbGYuX2xpbmtfZ3JhcGhpY3Nfb2JqZWN0c1tlXQoKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgImluIikKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgIm91dCIpCgogICAgZGVmIG9uTGlua0NyZWF0ZWQoc2VsZiwgZTogTGlua0lkKToKICAgICAgICBsaW5rID0gTGlua0dyYXBoaWNzT2JqZWN0KGUpCiAgICAgICAgc2VsZi5fbGlua19ncmFwaGljc19vYmplY3RzW2VdID0gbGluawogICAgICAgIHNlbGYuYWRkSXRlbShzZWxmLmxpbmtHcmFwaGljc09iamVjdChlKSkKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgImluIikKICAgICAgICBzZWxmLnVwZGF0ZUF0dGFjaGVkTm9kZXMoZSwgIm91dCIpCgogICAgICAgIHUsIHYsIChvLCBpKSA9IGUKICAgICAgICBsaW5rLm1vdmUoCiAgICAgICAgICAgIHNlbGYub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpLAogICAgICAgICAgICBzZWxmLmlubGV0R3JhcGhpY3NPYmplY3QoSW5sZXRJZCh2LCBpKSksCiAgICAgICAgKQoKICAgIGRlZiBtYWtlRHJhZnRMaW5rKHNlbGYpOgogICAgICAgIHNlbGYuZHJhZnQgPSBMaW5rU2hhcGUoKQogICAgICAgIHNlbGYuZHJhZnQuc2V0QWNjZXB0ZWRNb3VzZUJ1dHRvbnMoUXQuTW91c2VCdXR0b24uTm9CdXR0b24pCiAgICAgICAgc2VsZi5kcmFmdC5zZXRBY2NlcHRIb3ZlckV2ZW50cyhGYWxzZSkKICAgICAgICBzZWxmLmRyYWZ0LnNldEVuYWJsZWQoRmFsc2UpCiAgICAgICAgc2VsZi5kcmFmdC5zZXRBY3RpdmUoRmFsc2UpCiAgICAgICAgc2VsZi5hZGRJdGVtKHNlbGYuZHJhZnQpCgogICAgZGVmIHJlc2V0RHJhZnRMaW5rKHNlbGYpOgogICAgICAgIGFzc2VydCBzZWxmLmRyYWZ0IGlzIG5vdCBOb25lCiAgICAgICAgc2VsZi5yZW1vdmVJdGVtKHNlbGYuZHJhZnQpCiAgICAgICAgc2VsZi5kcmFmdCA9IE5vbmUKCiAgICBkZWYgb25Ob2RlQ3JlYXRlZChzZWxmLCBuOiBOb2RlSWQpOgogICAgICAgIGlubGV0X25hbWVzID0gKAogICAgICAgICAgICBzZWxmLl9tb2RlbC5nZXROb2RlUHJvcGVydHkobiwgImlubGV0cyIpCiAgICAgICAgICAgIGlmIHNlbGYuX21vZGVsLmhhc05vZGVQcm9wZXJ0eShuLCAiaW5sZXRzIikKICAgICAgICAgICAgZWxzZSBbXQogICAgICAgICkKCiAgICAgICAgaW5sZXRzID0gW10KICAgICAgICBpZiBzZWxmLl9tb2RlbC5oYXNOb2RlUHJvcGVydHkobiwgImlubGV0cyIpOgogICAgICAgICAgICBpbmxldE5hbWVzID0gc2VsZi5fbW9kZWwuZ2V0Tm9kZVByb3BlcnR5KG4sICJpbmxldHMiKQogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShpbmxldE5hbWVzLCBsaXN0KSBhbmQgYWxsKAogICAgICAgICAgICAgICAgaXNpbnN0YW5jZShfLCBzdHIpIGZvciBfIGluIGlubGV0TmFtZXMKICAgICAgICAgICAgKQogICAgICAgICAgICBmb3IgaW5sZXROYW1lIGluIGlubGV0TmFtZXM6CiAgICAgICAgICAgICAgICBpbmxldF9ncmFwaGljc19vYmplY3QgPSBJbmxldEdyYXBoaWNzT2JqZWN0KAogICAgICAgICAgICAgICAgICAgIElubGV0SWQobiwgaW5sZXROYW1lKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgc2VsZi5faW5sZXRfZ3JhcGhpY3Nfb2JqZWN0c1sKICAgICAgICAgICAgICAgICAgICBJbmxldElkKG4sIGlubGV0TmFtZSkKICAgICAgICAgICAgICAgIF0gPSBpbmxldF9ncmFwaGljc19vYmplY3QKICAgICAgICAgICAgICAgIGlubGV0cy5hcHBlbmQoaW5sZXRfZ3JhcGhpY3Nfb2JqZWN0KQoKICAgICAgICBvdXRsZXRzID0gW10KICAgICAgICBpZiBzZWxmLl9tb2RlbC5oYXNOb2RlUHJvcGVydHkobiwgIm91dGxldHMiKToKICAgICAgICAgICAgb3V0bGV0TmFtZXMgPSBzZWxmLl9tb2RlbC5nZXROb2RlUHJvcGVydHkobiwgIm91dGxldHMiKQogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShvdXRsZXROYW1lcywgbGlzdCkgYW5kIGFsbCgKICAgICAgICAgICAgICAgIGlzaW5zdGFuY2UoXywgc3RyKSBmb3IgXyBpbiBvdXRsZXROYW1lcwogICAgICAgICAgICApCiAgICAgICAgICAgIGZvciBvdXRsZXROYW1lIGluIG91dGxldE5hbWVzOgogICAgICAgICAgICAgICAgb3V0bGV0X2dyYXBoaWNzX29iamVjdCA9IE91dGxldEdyYXBoaWNzT2JqZWN0KAogICAgICAgICAgICAgICAgICAgIE91dGxldElkKG4sIG91dGxldE5hbWUpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBzZWxmLl9vdXRsZXRfZ3JhcGhpY3Nfb2JqZWN0c1sKICAgICAgICAgICAgICAgICAgICBPdXRsZXRJZChuLCBvdXRsZXROYW1lKQogICAgICAgICAgICAgICAgXSA9IG91dGxldF9ncmFwaGljc19vYmplY3QKICAgICAgICAgICAgICAgIG91dGxldHMuYXBwZW5kKG91dGxldF9ncmFwaGljc19vYmplY3QpCgogICAgICAgIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0c1tuXSA9IE5vZGVHcmFwaGljc09iamVjdCgKICAgICAgICAgICAgbiwgaW5sZXRzPWlubGV0cywgb3V0bGV0cz1vdXRsZXRzCiAgICAgICAgKQoKICAgICAgICBzZWxmLmFkZEl0ZW0oc2VsZi5ub2RlR3JhcGhpY3NPYmplY3QobikpCgogICAgZGVmIG9uTm9kZURlbGV0ZWQoc2VsZiwgbjogTm9kZUlkKToKICAgICAgICBpZiBuIGluIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0czoKICAgICAgICAgICAgbm9kZV9ncmFwaGljc19vYmplY3QgPSBzZWxmLl9ub2RlX2dyYXBoaWNzX29iamVjdHNbbl0KICAgICAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcigpCgogICAgZGVmIG9uTW9kZWxSZXNldChzZWxmKToKICAgICAgICBzZWxmLl9saW5rX2dyYXBoaWNzX29iamVjdHMuY2xlYXIoKQogICAgICAgIHNlbGYuX25vZGVfZ3JhcGhpY3Nfb2JqZWN0cy5jbGVhcigpCiAgICAgICAgc2VsZi5jbGVhcigpCgogICAgICAgIHNlbGYudHJhdmVyc2VHcmFwaEFuZFBvcHVsYXRlR3JhcGhpY3NPYmplY3RzKCkKCiAgICAjIyMgPDw8IEhhbmRsZSBNb2RlbCBTaWduYWxzCiAgICBkZWYgX2ZpbmRHcmFwaEl0ZW1BdChzZWxmLCBrbGFzcywgcG9zaXRpb246IFFQb2ludEYpOgogICAgICAgICMgZmluZCBvdXRsZXQgdW5kZXIgbW91c2UKICAgICAgICBmb3IgaXRlbSBpbiBzZWxmLml0ZW1zKHBvc2l0aW9uLCBkZXZpY2VUcmFuc2Zvcm09UVRyYW5zZm9ybSgpKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVtLCBrbGFzcyk6CiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbQoKICAgIGRlZiBvdXRsZXRBdChzZWxmLCBwb3NpdGlvbjogUVBvaW50RikgLT4gIk91dGxldEdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgT3V0bGV0R3JhcGhpY3NPYmplY3QsCiAgICAgICAgICAgIHNlbGYuX2ZpbmRHcmFwaEl0ZW1BdChPdXRsZXRHcmFwaGljc09iamVjdCwgcG9zaXRpb24pLAogICAgICAgICkKCiAgICBkZWYgaW5sZXRBdChzZWxmLCBwb3NpdGlvbjogUVBvaW50RikgLT4gIklubGV0R3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBjYXN0KAogICAgICAgICAgICBJbmxldEdyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoSW5sZXRHcmFwaGljc09iamVjdCwgcG9zaXRpb24pLAogICAgICAgICkKCiAgICBkZWYgbm9kZUF0KHNlbGYsIHBvc2l0aW9uOiBRUG9pbnRGKSAtPiAiTm9kZUdyYXBoaWNzT2JqZWN0IjoKICAgICAgICByZXR1cm4gY2FzdCgKICAgICAgICAgICAgTm9kZUdyYXBoaWNzT2JqZWN0LAogICAgICAgICAgICBzZWxmLl9maW5kR3JhcGhJdGVtQXQoTm9kZUdyYXBoaWNzT2JqZWN0LCBwb3NpdGlvbiksCiAgICAgICAgKQoKICAgIGRlZiBsaW5rQXQoc2VsZiwgcG9zaXRpb246IFFQb2ludEYpIC0+ICJMaW5rR3JhcGhpY3NPYmplY3QiOgogICAgICAgIHJldHVybiBjYXN0KAogICAgICAgICAgICBMaW5rR3JhcGhpY3NPYmplY3QsCiAgICAgICAgICAgIHNlbGYuX2ZpbmRHcmFwaEl0ZW1BdChMaW5rR3JhcGhpY3NPYmplY3QsIHBvc2l0aW9uKSwKICAgICAgICApCgogICAgZGVmIGxheW91dChzZWxmKToKICAgICAgICBkZWYgaGllYXJjaGljYWxfbGF5b3V0X3dpdGhfZ3JhbmRhbGYoRywgc2NhbGU9MSk6CiAgICAgICAgICAgIGltcG9ydCBncmFuZGFsZgogICAgICAgICAgICBmcm9tIGdyYW5kYWxmLmxheW91dHMgaW1wb3J0IFN1Z2l5YW1hTGF5b3V0CgogICAgICAgICAgICBnID0gZ3JhbmRhbGYudXRpbHMuY29udmVydF9uZXh0d29ya3hfZ3JhcGhfdG9fZ3JhbmRhbGYoRykKCiAgICAgICAgICAgIGNsYXNzIGRlZmF1bHR2aWV3KG9iamVjdCk6ICAjIHNlZSBSRUFETUUgb2YgZ3JhbmRhbGYncyBnaXRodWIKICAgICAgICAgICAgICAgIHcsIGggPSBzY2FsZSwgc2NhbGUKCiAgICAgICAgICAgIGZvciB2IGluIGcuQ1swXS5zVjoKICAgICAgICAgICAgICAgIHYudmlldyA9IGRlZmF1bHR2aWV3KCkKICAgICAgICAgICAgc3VnID0gU3VnaXlhbWFMYXlvdXQoZy5DWzBdKQogICAgICAgICAgICBzdWcuaW5pdF9hbGwoKSAgIyByb290cz1bVlswXV0pCiAgICAgICAgICAgIHN1Zy5kcmF3KCkKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHYuZGF0YTogKHYudmlldy54eVswXSwgdi52aWV3Lnh5WzFdKSBmb3IgdiBpbiBnLkNbMF0uc1YKICAgICAgICAgICAgfSAgIyBFeHRyYWN0cyB0aGUgcG9zaXRpb25zCgogICAgICAgIGRlZiBoaWVhcmNoaWNhbF9sYXlvdXRfd2l0aF9ueChHLCBzY2FsZT0xMDApOgogICAgICAgICAgICBmb3IgbGF5ZXIsIG5vZGVzIGluIGVudW1lcmF0ZSgKICAgICAgICAgICAgICAgIHJldmVyc2VkKHR1cGxlKG54LnRvcG9sb2dpY2FsX2dlbmVyYXRpb25zKEcpKSkKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICMgYG11bHRpcGFydGl0ZV9sYXlvdXRgIGV4cGVjdHMgdGhlIGxheWVyIGFzIGEgbm9kZSBhdHRyaWJ1dGUsIHNvIGFkZCB0aGUKICAgICAgICAgICAgICAgICMgbnVtZXJpYyBsYXllciB2YWx1ZSBhcyBhIG5vZGUgYXR0cmlidXRlCiAgICAgICAgICAgICAgICBmb3Igbm9kZSBpbiBub2RlczoKICAgICAgICAgICAgICAgICAgICBHLm5vZGVzW25vZGVdWyJsYXllciJdID0gLWxheWVyCgogICAgICAgICAgICAjIENvbXB1dGUgdGhlIG11bHRpcGFydGl0ZV9sYXlvdXQgdXNpbmcgdGhlICJsYXllciIgbm9kZSBhdHRyaWJ1dGUKICAgICAgICAgICAgcG9zID0gbngubXVsdGlwYXJ0aXRlX2xheW91dCgKICAgICAgICAgICAgICAgIEcsIHN1YnNldF9rZXk9ImxheWVyIiwgYWxpZ249Imhvcml6b250YWwiCiAgICAgICAgICAgICkKICAgICAgICAgICAgZm9yIG4sIHAgaW4gcG9zLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBwb3Nbbl0gPSBwWzBdICogc2NhbGUsIHBbMV0gKiBzY2FsZQogICAgICAgICAgICByZXR1cm4gcG9zCgogICAgICAgIHBvcyA9IGhpZWFyY2hpY2FsX2xheW91dF93aXRoX254KHNlbGYuX21vZGVsLkcsIHNjYWxlPTEwMCkKICAgICAgICBmb3IgTiwgKHgsIHkpIGluIHBvcy5pdGVtcygpOgogICAgICAgICAgICB3aWRnZXQgPSBzZWxmLm5vZGVHcmFwaGljc09iamVjdChOKQogICAgICAgICAgICB3aWRnZXQuc2V0UG9zKHgsIHkpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgQWN0aXZlIEdyYXBoaWNzIE9iamVjdHMgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgpjbGFzcyBPdXRsZXRHcmFwaGljc09iamVjdChQb3J0U2hhcGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG86IE91dGxldElkKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGxhYmVsPWYie28ubmFtZX0iKQogICAgICAgIHNlbGYuX28gPSBvCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIG1vdXNlUHJlc3NFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLm1ha2VEcmFmdExpbmsoKQogICAgICAgIHNlbGYuZ3JhYk1vdXNlKCkKCiAgICBkZWYgbW91c2VNb3ZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBkcmFmdCA9IHNlbGYuZ3JhcGhzY2VuZSgpLmRyYWZ0CiAgICAgICAgYXNzZXJ0IGRyYWZ0IGlzIG5vdCBOb25lCgogICAgICAgIGlmIGlubGV0IDo9IHNlbGYuZ3JhcGhzY2VuZSgpLmlubGV0QXQoZXZlbnQuc2NlbmVQb3MoKSk6CiAgICAgICAgICAgIGRyYWZ0Lm1vdmUoc2VsZiwgaW5sZXQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZHJhZnQubW92ZShzZWxmLCBldmVudC5zY2VuZVBvcygpKQogICAgICAgIHJldHVybiBzdXBlcigpLm1vdXNlTW92ZUV2ZW50KGV2ZW50KQoKICAgIGRlZiBtb3VzZVJlbGVhc2VFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYudW5ncmFiTW91c2UoKQogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLnJlc2V0RHJhZnRMaW5rKCkKCiAgICAgICAgaWYgaW5sZXQgOj0gc2VsZi5ncmFwaHNjZW5lKCkuaW5sZXRBdChldmVudC5zY2VuZVBvcygpKToKICAgICAgICAgICAgc2NlbmUgPSBzZWxmLmdyYXBoc2NlbmUoKQogICAgICAgICAgICBzY2VuZS5fbW9kZWwuYWRkRWRnZSgKICAgICAgICAgICAgICAgIHNlbGYuX28ubm9kZUlkLCBpbmxldC5faS5ub2RlSWQsIChzZWxmLl9vLm5hbWUsIGlubGV0Ll9pLm5hbWUpCiAgICAgICAgICAgICkKCiAgICAgICAgcmV0dXJuIHN1cGVyKCkubW91c2VSZWxlYXNlRXZlbnQoZXZlbnQpCgogICAgZGVmIGJydXNoKHNlbGYpOgogICAgICAgIGJydXNoID0gc3VwZXIoKS5icnVzaCgpCiAgICAgICAgaWYgc2VsZi5ncmFwaHNjZW5lKCkuaXNMaW5rZWQoc2VsZi5fbyk6CiAgICAgICAgICAgIGJydXNoID0gc2VsZi5wYWxldHRlKCkudGV4dCgpCgogICAgICAgIHJldHVybiBicnVzaAoKCmNsYXNzIElubGV0R3JhcGhpY3NPYmplY3QoUG9ydFNoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpOiBJbmxldElkKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGxhYmVsPWYie2kubmFtZX0iKQogICAgICAgIHNlbGYuX2kgPSBpCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIG1vdXNlUHJlc3NFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLm1ha2VEcmFmdExpbmsoKQogICAgICAgIHNlbGYuZ3JhYk1vdXNlKCkKCiAgICBkZWYgbW91c2VNb3ZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lTW91c2VFdmVudCkgLT4gTm9uZToKICAgICAgICBkcmFmdCA9IHNlbGYuZ3JhcGhzY2VuZSgpLmRyYWZ0CiAgICAgICAgYXNzZXJ0IGRyYWZ0IGlzIG5vdCBOb25lCgogICAgICAgIGlmIG91dGxldCA6PSBzZWxmLmdyYXBoc2NlbmUoKS5vdXRsZXRBdChldmVudC5zY2VuZVBvcygpKToKICAgICAgICAgICAgZHJhZnQubW92ZShvdXRsZXQsIHNlbGYpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZHJhZnQubW92ZShldmVudC5zY2VuZVBvcygpLCBzZWxmKQogICAgICAgIHJldHVybiBzdXBlcigpLm1vdXNlTW92ZUV2ZW50KGV2ZW50KQoKICAgIGRlZiBtb3VzZVJlbGVhc2VFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVNb3VzZUV2ZW50KSAtPiBOb25lOgogICAgICAgIHNlbGYudW5ncmFiTW91c2UoKQogICAgICAgIHNlbGYuZ3JhcGhzY2VuZSgpLnJlc2V0RHJhZnRMaW5rKCkKCiAgICAgICAgaWYgb3V0bGV0IDo9IHNlbGYuZ3JhcGhzY2VuZSgpLm91dGxldEF0KGV2ZW50LnNjZW5lUG9zKCkpOgogICAgICAgICAgICBzZWxmLmdyYXBoc2NlbmUoKS5fbW9kZWwuYWRkRWRnZSgKICAgICAgICAgICAgICAgIG91dGxldC5fby5ub2RlSWQsIHNlbGYuX2kubm9kZUlkLCAob3V0bGV0Ll9vLm5hbWUsIHNlbGYuX2kubmFtZSkKICAgICAgICAgICAgKQoKICAgICAgICByZXR1cm4gc3VwZXIoKS5tb3VzZVJlbGVhc2VFdmVudChldmVudCkKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYnJ1c2ggPSBzdXBlcigpLmJydXNoKCkKICAgICAgICBpZiBzZWxmLmdyYXBoc2NlbmUoKS5pc0xpbmtlZChzZWxmLl9pKToKICAgICAgICAgICAgYnJ1c2ggPSBzZWxmLnBhbGV0dGUoKS50ZXh0KCkKCiAgICAgICAgcmV0dXJuIGJydXNoCgoKY2xhc3MgTm9kZUdyYXBoaWNzT2JqZWN0KE5vZGVTaGFwZSk6CiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBuOiBOb2RlSWQsCiAgICAgICAgaW5sZXRzOiBsaXN0W0lubGV0R3JhcGhpY3NPYmplY3RdLAogICAgICAgIG91dGxldHM6IGxpc3RbT3V0bGV0R3JhcGhpY3NPYmplY3RdLAogICAgICAgIHBhcmVudDogUUdyYXBoaWNzSXRlbSB8IE5vbmUgPSBOb25lLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKAogICAgICAgICAgICB0aXRsZT1mIid7bn0nIiwKICAgICAgICAgICAgaW5sZXRzPWlubGV0cywKICAgICAgICAgICAgb3V0bGV0cz1vdXRsZXRzLAogICAgICAgICAgICBwYXJlbnQ9cGFyZW50LAogICAgICAgICkKICAgICAgICBzZWxmLl9uID0gbgogICAgICAgIHNlbGYuc2V0QWNjZXB0SG92ZXJFdmVudHMoRmFsc2UpCgogICAgZGVmIGl0ZW1DaGFuZ2UoCiAgICAgICAgc2VsZiwgY2hhbmdlOiBRR3JhcGhpY3NJdGVtLkdyYXBoaWNzSXRlbUNoYW5nZSwgdmFsdWU6IEFueQogICAgKSAtPiBBbnk6CiAgICAgICAgaWYgKAogICAgICAgICAgICBjaGFuZ2UKICAgICAgICAgICAgPT0gUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1DaGFuZ2UuSXRlbVNjZW5lUG9zaXRpb25IYXNDaGFuZ2VkCiAgICAgICAgKToKICAgICAgICAgICAgc2VsZi5tb3ZlTGlua3MoKQogICAgICAgIHJldHVybiBzdXBlcigpLml0ZW1DaGFuZ2UoY2hhbmdlLCB2YWx1ZSkKCiAgICBkZWYgZ3JhcGhzY2VuZShzZWxmKSAtPiAiTlhHcmFwaFNjZW5lIjoKICAgICAgICByZXR1cm4gY2FzdChOWEdyYXBoU2NlbmUsIHNlbGYuc2NlbmUoKSkKCiAgICBkZWYgbW92ZUxpbmtzKHNlbGYpOgogICAgICAgICIiInJlc3BvbnNpYmxlIHRvIHVwZGF0ZSBjb25uZWN0ZWQgbGluayBwb3NpdGlvbiIiIgogICAgICAgIG1vZGVsID0gc2VsZi5ncmFwaHNjZW5lKCkuX21vZGVsCiAgICAgICAgYWxsX2VkZ2VzID0gbW9kZWwuaW5FZGdlcyhzZWxmLl9uKSArIG1vZGVsLm91dEVkZ2VzKHNlbGYuX24pCiAgICAgICAgZm9yIGUgaW4gYWxsX2VkZ2VzOgogICAgICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShlWzJdLCB0dXBsZSkgYW5kIGxlbihlWzJdKSA9PSAyCiAgICAgICAgICAgIHUsIHYsIChvLCBpKSA9IGUKICAgICAgICAgICAgc2VsZi5ncmFwaHNjZW5lKCkKICAgICAgICAgICAgb3V0bGV0ID0gc2VsZi5ncmFwaHNjZW5lKCkub3V0bGV0R3JhcGhpY3NPYmplY3QoT3V0bGV0SWQodSwgbykpCiAgICAgICAgICAgIGlubGV0ID0gc2VsZi5ncmFwaHNjZW5lKCkuaW5sZXRHcmFwaGljc09iamVjdChJbmxldElkKHYsIGkpKQogICAgICAgICAgICBlZGdlID0gc2VsZi5ncmFwaHNjZW5lKCkubGlua0dyYXBoaWNzT2JqZWN0KGUpCiAgICAgICAgICAgIGVkZ2UubW92ZShvdXRsZXQsIGlubGV0KQoKCmNsYXNzIExpbmtHcmFwaGljc09iamVjdChMaW5rU2hhcGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGU6IExpbmtJZCwgcGFyZW50OiBRR3JhcGhpY3NJdGVtIHwgTm9uZSA9IE5vbmUpOgogICAgICAgIHUsIHYsIChvLCBpKSA9IGUKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGxhYmVsPWYie299LT57aX0iLCBwYXJlbnQ9cGFyZW50KQogICAgICAgIHNlbGYuX2UgPSBlCiAgICAgICAgc2VsZi5zZXRaVmFsdWUoLTEpCgogICAgZGVmIGdyYXBoc2NlbmUoc2VsZikgLT4gIk5YR3JhcGhTY2VuZSI6CiAgICAgICAgcmV0dXJuIGNhc3QoTlhHcmFwaFNjZW5lLCBzZWxmLnNjZW5lKCkpCgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgcmV0dXJuIHN1cGVyKCkuYm91bmRpbmdSZWN0KCkuYWRqdXN0ZWQoLTUwLCAtNTAsIDUwLCA1MCkKCgojIyMjIyMjIyMjIwojIEVYQU1QTEUgIwojIyMjIyMjIyMjIwppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaW1wb3J0IHN5cwoKICAgIGFwcCA9IFFBcHBsaWNhdGlvbihzeXMuYXJndikKCiAgICAjIHNldHVwIG1haW4gd2luZG93CiAgICB2aWV3ID0gUUdyYXBoaWNzVmlldygpCiAgICB2aWV3LnNldFdpbmRvd1RpdGxlKCJOWEdyYXBoU2NlbmUiKQogICAgdmlldy5zZXRSZW5kZXJIaW50KFFQYWludGVyLlJlbmRlckhpbnQuQW50aWFsaWFzaW5nLCBUcnVlKQogICAgdmlldy5zZXRSZW5kZXJIaW50KFFQYWludGVyLlJlbmRlckhpbnQuVGV4dEFudGlhbGlhc2luZywgVHJ1ZSkKICAgIHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlNtb290aFBpeG1hcFRyYW5zZm9ybSwgVHJ1ZSkKCiAgICAjIGNyZWF0ZSBncmFwaCBzY2VuZQogICAgZ3JhcGggPSBOWEdyYXBoTW9kZWwoKQogICAgZ3JhcGguYWRkTm9kZSgiTjEiLCBvdXRsZXRzPVsib3V0Il0pCiAgICBncmFwaC5hZGROb2RlKCJOMiIsIGlubGV0cz1bImluIl0pCiAgICBncmFwaC5hZGROb2RlKCJOMyIsIGlubGV0cz1bImluIl0sIG91dGxldHM9WyJvdXQiXSkKICAgIGdyYXBoLmFkZEVkZ2UoIk4xIiwgIk4yIiwgKCJvdXQiLCAiaW4iKSkKICAgIGdyYXBoc2NlbmUgPSBOWEdyYXBoU2NlbmUoZ3JhcGgpCiAgICBncmFwaHNjZW5lLnNldFNjZW5lUmVjdChRUmVjdEYoLTQwMCwgLTQwMCwgODAwLCA4MDApKQogICAgdmlldy5zZXRTY2VuZShncmFwaHNjZW5lKQoKICAgICMgZ3JhcGhzY2VuZS5hZGRJdGVtKEdyYXBoaWNzVmVydGV4SXRlbSgiSFdFTExPIikpCgogICAgIyBzaG93IHdpbmRvdwogICAgdmlldy5zaG93KCkKICAgIHN5cy5leGl0KGFwcC5leGVjKCkpCg",
					"AQAAAAAAAAABAAAAAjMAAAAAAAAFMwAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "pylive/NetworkXGraphEditor/nx_graph_model.py",
			"settings":
			{
				"buffer_size": 4437,
				"encoding": "UTF-8",
				"line_ending": "Windows"
			},
			"undo_stack":
			[
				[
					12,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAAFALAAAAAAAAUQsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAUAsAAAAAAABQCwAAAAAAAAAAAAAAAPC/"
				],
				[
					13,
					1,
					"insert",
					{
						"characters": " n"
					},
					"AgAAAFELAAAAAAAAUgsAAAAAAAAAAAAAUgsAAAAAAABTCwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAUQsAAAAAAABRCwAAAAAAAAAAAAAAAPC/"
				],
				[
					14,
					1,
					"insert",
					{
						"characters": ":Hash"
					},
					"BQAAAFMLAAAAAAAAVAsAAAAAAAAAAAAAVAsAAAAAAABVCwAAAAAAAAAAAABVCwAAAAAAAFYLAAAAAAAAAAAAAFYLAAAAAAAAVwsAAAAAAAAAAAAAVwsAAAAAAABYCwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAUwsAAAAAAABTCwAAAAAAAAAAAAAAAPC/"
				],
				[
					15,
					1,
					"insert_completion",
					{
						"completion": "lsp_select_completion {\"index\":0,\"session_name\":\"LSP-pyright\"}",
						"format": "command",
						"keep_prefix": false,
						"must_insert": false,
						"trigger": "Hashable"
					},
					"AgAAAFQLAAAAAAAAVAsAAAAAAAAEAAAASGFzaFQLAAAAAAAAXAsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWAsAAAAAAABYCwAAAAAAAAAAAAAAAPC/"
				],
				[
					16,
					1,
					"insert",
					{
						"characters": "|None"
					},
					"BQAAAFwLAAAAAAAAXQsAAAAAAAAAAAAAXQsAAAAAAABeCwAAAAAAAAAAAABeCwAAAAAAAF8LAAAAAAAAAAAAAF8LAAAAAAAAYAsAAAAAAAAAAAAAYAsAAAAAAABhCwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAXAsAAAAAAABcCwAAAAAAAAAAAAAAAPC/"
				],
				[
					28,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAMYLAAAAAAAAyAsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAxgsAAAAAAADGCwAAAAAAAAAAAAAAAPC/"
				],
				[
					31,
					1,
					"insert",
					{
						"characters": "n"
					},
					"AQAAAMcLAAAAAAAAyAsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAxwsAAAAAAADHCwAAAAAAAAAAAAAAAPC/"
				],
				[
					33,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAehEAAAAAAABhEQAAZnJvbSB0eXBpbmcgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0R3VpIGltcG9ydCAqCmZyb20gUHlTaWRlNi5RdENvcmUgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0V2lkZ2V0cyBpbXBvcnQgKgoKaW1wb3J0IG5ldHdvcmt4IGFzIG54Cgpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IGludGVyc2VjdF9yYXlfd2l0aF9yZWN0YW5nbGUKCgpjbGFzcyBOWEdyYXBoTW9kZWwoUU9iamVjdCk6CiAgICBub2Rlc0FkZGVkOiBTaWduYWwgPSBTaWduYWwobGlzdCkgICMgTGlzdFtIYXNoYWJsZV0KICAgIG5vZGVzQWJvdXRUb0JlUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKGxpc3QpICAjIExpc3RbSGFzaGFibGVdCiAgICBub2Rlc1Byb3BlcnRpZXNDaGFuZ2VkOiBTaWduYWwgPSBTaWduYWwoCiAgICAgICAgZGljdAogICAgKSAgIyBkaWN0W0hhc2hhYmxlLCBkaWN0W3N0ciwgQW55XV0KICAgIG5vZGVzUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKGxpc3QpCgogICAgZWRnZXNBZGRlZDogU2lnbmFsID0gU2lnbmFsKAogICAgICAgIGxpc3QKICAgICkgICMgTGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV0KICAgIGVkZ2VzQWJvdXRUb0JlUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKAogICAgICAgIGxpc3QKICAgICkgICMgTGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV0KICAgIGVkZ2VzUHJvcGVydGllc0NoYW5nZWQ6IFNpZ25hbCA9IFNpZ25hbCgKICAgICAgICBkaWN0CiAgICApICAjIGRpY3RbVHVwbGVbSGFzaGFibGUsIEhhc2hhYmxlLCBIYXNoYWJsZV0sIGRpY3Rbc3RyLCBBbnldXQogICAgZWRnZXNSZW1vdmVkOiBTaWduYWwgPSBTaWduYWwoCiAgICAgICAgbGlzdAogICAgKSAgIyBMaXN0W1R1cGxlW0hhc2hhYmxlLCBIYXNoYWJsZSwgSGFzaGFibGVdXQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBHOiBueC5NdWx0aURpR3JhcGggPSBueC5NdWx0aURpR3JhcGgoKSwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLkcgPSBHCgogICAgICAgIGZvciBuIGluIHNlbGYuRy5ub2RlczoKICAgICAgICAgICAgbm9kZSA9IHNlbGYuYWRkTm9kZShuYW1lPW4pCgogICAgICAgIGZvciBlIGluIHNlbGYuRy5lZGdlczoKICAgICAgICAgICAgdSwgdiwgayA9IGUKCiAgICAgICAgICAgIHNlbGYuYWRkRWRnZSh1LCB2LCBrKQoKICAgIGRlZiBwYXRjaChzZWxmLCBHOiBueC5NdWx0aURpR3JhcGgpOgogICAgICAgIC4uLgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoIk5vdCB5ZXQgaW1wbGVtZW50ZWQiKQoKICAgIGRlZiBfX2RlbF9fKHNlbGYpOgogICAgICAgIGRlbCBzZWxmLkcKICAgICAgICAjIHNlbGYubm9kZXNBZGRlZC5kaXNjb25uZWN0KCkKICAgICAgICAjIHNlbGYubm9kZXNBYm91dFRvQmVSZW1vdmVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5ub2Rlc1Byb3BlcnR5Q2hhbmdlZC5kaXNjb25uZWN0KCkKICAgICAgICAjIHNlbGYubm9kZXNSZW1vdmVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc0FkZGVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuZGlzY29ubmVjdCgpCiAgICAgICAgIyBzZWxmLmVkZ2VzUHJvcGVydHlDaGFuZ2VkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc1JlbW92ZWQuZGlzY29ubmVjdCgpCgogICAgZGVmIG5vZGVzKHNlbGYpIC0+IExpc3RbSGFzaGFibGVdOgogICAgICAgIHJldHVybiBbbiBmb3IgbiBpbiBzZWxmLkcubm9kZXNdCgogICAgZGVmIGFkZE5vZGUoc2VsZiwgbjogSGFzaGFibGUsIC8sICoqcHJvcHMpIC0+IE5vbmU6CiAgICAgICAgIyBwcmludCgiYWRkIG5vZGU6ICd7bn0nIikKICAgICAgICBzZWxmLkcuYWRkX25vZGUobiwgKipwcm9wcykKICAgICAgICBzZWxmLm5vZGVzQWRkZWQuZW1pdChbbl0pCiAgICAgICAgc2VsZi5ub2Rlc1Byb3BlcnRpZXNDaGFuZ2VkLmVtaXQoe246IHByb3BzfSkKCiAgICBkZWYgc2V0Tm9kZVByb3BlcnRpZXMoc2VsZiwgbjogSGFzaGFibGUsIC8sICoqcHJvcHMpOgogICAgICAgICMgY2hhbmdlIGd1YXJkIFRPRE86IGZpbmQgcmVtb3ZlZCBwcm9wcwogICAgICAgIGNoYW5nZSA9IHt9CiAgICAgICAgZm9yIHByb3AsIHZhbHVlIGluIHByb3BzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIHByb3Agbm90IGluIHNlbGYuRy5ub2Rlc1tuXSBvciB2YWx1ZSAhPSBzZWxmLkcubm9kZXNbbl1bcHJvcF06CiAgICAgICAgICAgICAgICBjaGFuZ2VbcHJvcF0gPSB2YWx1ZQogICAgICAgIG54LnNldF9ub2RlX2F0dHJpYnV0ZXMoc2VsZi5HLCB7bjogY2hhbmdlfSkKICAgICAgICBzZWxmLm5vZGVzUHJvcGVydGllc0NoYW5nZWQuZW1pdCh7bjogY2hhbmdlfSkKCiAgICBkZWYgaGFzTm9kZVByb3BlcnR5KHNlbGYsIG46SGFzaGFibGUsIG5hbWUsIC8pLT5ib29sOgogICAgICAgIHJldHVybiBuYW1lIGluIHNlbGYuRy5ub2Rlc1tuXQoKICAgIGRlZiBnZXROb2RlUHJvcGVydHkoc2VsZiwgbjogSGFzaGFibGUsIG5hbWUsIC8pIC0+IG9iamVjdDoKICAgICAgICByZXR1cm4gc2VsZi5HLm5vZGVzW25dW25hbWVdCgogICAgZGVmIGdldE5vZGVQcm9wZXJ0aWVzKHNlbGYsIG46IEhhc2hhYmxlKSAtPiBsaXN0W3N0cl06CiAgICAgICAgcmV0dXJuIFtrZXkgZm9yIGtleSBpbiBzZWxmLkcubm9kZXNbbl0ua2V5cygpXQoKICAgIGRlZiByZW1vdmVOb2RlKHNlbGYsIG46IEhhc2hhYmxlKToKICAgICAgICBzZWxmLm5vZGVzQWJvdXRUb0JlUmVtb3ZlZC5lbWl0KFtuXSkKICAgICAgICBzZWxmLkcucmVtb3ZlX25vZGUobikKICAgICAgICBzZWxmLm5vZGVzUmVtb3ZlZC5lbWl0KFtuXSkKCiAgICBkZWYgZWRnZXMoc2VsZiwgbjpIYXNoYWJsZXxOb25lKSAtPiBsaXN0W1R1cGxlW0hhc2hhYmxlLCBIYXNoYWJsZSwgSGFzaGFibGVdXToKICAgICAgICByZXR1cm4gWyh1LCB2LCBrKSBmb3IgdSwgdiwgayBpbiBzZWxmLkcuZWRnZXMobildCgogICAgZGVmIGluRWRnZXMoc2VsZiwgbjogSGFzaGFibGUpIC0+IGxpc3RbdHVwbGVbSGFzaGFibGUsIEhhc2hhYmxlLCBIYXNoYWJsZV1dOgogICAgICAgICIiInJldHJ1biBpbmNvbWluZyBlZGdlcyB0byB0aGUgbm9kZSIiIgogICAgICAgIHJldHVybiBbKHUsIHYsIGspIGZvciB1LCB2LCBrIGluIHNlbGYuRy5pbl9lZGdlcyhuLCBrZXlzPVRydWUpXQoKICAgIGRlZiBvdXRFZGdlcygKICAgICAgICBzZWxmLCBuOiBIYXNoYWJsZQogICAgKSAtPiBsaXN0W3R1cGxlW0hhc2hhYmxlLCBIYXNoYWJsZSwgSGFzaGFibGVdXToKICAgICAgICAiIiJyZXRydW4gaW5jb21pbmcgZWRnZXMgdG8gdGhlIG5vZGUiIiIKICAgICAgICByZXR1cm4gWyh1LCB2LCBrKSBmb3IgdSwgdiwgayBpbiBzZWxmLkcub3V0X2VkZ2VzKG4sIGtleXM9VHJ1ZSldCgogICAgZGVmIGFkZEVkZ2UoCiAgICAgICAgc2VsZiwgdTogSGFzaGFibGUsIHY6IEhhc2hhYmxlLCBrOiBIYXNoYWJsZSB8IE5vbmUgPSBOb25lLCAvLCAqKnByb3BzCiAgICApIC0+IE5vbmU6CiAgICAgICAgaWYgdSBub3QgaW4gc2VsZi5HLm5vZGVzOgogICAgICAgICAgICBzZWxmLmFkZE5vZGUodSkKICAgICAgICBpZiB2IG5vdCBpbiBzZWxmLkcubm9kZXM6CiAgICAgICAgICAgIHNlbGYuYWRkTm9kZSh2KQoKICAgICAgICBzZWxmLkcuYWRkX2VkZ2UodSwgdiwgaywgKipwcm9wcykKICAgICAgICBzZWxmLmVkZ2VzQWRkZWQuZW1pdChbKHUsIHYsIGspXSkKCiAgICBkZWYgcmVtb3ZlRWRnZShzZWxmLCB1OiBIYXNoYWJsZSwgdjogSGFzaGFibGUsIGs6IEhhc2hhYmxlKToKICAgICAgICBzZWxmLmVkZ2VzQWJvdXRUb0JlUmVtb3ZlZC5lbWl0KFsodSwgdiwgayldKQogICAgICAgIHNlbGYuRy5yZW1vdmVfZWRnZSh1LCB2LCBrKQogICAgICAgIHNlbGYuZWRnZXNSZW1vdmVkLmVtaXQoWyh1LCB2LCBrKV0pCgogICAgZGVmIHNldEVkZ2VQcm9wZXJ0aWVzKAogICAgICAgIHNlbGYsIHU6IEhhc2hhYmxlLCB2OiBIYXNoYWJsZSwgazogSGFzaGFibGUsIC8sICoqcHJvcHMKICAgICk6CiAgICAgICAgbnguc2V0X2VkZ2VfYXR0cmlidXRlcyhzZWxmLkcsIHsodSwgdiwgayk6IHByb3BzfSkKICAgICAgICBzZWxmLmVkZ2VzUHJvcGVydGllc0NoYW5nZWQuZW1pdChbKHUsIHYsIGspXSwgbGlzdChwcm9wcy5rZXlzKCkpKQoKICAgIGRlZiBnZXRFZGdlUHJvcGVydHkoc2VsZiwgdTogSGFzaGFibGUsIHY6IEhhc2hhYmxlLCBrOiBIYXNoYWJsZSwgcHJvcCwgLyk6CiAgICAgICAgcmV0dXJuIHNlbGYuRy5lZGdlc1t1LCB2LCBrXVtwcm9wXQoKICAgIGRlZiBpc0VkZ2VBbGxvd2VkKHNlbGYsIHU6SGFzaGFibGUsIHY6SGFzaGFibGUsIGs6SGFzaGFibGUpLT5ib29sOgogICAgICAgIGlmIHUgPT0gdjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgcmV0dXJuIFRydWUK",
					"AQAAAAAAAAABAAAAyAsAAAAAAADICwAAAAAAAAAAAAAAAPC/"
				],
				[
					63,
					1,
					"insert",
					{
						"characters": "=None"
					},
					"BQAAAHALAAAAAAAAcQsAAAAAAAAAAAAAcQsAAAAAAAByCwAAAAAAAAAAAAByCwAAAAAAAHMLAAAAAAAAAAAAAHMLAAAAAAAAdAsAAAAAAAAAAAAAdAsAAAAAAAB1CwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcAsAAAAAAABwCwAAAAAAAAAAAAAAwG1A"
				],
				[
					65,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAgREAAAAAAAB/EQAAZnJvbSB0eXBpbmcgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0R3VpIGltcG9ydCAqCmZyb20gUHlTaWRlNi5RdENvcmUgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0V2lkZ2V0cyBpbXBvcnQgKgoKaW1wb3J0IG5ldHdvcmt4IGFzIG54Cgpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IGludGVyc2VjdF9yYXlfd2l0aF9yZWN0YW5nbGUKCgpjbGFzcyBOWEdyYXBoTW9kZWwoUU9iamVjdCk6CiAgICBub2Rlc0FkZGVkOiBTaWduYWwgPSBTaWduYWwobGlzdCkgICMgTGlzdFtIYXNoYWJsZV0KICAgIG5vZGVzQWJvdXRUb0JlUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKGxpc3QpICAjIExpc3RbSGFzaGFibGVdCiAgICBub2Rlc1Byb3BlcnRpZXNDaGFuZ2VkOiBTaWduYWwgPSBTaWduYWwoCiAgICAgICAgZGljdAogICAgKSAgIyBkaWN0W0hhc2hhYmxlLCBkaWN0W3N0ciwgQW55XV0KICAgIG5vZGVzUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKGxpc3QpCgogICAgZWRnZXNBZGRlZDogU2lnbmFsID0gU2lnbmFsKAogICAgICAgIGxpc3QKICAgICkgICMgTGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV0KICAgIGVkZ2VzQWJvdXRUb0JlUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKAogICAgICAgIGxpc3QKICAgICkgICMgTGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV0KICAgIGVkZ2VzUHJvcGVydGllc0NoYW5nZWQ6IFNpZ25hbCA9IFNpZ25hbCgKICAgICAgICBkaWN0CiAgICApICAjIGRpY3RbVHVwbGVbSGFzaGFibGUsIEhhc2hhYmxlLCBIYXNoYWJsZV0sIGRpY3Rbc3RyLCBBbnldXQogICAgZWRnZXNSZW1vdmVkOiBTaWduYWwgPSBTaWduYWwoCiAgICAgICAgbGlzdAogICAgKSAgIyBMaXN0W1R1cGxlW0hhc2hhYmxlLCBIYXNoYWJsZSwgSGFzaGFibGVdXQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBHOiBueC5NdWx0aURpR3JhcGggPSBueC5NdWx0aURpR3JhcGgoKSwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLkcgPSBHCgogICAgICAgIGZvciBuIGluIHNlbGYuRy5ub2RlczoKICAgICAgICAgICAgbm9kZSA9IHNlbGYuYWRkTm9kZShuYW1lPW4pCgogICAgICAgIGZvciBlIGluIHNlbGYuRy5lZGdlczoKICAgICAgICAgICAgdSwgdiwgayA9IGUKCiAgICAgICAgICAgIHNlbGYuYWRkRWRnZSh1LCB2LCBrKQoKICAgIGRlZiBwYXRjaChzZWxmLCBHOiBueC5NdWx0aURpR3JhcGgpOgogICAgICAgIC4uLgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoIk5vdCB5ZXQgaW1wbGVtZW50ZWQiKQoKICAgIGRlZiBfX2RlbF9fKHNlbGYpOgogICAgICAgIGRlbCBzZWxmLkcKICAgICAgICAjIHNlbGYubm9kZXNBZGRlZC5kaXNjb25uZWN0KCkKICAgICAgICAjIHNlbGYubm9kZXNBYm91dFRvQmVSZW1vdmVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5ub2Rlc1Byb3BlcnR5Q2hhbmdlZC5kaXNjb25uZWN0KCkKICAgICAgICAjIHNlbGYubm9kZXNSZW1vdmVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc0FkZGVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuZGlzY29ubmVjdCgpCiAgICAgICAgIyBzZWxmLmVkZ2VzUHJvcGVydHlDaGFuZ2VkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc1JlbW92ZWQuZGlzY29ubmVjdCgpCgogICAgZGVmIG5vZGVzKHNlbGYpIC0+IExpc3RbSGFzaGFibGVdOgogICAgICAgIHJldHVybiBbbiBmb3IgbiBpbiBzZWxmLkcubm9kZXNdCgogICAgZGVmIGFkZE5vZGUoc2VsZiwgbjogSGFzaGFibGUsIC8sICoqcHJvcHMpIC0+IE5vbmU6CiAgICAgICAgIyBwcmludCgiYWRkIG5vZGU6ICd7bn0nIikKICAgICAgICBzZWxmLkcuYWRkX25vZGUobiwgKipwcm9wcykKICAgICAgICBzZWxmLm5vZGVzQWRkZWQuZW1pdChbbl0pCiAgICAgICAgc2VsZi5ub2Rlc1Byb3BlcnRpZXNDaGFuZ2VkLmVtaXQoe246IHByb3BzfSkKCiAgICBkZWYgc2V0Tm9kZVByb3BlcnRpZXMoc2VsZiwgbjogSGFzaGFibGUsIC8sICoqcHJvcHMpOgogICAgICAgICMgY2hhbmdlIGd1YXJkIFRPRE86IGZpbmQgcmVtb3ZlZCBwcm9wcwogICAgICAgIGNoYW5nZSA9IHt9CiAgICAgICAgZm9yIHByb3AsIHZhbHVlIGluIHByb3BzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIHByb3Agbm90IGluIHNlbGYuRy5ub2Rlc1tuXSBvciB2YWx1ZSAhPSBzZWxmLkcubm9kZXNbbl1bcHJvcF06CiAgICAgICAgICAgICAgICBjaGFuZ2VbcHJvcF0gPSB2YWx1ZQogICAgICAgIG54LnNldF9ub2RlX2F0dHJpYnV0ZXMoc2VsZi5HLCB7bjogY2hhbmdlfSkKICAgICAgICBzZWxmLm5vZGVzUHJvcGVydGllc0NoYW5nZWQuZW1pdCh7bjogY2hhbmdlfSkKCiAgICBkZWYgaGFzTm9kZVByb3BlcnR5KHNlbGYsIG46IEhhc2hhYmxlLCBuYW1lLCAvKSAtPiBib29sOgogICAgICAgIHJldHVybiBuYW1lIGluIHNlbGYuRy5ub2Rlc1tuXQoKICAgIGRlZiBnZXROb2RlUHJvcGVydHkoc2VsZiwgbjogSGFzaGFibGUsIG5hbWUsIC8pIC0+IG9iamVjdDoKICAgICAgICByZXR1cm4gc2VsZi5HLm5vZGVzW25dW25hbWVdCgogICAgZGVmIGdldE5vZGVQcm9wZXJ0aWVzKHNlbGYsIG46IEhhc2hhYmxlKSAtPiBsaXN0W3N0cl06CiAgICAgICAgcmV0dXJuIFtrZXkgZm9yIGtleSBpbiBzZWxmLkcubm9kZXNbbl0ua2V5cygpXQoKICAgIGRlZiByZW1vdmVOb2RlKHNlbGYsIG46IEhhc2hhYmxlKToKICAgICAgICBzZWxmLm5vZGVzQWJvdXRUb0JlUmVtb3ZlZC5lbWl0KFtuXSkKICAgICAgICBzZWxmLkcucmVtb3ZlX25vZGUobikKICAgICAgICBzZWxmLm5vZGVzUmVtb3ZlZC5lbWl0KFtuXSkKCiAgICBkZWYgZWRnZXMoCiAgICAgICAgc2VsZiwgbjogSGFzaGFibGUgfCBOb25lPU5vbmUKICAgICkgLT4gbGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV06CiAgICAgICAgcmV0dXJuIFsodSwgdiwgaykgZm9yIHUsIHYsIGsgaW4gc2VsZi5HLmVkZ2VzKG4pXQoKICAgIGRlZiBpbkVkZ2VzKHNlbGYsIG46IEhhc2hhYmxlKSAtPiBsaXN0W3R1cGxlW0hhc2hhYmxlLCBIYXNoYWJsZSwgSGFzaGFibGVdXToKICAgICAgICAiIiJyZXRydW4gaW5jb21pbmcgZWRnZXMgdG8gdGhlIG5vZGUiIiIKICAgICAgICByZXR1cm4gWyh1LCB2LCBrKSBmb3IgdSwgdiwgayBpbiBzZWxmLkcuaW5fZWRnZXMobiwga2V5cz1UcnVlKV0KCiAgICBkZWYgb3V0RWRnZXMoCiAgICAgICAgc2VsZiwgbjogSGFzaGFibGUKICAgICkgLT4gbGlzdFt0dXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV06CiAgICAgICAgIiIicmV0cnVuIGluY29taW5nIGVkZ2VzIHRvIHRoZSBub2RlIiIiCiAgICAgICAgcmV0dXJuIFsodSwgdiwgaykgZm9yIHUsIHYsIGsgaW4gc2VsZi5HLm91dF9lZGdlcyhuLCBrZXlzPVRydWUpXQoKICAgIGRlZiBhZGRFZGdlKAogICAgICAgIHNlbGYsIHU6IEhhc2hhYmxlLCB2OiBIYXNoYWJsZSwgazogSGFzaGFibGUgfCBOb25lID0gTm9uZSwgLywgKipwcm9wcwogICAgKSAtPiBOb25lOgogICAgICAgIGlmIHUgbm90IGluIHNlbGYuRy5ub2RlczoKICAgICAgICAgICAgc2VsZi5hZGROb2RlKHUpCiAgICAgICAgaWYgdiBub3QgaW4gc2VsZi5HLm5vZGVzOgogICAgICAgICAgICBzZWxmLmFkZE5vZGUodikKCiAgICAgICAgc2VsZi5HLmFkZF9lZGdlKHUsIHYsIGssICoqcHJvcHMpCiAgICAgICAgc2VsZi5lZGdlc0FkZGVkLmVtaXQoWyh1LCB2LCBrKV0pCgogICAgZGVmIHJlbW92ZUVkZ2Uoc2VsZiwgdTogSGFzaGFibGUsIHY6IEhhc2hhYmxlLCBrOiBIYXNoYWJsZSk6CiAgICAgICAgc2VsZi5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuZW1pdChbKHUsIHYsIGspXSkKICAgICAgICBzZWxmLkcucmVtb3ZlX2VkZ2UodSwgdiwgaykKICAgICAgICBzZWxmLmVkZ2VzUmVtb3ZlZC5lbWl0KFsodSwgdiwgayldKQoKICAgIGRlZiBzZXRFZGdlUHJvcGVydGllcygKICAgICAgICBzZWxmLCB1OiBIYXNoYWJsZSwgdjogSGFzaGFibGUsIGs6IEhhc2hhYmxlLCAvLCAqKnByb3BzCiAgICApOgogICAgICAgIG54LnNldF9lZGdlX2F0dHJpYnV0ZXMoc2VsZi5HLCB7KHUsIHYsIGspOiBwcm9wc30pCiAgICAgICAgc2VsZi5lZGdlc1Byb3BlcnRpZXNDaGFuZ2VkLmVtaXQoWyh1LCB2LCBrKV0sIGxpc3QocHJvcHMua2V5cygpKSkKCiAgICBkZWYgZ2V0RWRnZVByb3BlcnR5KHNlbGYsIHU6IEhhc2hhYmxlLCB2OiBIYXNoYWJsZSwgazogSGFzaGFibGUsIHByb3AsIC8pOgogICAgICAgIHJldHVybiBzZWxmLkcuZWRnZXNbdSwgdiwga11bcHJvcF0KCiAgICBkZWYgaXNFZGdlQWxsb3dlZChzZWxmLCB1OiBIYXNoYWJsZSwgdjogSGFzaGFibGUsIGs6IEhhc2hhYmxlKSAtPiBib29sOgogICAgICAgIGlmIHUgPT0gdjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgcmV0dXJuIFRydWUK",
					"AQAAAAAAAAABAAAAdQsAAAAAAAB1CwAAAAAAAAAAAAAAAPC/"
				],
				[
					70,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAAOMLAAAAAAAA5AsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4wsAAAAAAADjCwAAAAAAAAAAAAAAAPC/"
				],
				[
					71,
					1,
					"insert",
					{
						"characters": " keys=T"
					},
					"BwAAAOQLAAAAAAAA5QsAAAAAAAAAAAAA5QsAAAAAAADmCwAAAAAAAAAAAADmCwAAAAAAAOcLAAAAAAAAAAAAAOcLAAAAAAAA6AsAAAAAAAAAAAAA6AsAAAAAAADpCwAAAAAAAAAAAADpCwAAAAAAAOoLAAAAAAAAAAAAAOoLAAAAAAAA6wsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA5AsAAAAAAADkCwAAAAAAAAAAAAAAAPC/"
				],
				[
					72,
					1,
					"insert",
					{
						"characters": "rue"
					},
					"AwAAAOsLAAAAAAAA7AsAAAAAAAAAAAAA7AsAAAAAAADtCwAAAAAAAAAAAADtCwAAAAAAAO4LAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA6wsAAAAAAADrCwAAAAAAAAAAAAAAAPC/"
				],
				[
					74,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAjBEAAAAAAACMEQAAZnJvbSB0eXBpbmcgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0R3VpIGltcG9ydCAqCmZyb20gUHlTaWRlNi5RdENvcmUgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0V2lkZ2V0cyBpbXBvcnQgKgoKaW1wb3J0IG5ldHdvcmt4IGFzIG54Cgpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IGludGVyc2VjdF9yYXlfd2l0aF9yZWN0YW5nbGUKCgpjbGFzcyBOWEdyYXBoTW9kZWwoUU9iamVjdCk6CiAgICBub2Rlc0FkZGVkOiBTaWduYWwgPSBTaWduYWwobGlzdCkgICMgTGlzdFtIYXNoYWJsZV0KICAgIG5vZGVzQWJvdXRUb0JlUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKGxpc3QpICAjIExpc3RbSGFzaGFibGVdCiAgICBub2Rlc1Byb3BlcnRpZXNDaGFuZ2VkOiBTaWduYWwgPSBTaWduYWwoCiAgICAgICAgZGljdAogICAgKSAgIyBkaWN0W0hhc2hhYmxlLCBkaWN0W3N0ciwgQW55XV0KICAgIG5vZGVzUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKGxpc3QpCgogICAgZWRnZXNBZGRlZDogU2lnbmFsID0gU2lnbmFsKAogICAgICAgIGxpc3QKICAgICkgICMgTGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV0KICAgIGVkZ2VzQWJvdXRUb0JlUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKAogICAgICAgIGxpc3QKICAgICkgICMgTGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV0KICAgIGVkZ2VzUHJvcGVydGllc0NoYW5nZWQ6IFNpZ25hbCA9IFNpZ25hbCgKICAgICAgICBkaWN0CiAgICApICAjIGRpY3RbVHVwbGVbSGFzaGFibGUsIEhhc2hhYmxlLCBIYXNoYWJsZV0sIGRpY3Rbc3RyLCBBbnldXQogICAgZWRnZXNSZW1vdmVkOiBTaWduYWwgPSBTaWduYWwoCiAgICAgICAgbGlzdAogICAgKSAgIyBMaXN0W1R1cGxlW0hhc2hhYmxlLCBIYXNoYWJsZSwgSGFzaGFibGVdXQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBHOiBueC5NdWx0aURpR3JhcGggPSBueC5NdWx0aURpR3JhcGgoKSwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLkcgPSBHCgogICAgICAgIGZvciBuIGluIHNlbGYuRy5ub2RlczoKICAgICAgICAgICAgbm9kZSA9IHNlbGYuYWRkTm9kZShuYW1lPW4pCgogICAgICAgIGZvciBlIGluIHNlbGYuRy5lZGdlczoKICAgICAgICAgICAgdSwgdiwgayA9IGUKCiAgICAgICAgICAgIHNlbGYuYWRkRWRnZSh1LCB2LCBrKQoKICAgIGRlZiBwYXRjaChzZWxmLCBHOiBueC5NdWx0aURpR3JhcGgpOgogICAgICAgIC4uLgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoIk5vdCB5ZXQgaW1wbGVtZW50ZWQiKQoKICAgIGRlZiBfX2RlbF9fKHNlbGYpOgogICAgICAgIGRlbCBzZWxmLkcKICAgICAgICAjIHNlbGYubm9kZXNBZGRlZC5kaXNjb25uZWN0KCkKICAgICAgICAjIHNlbGYubm9kZXNBYm91dFRvQmVSZW1vdmVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5ub2Rlc1Byb3BlcnR5Q2hhbmdlZC5kaXNjb25uZWN0KCkKICAgICAgICAjIHNlbGYubm9kZXNSZW1vdmVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc0FkZGVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuZGlzY29ubmVjdCgpCiAgICAgICAgIyBzZWxmLmVkZ2VzUHJvcGVydHlDaGFuZ2VkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc1JlbW92ZWQuZGlzY29ubmVjdCgpCgogICAgZGVmIG5vZGVzKHNlbGYpIC0+IExpc3RbSGFzaGFibGVdOgogICAgICAgIHJldHVybiBbbiBmb3IgbiBpbiBzZWxmLkcubm9kZXNdCgogICAgZGVmIGFkZE5vZGUoc2VsZiwgbjogSGFzaGFibGUsIC8sICoqcHJvcHMpIC0+IE5vbmU6CiAgICAgICAgIyBwcmludCgiYWRkIG5vZGU6ICd7bn0nIikKICAgICAgICBzZWxmLkcuYWRkX25vZGUobiwgKipwcm9wcykKICAgICAgICBzZWxmLm5vZGVzQWRkZWQuZW1pdChbbl0pCiAgICAgICAgc2VsZi5ub2Rlc1Byb3BlcnRpZXNDaGFuZ2VkLmVtaXQoe246IHByb3BzfSkKCiAgICBkZWYgc2V0Tm9kZVByb3BlcnRpZXMoc2VsZiwgbjogSGFzaGFibGUsIC8sICoqcHJvcHMpOgogICAgICAgICMgY2hhbmdlIGd1YXJkIFRPRE86IGZpbmQgcmVtb3ZlZCBwcm9wcwogICAgICAgIGNoYW5nZSA9IHt9CiAgICAgICAgZm9yIHByb3AsIHZhbHVlIGluIHByb3BzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIHByb3Agbm90IGluIHNlbGYuRy5ub2Rlc1tuXSBvciB2YWx1ZSAhPSBzZWxmLkcubm9kZXNbbl1bcHJvcF06CiAgICAgICAgICAgICAgICBjaGFuZ2VbcHJvcF0gPSB2YWx1ZQogICAgICAgIG54LnNldF9ub2RlX2F0dHJpYnV0ZXMoc2VsZi5HLCB7bjogY2hhbmdlfSkKICAgICAgICBzZWxmLm5vZGVzUHJvcGVydGllc0NoYW5nZWQuZW1pdCh7bjogY2hhbmdlfSkKCiAgICBkZWYgaGFzTm9kZVByb3BlcnR5KHNlbGYsIG46IEhhc2hhYmxlLCBuYW1lLCAvKSAtPiBib29sOgogICAgICAgIHJldHVybiBuYW1lIGluIHNlbGYuRy5ub2Rlc1tuXQoKICAgIGRlZiBnZXROb2RlUHJvcGVydHkoc2VsZiwgbjogSGFzaGFibGUsIG5hbWUsIC8pIC0+IG9iamVjdDoKICAgICAgICByZXR1cm4gc2VsZi5HLm5vZGVzW25dW25hbWVdCgogICAgZGVmIGdldE5vZGVQcm9wZXJ0aWVzKHNlbGYsIG46IEhhc2hhYmxlKSAtPiBsaXN0W3N0cl06CiAgICAgICAgcmV0dXJuIFtrZXkgZm9yIGtleSBpbiBzZWxmLkcubm9kZXNbbl0ua2V5cygpXQoKICAgIGRlZiByZW1vdmVOb2RlKHNlbGYsIG46IEhhc2hhYmxlKToKICAgICAgICBzZWxmLm5vZGVzQWJvdXRUb0JlUmVtb3ZlZC5lbWl0KFtuXSkKICAgICAgICBzZWxmLkcucmVtb3ZlX25vZGUobikKICAgICAgICBzZWxmLm5vZGVzUmVtb3ZlZC5lbWl0KFtuXSkKCiAgICBkZWYgZWRnZXMoCiAgICAgICAgc2VsZiwgbjogSGFzaGFibGUgfCBOb25lID0gTm9uZQogICAgKSAtPiBsaXN0W1R1cGxlW0hhc2hhYmxlLCBIYXNoYWJsZSwgSGFzaGFibGVdXToKICAgICAgICByZXR1cm4gWyh1LCB2LCBrKSBmb3IgdSwgdiwgayBpbiBzZWxmLkcuZWRnZXMobiwga2V5cz1UcnVlKV0KCiAgICBkZWYgaW5FZGdlcyhzZWxmLCBuOiBIYXNoYWJsZSkgLT4gbGlzdFt0dXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV06CiAgICAgICAgIiIicmV0cnVuIGluY29taW5nIGVkZ2VzIHRvIHRoZSBub2RlIiIiCiAgICAgICAgcmV0dXJuIFsodSwgdiwgaykgZm9yIHUsIHYsIGsgaW4gc2VsZi5HLmluX2VkZ2VzKG4sIGtleXM9VHJ1ZSldCgogICAgZGVmIG91dEVkZ2VzKAogICAgICAgIHNlbGYsIG46IEhhc2hhYmxlCiAgICApIC0+IGxpc3RbdHVwbGVbSGFzaGFibGUsIEhhc2hhYmxlLCBIYXNoYWJsZV1dOgogICAgICAgICIiInJldHJ1biBpbmNvbWluZyBlZGdlcyB0byB0aGUgbm9kZSIiIgogICAgICAgIHJldHVybiBbKHUsIHYsIGspIGZvciB1LCB2LCBrIGluIHNlbGYuRy5vdXRfZWRnZXMobiwga2V5cz1UcnVlKV0KCiAgICBkZWYgYWRkRWRnZSgKICAgICAgICBzZWxmLCB1OiBIYXNoYWJsZSwgdjogSGFzaGFibGUsIGs6IEhhc2hhYmxlIHwgTm9uZSA9IE5vbmUsIC8sICoqcHJvcHMKICAgICkgLT4gTm9uZToKICAgICAgICBpZiB1IG5vdCBpbiBzZWxmLkcubm9kZXM6CiAgICAgICAgICAgIHNlbGYuYWRkTm9kZSh1KQogICAgICAgIGlmIHYgbm90IGluIHNlbGYuRy5ub2RlczoKICAgICAgICAgICAgc2VsZi5hZGROb2RlKHYpCgogICAgICAgIHNlbGYuRy5hZGRfZWRnZSh1LCB2LCBrLCAqKnByb3BzKQogICAgICAgIHNlbGYuZWRnZXNBZGRlZC5lbWl0KFsodSwgdiwgayldKQoKICAgIGRlZiByZW1vdmVFZGdlKHNlbGYsIHU6IEhhc2hhYmxlLCB2OiBIYXNoYWJsZSwgazogSGFzaGFibGUpOgogICAgICAgIHNlbGYuZWRnZXNBYm91dFRvQmVSZW1vdmVkLmVtaXQoWyh1LCB2LCBrKV0pCiAgICAgICAgc2VsZi5HLnJlbW92ZV9lZGdlKHUsIHYsIGspCiAgICAgICAgc2VsZi5lZGdlc1JlbW92ZWQuZW1pdChbKHUsIHYsIGspXSkKCiAgICBkZWYgc2V0RWRnZVByb3BlcnRpZXMoCiAgICAgICAgc2VsZiwgdTogSGFzaGFibGUsIHY6IEhhc2hhYmxlLCBrOiBIYXNoYWJsZSwgLywgKipwcm9wcwogICAgKToKICAgICAgICBueC5zZXRfZWRnZV9hdHRyaWJ1dGVzKHNlbGYuRywgeyh1LCB2LCBrKTogcHJvcHN9KQogICAgICAgIHNlbGYuZWRnZXNQcm9wZXJ0aWVzQ2hhbmdlZC5lbWl0KFsodSwgdiwgayldLCBsaXN0KHByb3BzLmtleXMoKSkpCgogICAgZGVmIGdldEVkZ2VQcm9wZXJ0eShzZWxmLCB1OiBIYXNoYWJsZSwgdjogSGFzaGFibGUsIGs6IEhhc2hhYmxlLCBwcm9wLCAvKToKICAgICAgICByZXR1cm4gc2VsZi5HLmVkZ2VzW3UsIHYsIGtdW3Byb3BdCgogICAgZGVmIGlzRWRnZUFsbG93ZWQoc2VsZiwgdTogSGFzaGFibGUsIHY6IEhhc2hhYmxlLCBrOiBIYXNoYWJsZSkgLT4gYm9vbDoKICAgICAgICBpZiB1ID09IHY6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHJldHVybiBUcnVlCg",
					"AQAAAAAAAAABAAAA7gsAAAAAAADuCwAAAAAAAAAAAAAAAPC/"
				],
				[
					84,
					1,
					"insert",
					{
						"characters": "self"
					},
					"BQAAAE8LAAAAAAAAUAsAAAAAAAAAAAAAUAsAAAAAAABQCwAAAAAAAC0AAAAKICAgICAgICBzZWxmLCBuOiBIYXNoYWJsZSB8IE5vbmUgPSBOb25lCiAgICBQCwAAAAAAAFELAAAAAAAAAAAAAFELAAAAAAAAUgsAAAAAAAAAAAAAUgsAAAAAAABTCwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAfAsAAAAAAABPCwAAAAAAAAAAAAAAAPC/"
				],
				[
					91,
					1,
					"right_delete",
					null,
					"AQAAALgLAAAAAAAAuAsAAAAAAAABAAAAKA",
					"AQAAAAAAAAABAAAAuAsAAAAAAAC4CwAAAAAAAAAAAAAAAPC/"
				],
				[
					92,
					1,
					"insert",
					{
						"characters": "["
					},
					"AQAAALgLAAAAAAAAuQsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAuAsAAAAAAAC4CwAAAAAAAAAAAAAAAPC/"
				],
				[
					95,
					1,
					"left_delete",
					null,
					"AQAAALoLAAAAAAAAugsAAAAAAAAMAAAALCBrZXlzPVRydWUp",
					"AQAAAAAAAAABAAAAugsAAAAAAADGCwAAAAAAAAAAAAAAAPC/"
				],
				[
					97,
					1,
					"insert",
					{
						"characters": "]"
					},
					"AQAAALsLAAAAAAAAvAsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAuwsAAAAAAAC7CwAAAAAAAAAAAAAAAPC/"
				],
				[
					103,
					1,
					"left_delete",
					null,
					"AQAAALkLAAAAAAAAuQsAAAAAAAABAAAAbg",
					"AQAAAAAAAAABAAAAugsAAAAAAAC6CwAAAAAAAAAAAAAAAPC/"
				],
				[
					104,
					1,
					"run_macro_file",
					{
						"file": "res://Packages/Default/Delete Left Right.sublime-macro"
					},
					"AgAAALgLAAAAAAAAuAsAAAAAAAABAAAAW7gLAAAAAAAAuAsAAAAAAAABAAAAXQ",
					"AQAAAAAAAAABAAAAuQsAAAAAAAC5CwAAAAAAAAAAAAAAAPC/"
				],
				[
					105,
					1,
					"right_delete",
					null,
					"AQAAALgLAAAAAAAAuAsAAAAAAAABAAAAXQ",
					"AQAAAAAAAAABAAAAuAsAAAAAAAC4CwAAAAAAAAAAAAAAAPC/"
				],
				[
					110,
					1,
					"insert",
					{
						"characters": "]"
					},
					"AQAAALgLAAAAAAAAuQsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAuAsAAAAAAAC4CwAAAAAAAAAAAAAAAPC/"
				],
				[
					112,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAVREAAAAAAABVEQAAZnJvbSB0eXBpbmcgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0R3VpIGltcG9ydCAqCmZyb20gUHlTaWRlNi5RdENvcmUgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0V2lkZ2V0cyBpbXBvcnQgKgoKaW1wb3J0IG5ldHdvcmt4IGFzIG54Cgpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IGludGVyc2VjdF9yYXlfd2l0aF9yZWN0YW5nbGUKCgpjbGFzcyBOWEdyYXBoTW9kZWwoUU9iamVjdCk6CiAgICBub2Rlc0FkZGVkOiBTaWduYWwgPSBTaWduYWwobGlzdCkgICMgTGlzdFtIYXNoYWJsZV0KICAgIG5vZGVzQWJvdXRUb0JlUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKGxpc3QpICAjIExpc3RbSGFzaGFibGVdCiAgICBub2Rlc1Byb3BlcnRpZXNDaGFuZ2VkOiBTaWduYWwgPSBTaWduYWwoCiAgICAgICAgZGljdAogICAgKSAgIyBkaWN0W0hhc2hhYmxlLCBkaWN0W3N0ciwgQW55XV0KICAgIG5vZGVzUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKGxpc3QpCgogICAgZWRnZXNBZGRlZDogU2lnbmFsID0gU2lnbmFsKAogICAgICAgIGxpc3QKICAgICkgICMgTGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV0KICAgIGVkZ2VzQWJvdXRUb0JlUmVtb3ZlZDogU2lnbmFsID0gU2lnbmFsKAogICAgICAgIGxpc3QKICAgICkgICMgTGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV0KICAgIGVkZ2VzUHJvcGVydGllc0NoYW5nZWQ6IFNpZ25hbCA9IFNpZ25hbCgKICAgICAgICBkaWN0CiAgICApICAjIGRpY3RbVHVwbGVbSGFzaGFibGUsIEhhc2hhYmxlLCBIYXNoYWJsZV0sIGRpY3Rbc3RyLCBBbnldXQogICAgZWRnZXNSZW1vdmVkOiBTaWduYWwgPSBTaWduYWwoCiAgICAgICAgbGlzdAogICAgKSAgIyBMaXN0W1R1cGxlW0hhc2hhYmxlLCBIYXNoYWJsZSwgSGFzaGFibGVdXQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBHOiBueC5NdWx0aURpR3JhcGggPSBueC5NdWx0aURpR3JhcGgoKSwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLkcgPSBHCgogICAgICAgIGZvciBuIGluIHNlbGYuRy5ub2RlczoKICAgICAgICAgICAgbm9kZSA9IHNlbGYuYWRkTm9kZShuYW1lPW4pCgogICAgICAgIGZvciBlIGluIHNlbGYuRy5lZGdlczoKICAgICAgICAgICAgdSwgdiwgayA9IGUKCiAgICAgICAgICAgIHNlbGYuYWRkRWRnZSh1LCB2LCBrKQoKICAgIGRlZiBwYXRjaChzZWxmLCBHOiBueC5NdWx0aURpR3JhcGgpOgogICAgICAgIC4uLgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoIk5vdCB5ZXQgaW1wbGVtZW50ZWQiKQoKICAgIGRlZiBfX2RlbF9fKHNlbGYpOgogICAgICAgIGRlbCBzZWxmLkcKICAgICAgICAjIHNlbGYubm9kZXNBZGRlZC5kaXNjb25uZWN0KCkKICAgICAgICAjIHNlbGYubm9kZXNBYm91dFRvQmVSZW1vdmVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5ub2Rlc1Byb3BlcnR5Q2hhbmdlZC5kaXNjb25uZWN0KCkKICAgICAgICAjIHNlbGYubm9kZXNSZW1vdmVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc0FkZGVkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuZGlzY29ubmVjdCgpCiAgICAgICAgIyBzZWxmLmVkZ2VzUHJvcGVydHlDaGFuZ2VkLmRpc2Nvbm5lY3QoKQogICAgICAgICMgc2VsZi5lZGdlc1JlbW92ZWQuZGlzY29ubmVjdCgpCgogICAgZGVmIG5vZGVzKHNlbGYpIC0+IExpc3RbSGFzaGFibGVdOgogICAgICAgIHJldHVybiBbbiBmb3IgbiBpbiBzZWxmLkcubm9kZXNdCgogICAgZGVmIGFkZE5vZGUoc2VsZiwgbjogSGFzaGFibGUsIC8sICoqcHJvcHMpIC0+IE5vbmU6CiAgICAgICAgIyBwcmludCgiYWRkIG5vZGU6ICd7bn0nIikKICAgICAgICBzZWxmLkcuYWRkX25vZGUobiwgKipwcm9wcykKICAgICAgICBzZWxmLm5vZGVzQWRkZWQuZW1pdChbbl0pCiAgICAgICAgc2VsZi5ub2Rlc1Byb3BlcnRpZXNDaGFuZ2VkLmVtaXQoe246IHByb3BzfSkKCiAgICBkZWYgc2V0Tm9kZVByb3BlcnRpZXMoc2VsZiwgbjogSGFzaGFibGUsIC8sICoqcHJvcHMpOgogICAgICAgICMgY2hhbmdlIGd1YXJkIFRPRE86IGZpbmQgcmVtb3ZlZCBwcm9wcwogICAgICAgIGNoYW5nZSA9IHt9CiAgICAgICAgZm9yIHByb3AsIHZhbHVlIGluIHByb3BzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIHByb3Agbm90IGluIHNlbGYuRy5ub2Rlc1tuXSBvciB2YWx1ZSAhPSBzZWxmLkcubm9kZXNbbl1bcHJvcF06CiAgICAgICAgICAgICAgICBjaGFuZ2VbcHJvcF0gPSB2YWx1ZQogICAgICAgIG54LnNldF9ub2RlX2F0dHJpYnV0ZXMoc2VsZi5HLCB7bjogY2hhbmdlfSkKICAgICAgICBzZWxmLm5vZGVzUHJvcGVydGllc0NoYW5nZWQuZW1pdCh7bjogY2hhbmdlfSkKCiAgICBkZWYgaGFzTm9kZVByb3BlcnR5KHNlbGYsIG46IEhhc2hhYmxlLCBuYW1lLCAvKSAtPiBib29sOgogICAgICAgIHJldHVybiBuYW1lIGluIHNlbGYuRy5ub2Rlc1tuXQoKICAgIGRlZiBnZXROb2RlUHJvcGVydHkoc2VsZiwgbjogSGFzaGFibGUsIG5hbWUsIC8pIC0+IG9iamVjdDoKICAgICAgICByZXR1cm4gc2VsZi5HLm5vZGVzW25dW25hbWVdCgogICAgZGVmIGdldE5vZGVQcm9wZXJ0aWVzKHNlbGYsIG46IEhhc2hhYmxlKSAtPiBsaXN0W3N0cl06CiAgICAgICAgcmV0dXJuIFtrZXkgZm9yIGtleSBpbiBzZWxmLkcubm9kZXNbbl0ua2V5cygpXQoKICAgIGRlZiByZW1vdmVOb2RlKHNlbGYsIG46IEhhc2hhYmxlKToKICAgICAgICBzZWxmLm5vZGVzQWJvdXRUb0JlUmVtb3ZlZC5lbWl0KFtuXSkKICAgICAgICBzZWxmLkcucmVtb3ZlX25vZGUobikKICAgICAgICBzZWxmLm5vZGVzUmVtb3ZlZC5lbWl0KFtuXSkKCiAgICBkZWYgZWRnZXMoc2VsZikgLT4gbGlzdFtUdXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV06CiAgICAgICAgcmV0dXJuIFsodSwgdiwgaykgZm9yIHUsIHYsIGsgaW4gc2VsZi5HLmVkZ2VzXQoKICAgIGRlZiBpbkVkZ2VzKHNlbGYsIG46IEhhc2hhYmxlKSAtPiBsaXN0W3R1cGxlW0hhc2hhYmxlLCBIYXNoYWJsZSwgSGFzaGFibGVdXToKICAgICAgICAiIiJyZXRydW4gaW5jb21pbmcgZWRnZXMgdG8gdGhlIG5vZGUiIiIKICAgICAgICByZXR1cm4gWyh1LCB2LCBrKSBmb3IgdSwgdiwgayBpbiBzZWxmLkcuaW5fZWRnZXMobiwga2V5cz1UcnVlKV0KCiAgICBkZWYgb3V0RWRnZXMoCiAgICAgICAgc2VsZiwgbjogSGFzaGFibGUKICAgICkgLT4gbGlzdFt0dXBsZVtIYXNoYWJsZSwgSGFzaGFibGUsIEhhc2hhYmxlXV06CiAgICAgICAgIiIicmV0cnVuIGluY29taW5nIGVkZ2VzIHRvIHRoZSBub2RlIiIiCiAgICAgICAgcmV0dXJuIFsodSwgdiwgaykgZm9yIHUsIHYsIGsgaW4gc2VsZi5HLm91dF9lZGdlcyhuLCBrZXlzPVRydWUpXQoKICAgIGRlZiBhZGRFZGdlKAogICAgICAgIHNlbGYsIHU6IEhhc2hhYmxlLCB2OiBIYXNoYWJsZSwgazogSGFzaGFibGUgfCBOb25lID0gTm9uZSwgLywgKipwcm9wcwogICAgKSAtPiBOb25lOgogICAgICAgIGlmIHUgbm90IGluIHNlbGYuRy5ub2RlczoKICAgICAgICAgICAgc2VsZi5hZGROb2RlKHUpCiAgICAgICAgaWYgdiBub3QgaW4gc2VsZi5HLm5vZGVzOgogICAgICAgICAgICBzZWxmLmFkZE5vZGUodikKCiAgICAgICAgc2VsZi5HLmFkZF9lZGdlKHUsIHYsIGssICoqcHJvcHMpCiAgICAgICAgc2VsZi5lZGdlc0FkZGVkLmVtaXQoWyh1LCB2LCBrKV0pCgogICAgZGVmIHJlbW92ZUVkZ2Uoc2VsZiwgdTogSGFzaGFibGUsIHY6IEhhc2hhYmxlLCBrOiBIYXNoYWJsZSk6CiAgICAgICAgc2VsZi5lZGdlc0Fib3V0VG9CZVJlbW92ZWQuZW1pdChbKHUsIHYsIGspXSkKICAgICAgICBzZWxmLkcucmVtb3ZlX2VkZ2UodSwgdiwgaykKICAgICAgICBzZWxmLmVkZ2VzUmVtb3ZlZC5lbWl0KFsodSwgdiwgayldKQoKICAgIGRlZiBzZXRFZGdlUHJvcGVydGllcygKICAgICAgICBzZWxmLCB1OiBIYXNoYWJsZSwgdjogSGFzaGFibGUsIGs6IEhhc2hhYmxlLCAvLCAqKnByb3BzCiAgICApOgogICAgICAgIG54LnNldF9lZGdlX2F0dHJpYnV0ZXMoc2VsZi5HLCB7KHUsIHYsIGspOiBwcm9wc30pCiAgICAgICAgc2VsZi5lZGdlc1Byb3BlcnRpZXNDaGFuZ2VkLmVtaXQoWyh1LCB2LCBrKV0sIGxpc3QocHJvcHMua2V5cygpKSkKCiAgICBkZWYgZ2V0RWRnZVByb3BlcnR5KHNlbGYsIHU6IEhhc2hhYmxlLCB2OiBIYXNoYWJsZSwgazogSGFzaGFibGUsIHByb3AsIC8pOgogICAgICAgIHJldHVybiBzZWxmLkcuZWRnZXNbdSwgdiwga11bcHJvcF0KCiAgICBkZWYgaXNFZGdlQWxsb3dlZChzZWxmLCB1OiBIYXNoYWJsZSwgdjogSGFzaGFibGUsIGs6IEhhc2hhYmxlKSAtPiBib29sOgogICAgICAgIGlmIHUgPT0gdjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgcmV0dXJuIFRydWUK",
					"AQAAAAAAAAABAAAAuQsAAAAAAAC5CwAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "pylive/NetworkXGraphEditor/nx_graph_shapes.py",
			"settings":
			{
				"buffer_size": 12905,
				"encoding": "UTF-8",
				"line_ending": "Windows"
			},
			"undo_stack":
			[
				[
					499,
					1,
					"insert",
					{
						"characters": "QRectF"
					},
					"BgAAAKYhAAAAAAAApyEAAAAAAAAAAAAApyEAAAAAAACoIQAAAAAAAAAAAACoIQAAAAAAAKkhAAAAAAAAAAAAAKkhAAAAAAAAqiEAAAAAAAAAAAAAqiEAAAAAAACrIQAAAAAAAAAAAACrIQAAAAAAAKwhAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAApiEAAAAAAACmIQAAAAAAAAAAAAAAAPC/"
				],
				[
					500,
					1,
					"insert",
					{
						"characters": "|Qpoint"
					},
					"BwAAAKwhAAAAAAAArSEAAAAAAAAAAAAArSEAAAAAAACuIQAAAAAAAAAAAACuIQAAAAAAAK8hAAAAAAAAAAAAAK8hAAAAAAAAsCEAAAAAAAAAAAAAsCEAAAAAAACxIQAAAAAAAAAAAACxIQAAAAAAALIhAAAAAAAAAAAAALIhAAAAAAAAsyEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAArCEAAAAAAACsIQAAAAAAAAAAAAAAAPC/"
				],
				[
					501,
					1,
					"insert",
					{
						"characters": "F"
					},
					"AQAAALMhAAAAAAAAtCEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAsyEAAAAAAACzIQAAAAAAAAAAAAAAAPC/"
				],
				[
					507,
					1,
					"paste",
					null,
					"AQAAAOEhAAAAAAAA8CEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4SEAAAAAAADhIQAAAAAAAAAAAAAAAPC/"
				],
				[
					517,
					1,
					"insert",
					{
						"characters": "|"
					},
					"AQAAAOEhAAAAAAAA4iEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4SEAAAAAAADhIQAAAAAAAAAAAAAAAPC/"
				],
				[
					518,
					1,
					"paste",
					null,
					"AQAAAOIhAAAAAAAA7iEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4iEAAAAAAADiIQAAAAAAAAAAAAAAAPC/"
				],
				[
					520,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAOzMAAAAAAAAvMwAAIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCiMgUUdyYXBoaWNzSXRlbSBzaGFwZXMuIHB1cmVseSB2aXN1YWwsIGJ1dCBpbnRlcmFjdGl2ZS4KIyB0aGVzIGFyZSB0aGUgc3VwZXJjbGFzcyBvZiB0aGUgTW9kZWxWaWV3IFdpZGdldHMgZm9yIHRoZSBOWEdyYXBoU2NlbmUKIyB0aGVyIGFyZSBubyBzdXBwb3NlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBtb2RlbCBpbiBhbnkgd2F5CiMgcmVzcG9uc2libGUgdG8gcGFpbnQgdWkgaXRlbXMsCiMgYW5kIGNhbiByZWFjdCB0byBtb3VzZSBvciBrZXlib2FyZCBldmVudCwgc3RyaWN0bHkgaW4gYSB2b3N1YWwgd2F5LgojIGluIE1WQyB0aGVzZSB3b3VsZCBiZSB0aGUgdmlld3MuCiMgaW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoZXNlIGFyZSBzZWxmIGNvbnRhaW5lZCB3aWRnZXRzLAojIHRoYXQgY2FuIGJlIHVzZWQgYnkgdGhlICdWaWV3cycKCgpmcm9tIHR5cGluZyBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRHdWkgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0Q29yZSBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRXaWRnZXRzIGltcG9ydCAqCgpmcm9tIHB5bGl2ZS5RdEdyYXBoRWRpdG9yLnFncmFwaGljc19hcnJvd19pdGVtIGltcG9ydCAoCiAgICBtYWtlQXJyb3dTaGFwZSwKKQpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IG1ha2VMaW5lQmV0d2VlblNoYXBlcwoKCmNsYXNzIEFic3RyYWN0U2hhcGUoUUdyYXBoaWNzSXRlbSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLnNldEZsYWcoUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUpCiAgICAgICAgc2VsZi5zZXRBY2NlcHRIb3ZlckV2ZW50cyhUcnVlKQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQgPSBGYWxzZQogICAgICAgIHNlbGYuX2hvdmVyTW91c2VQb3M6IFFQb2ludEYgfCBOb25lID0gTm9uZQoKICAgIGRlZiBzZXRIaWdobGlnaHRlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgc2VsZi5faXNIaWdobGlnaHRlZCA9IHZhbHVlCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBpc0hpZ2hsaWdodGVkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9pc0hpZ2hsaWdodGVkCgogICAgZGVmIGhvdmVyRW50ZXJFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVIb3ZlckV2ZW50KToKICAgICAgICBzZWxmLnNldEhpZ2hsaWdodGVkKFRydWUpCgogICAgZGVmIGhvdmVyTW92ZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZUhvdmVyRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5faG92ZXJNb3VzZVBvcyA9IGV2ZW50LnBvcygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBob3ZlckxlYXZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lSG92ZXJFdmVudCk6CiAgICAgICAgc2VsZi5zZXRIaWdobGlnaHRlZChGYWxzZSkKCiAgICBkZWYgZm9udChzZWxmKToKICAgICAgICBpZiBmb250IDo9IGdldGF0dHIoc2VsZiwgIl9mb250IiwgTm9uZSk6CiAgICAgICAgICAgIHJldHVybiBmb250CiAgICAgICAgZWxpZiBwYXJlbnRXaWRnZXQgOj0gc2VsZi5wYXJlbnRXaWRnZXQoKToKICAgICAgICAgICAgcmV0dXJuIHBhcmVudFdpZGdldC5mb250KCkKICAgICAgICBlbGlmIHNjZW5lIDo9IHNlbGYuc2NlbmUoKToKICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmZvbnQoKQogICAgICAgIGVsaWYgYXBwIDo9IFFBcHBsaWNhdGlvbi5pbnN0YW5jZSgpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFwcCwgUUd1aUFwcGxpY2F0aW9uKToKICAgICAgICAgICAgICAgIHJldHVybiBhcHAuZm9udCgpCgogICAgICAgIHJldHVybiBRRm9udCgpCgogICAgZGVmIHBhbGV0dGUoc2VsZikgLT4gUVBhbGV0dGU6CiAgICAgICAgaWYgcGFsZXR0ZSA6PSBnZXRhdHRyKHNlbGYsICJfcGFsZXR0ZSIsIE5vbmUpOgogICAgICAgICAgICByZXR1cm4gcGFsZXR0ZQogICAgICAgIGVsaWYgcGFyZW50V2lkZ2V0IDo9IHNlbGYucGFyZW50V2lkZ2V0KCk6CiAgICAgICAgICAgIHJldHVybiBwYXJlbnRXaWRnZXQucGFsZXR0ZSgpCiAgICAgICAgZWxpZiBzY2VuZSA6PSBzZWxmLnNjZW5lKCk6CiAgICAgICAgICAgIHJldHVybiBzY2VuZS5wYWxldHRlKCkKICAgICAgICBlbGlmIGFwcCA6PSBRQXBwbGljYXRpb24uaW5zdGFuY2UoKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhcHAsIFFHdWlBcHBsaWNhdGlvbik6CiAgICAgICAgICAgICAgICByZXR1cm4gYXBwLnBhbGV0dGUoKQoKICAgICAgICByZXR1cm4gUVBhbGV0dGUoKQoKICAgIGRlZiBicnVzaChzZWxmKToKICAgICAgICBiYXNlQ29sb3IgPSBzZWxmLnBhbGV0dGUoKS5iYXNlKCkuY29sb3IoKQogICAgICAgIGJhc2VDb2xvci5zZXRBbHBoYSgyNTUpCiAgICAgICAgYnJ1c2ggPSBRQnJ1c2goYmFzZUNvbG9yKQogICAgICAgIHJldHVybiBicnVzaAoKICAgIGRlZiBwZW4oc2VsZik6CiAgICAgICAgcGFsZXR0ZSA9IHNlbGYucGFsZXR0ZSgpCgogICAgICAgIHBlbiA9IFFQZW4ocGFsZXR0ZS50ZXh0KCkuY29sb3IoKSkKCiAgICAgICAgaWYgc2VsZi5pc1NlbGVjdGVkKCk6CiAgICAgICAgICAgIHBlbi5zZXRDb2xvcihwYWxldHRlLmhpZ2hsaWdodCgpLmNvbG9yKCkpICAjIENvbG9yIGZvciBzZWxlY3RlZAoKICAgICAgICBpZiBzZWxmLmlzSGlnaGxpZ2h0ZWQoKToKICAgICAgICAgICAgcGVuLnNldENvbG9yKHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkgICMgQ29sb3IgZm9yIGhvdmVyCgogICAgICAgIHJldHVybiBwZW4KCgpjbGFzcyBWZXJ0ZXhTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkEgZ3JhcGggJ1ZlcnRleCcgZ3JhcGhpY3MgaXRlbS4gbm8gaW5sZXRzIG9yIG91dGxldHMuIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgdGl0bGU6IHN0ciA9ICJOb2RlIiwKICAgICAgICBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhwYXJlbnQpCiAgICAgICAgIyBwcml2YXRlIHZhcmlhYmxlcwogICAgICAgIHNlbGYuX3RpdGxlOiBzdHIgPSB0aXRsZQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQ6IGJvb2wgPSBGYWxzZQoKICAgICAgICAjIEVuYWJsZSBzZWxlY3Rpb24gYW5kIG1vdmVtZW50CiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc01vdmFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc0ZvY3VzYWJsZSwgVHJ1ZSkKICAgICAgICBzZWxmLnNldEZsYWcoCiAgICAgICAgICAgIFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtU2VuZHNTY2VuZVBvc2l0aW9uQ2hhbmdlcwogICAgICAgICkKICAgICAgICBzZWxmLnNldEFjY2VwdEhvdmVyRXZlbnRzKFRydWUpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmIntzZWxmLl9fY2xhc3NfXy5fX25hbWVfX30oe3NlbGYuX3RpdGxlIXJ9KSIKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYmFzZUNvbG9yID0gc2VsZi5wYWxldHRlKCkuYmFzZSgpLmNvbG9yKCkKICAgICAgICBiYXNlQ29sb3Iuc2V0QWxwaGEoMjAwKQogICAgICAgIGJydXNoID0gUUJydXNoKGJhc2VDb2xvcikKICAgICAgICByZXR1cm4gYnJ1c2gKCiAgICBAb3ZlcnJpZGUKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQoKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fdGl0bGUpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHJldHVybiBRUmVjdEYoMCwgMCwgdGV4dF93aWR0aCArIDgsIHRleHRfaGVpZ2h0ICsgNCkKCiAgICBkZWYgcGFpbnQoCiAgICAgICAgc2VsZiwgcGFpbnRlcjogUVBhaW50ZXIsIG9wdGlvbjogUVN0eWxlT3B0aW9uR3JhcGhpY3NJdGVtLCB3aWRnZXQ9Tm9uZQogICAgKToKICAgICAgICBwYWludGVyLnNldEJydXNoKHNlbGYuYnJ1c2goKSkKICAgICAgICBwYWludGVyLnNldFBlbihzZWxmLnBlbigpKQogICAgICAgIHBhaW50ZXIuZHJhd1JvdW5kZWRSZWN0KHNlbGYuYm91bmRpbmdSZWN0KCksIDQsIDQpCgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQoNCwgZm0uaGVpZ2h0KCkgLSAxLCBzZWxmLl90aXRsZSkKCiAgICBkZWYgdGl0bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3RpdGxlCgogICAgZGVmIHNldFRpdGxlKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fdGl0bGUgPSB0ZXh0CiAgICAgICAgc2VsZi51cGRhdGUoKQoKCmNsYXNzIExpbmtTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkdyYXBoaWNzIGl0ZW0gcmVwcmVzZW50aW5nIGFuIGVkZ2UgaW4gYSBncmFwaC4iIiIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwgbGFiZWw6IHN0ciA9ICItbGluay0iLCBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZQogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1Ob25lKQogICAgICAgIHNlbGYuX2xhYmVsID0gbGFiZWwKCiAgICAgICAgIyBFbmFibGUgc2VsZWN0aW5nCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtSXNTZWxlY3RhYmxlKQogICAgICAgIHNlbGYuc2V0QWNjZXB0SG92ZXJFdmVudHMoVHJ1ZSkKICAgICAgICAjIHNlbGYuc2V0WlZhbHVlKC0xKQoKICAgICAgICBzZWxmLl9saW5lOiBRTGluZUYgPSBRTGluZUYoKQoKICAgIGRlZiBzZXRMaW5lKHNlbGYsIGxpbmU6IFFMaW5lRik6CiAgICAgICAgc2VsZi5wcmVwYXJlR2VvbWV0cnlDaGFuZ2UoKQogICAgICAgIHNlbGYuX2xpbmUgPSBsaW5lCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBsaW5lKHNlbGYpIC0+IFFMaW5lRjoKICAgICAgICByZXR1cm4gc2VsZi5fbGluZQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZiJ7c2VsZi5fX2NsYXNzX18uX19uYW1lX199KHtzZWxmLl9sYWJlbCFyfSkiCgogICAgZGVmIHNldExhYmVsVGV4dChzZWxmLCB0ZXh0OiBzdHIpOgogICAgICAgIHNlbGYuX2xhYmVsID0gdGV4dAogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgbGFiZWxUZXh0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9sYWJlbAoKICAgIGRlZiBwZW4oc2VsZik6CiAgICAgICAgIiIib3ZlcnJpZGUgdG8gaW5kaWNhdGUgZW5kcG9pbnRzIHVuZGVyIG1vdXNlIiIiCiAgICAgICAgcGFsZXR0ZSA9IHNlbGYucGFsZXR0ZSgpCgogICAgICAgIHBlbiA9IFFQZW4ocGFsZXR0ZS50ZXh0KCkuY29sb3IoKSkKCiAgICAgICAgaWYgc2VsZi5pc1NlbGVjdGVkKCk6CiAgICAgICAgICAgIHBlbi5zZXRDb2xvcihwYWxldHRlLmhpZ2hsaWdodCgpLmNvbG9yKCkpICAjIENvbG9yIGZvciBzZWxlY3RlZAoKICAgICAgICBpZiBzZWxmLmlzSGlnaGxpZ2h0ZWQoKToKICAgICAgICAgICAgaWYgc2VsZi5faG92ZXJNb3VzZVBvczoKICAgICAgICAgICAgICAgIGxpbmVhckdyYWQgPSBRTGluZWFyR3JhZGllbnQoc2VsZi5saW5lKCkucDEoKSwgc2VsZi5saW5lKCkucDIoKSkKICAgICAgICAgICAgICAgIGQxID0gUUxpbmVGKAogICAgICAgICAgICAgICAgICAgIHNlbGYubWFwRnJvbVBhcmVudChzZWxmLmxpbmUoKS5wMSgpKSwgc2VsZi5faG92ZXJNb3VzZVBvcwogICAgICAgICAgICAgICAgKS5sZW5ndGgoKQogICAgICAgICAgICAgICAgZDIgPSBRTGluZUYoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXBGcm9tUGFyZW50KHNlbGYubGluZSgpLnAyKCkpLCBzZWxmLl9ob3Zlck1vdXNlUG9zCiAgICAgICAgICAgICAgICApLmxlbmd0aCgpCiAgICAgICAgICAgICAgICBpZiBkMSA8IGQyOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjAsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMC41LCBwYWxldHRlLmFjY2VudCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICAgICAgbGluZWFyR3JhZC5zZXRDb2xvckF0KDAuNTUsIHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjQ1LCBwYWxldHRlLnRleHQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjUsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMSwgcGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgcGVuLnNldEJydXNoKFFCcnVzaChsaW5lYXJHcmFkKSkgICMgQ29sb3IgZm9yIGhvdmVyCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwZW4uc2V0QnJ1c2gocGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3IgaG92ZXIKCiAgICAgICAgcmV0dXJuIHBlbgoKICAgIGRlZiBwYWludCgKICAgICAgICBzZWxmLCBwYWludGVyOiBRUGFpbnRlciwgb3B0aW9uOiBRU3R5bGVPcHRpb25HcmFwaGljc0l0ZW0sIHdpZGdldD1Ob25lCiAgICApOgogICAgICAgICMjIyBkcmF3IGFycm93IHNoYXBlCiAgICAgICAgYXJyb3dfc2hhcGUgPSBtYWtlQXJyb3dTaGFwZShzZWxmLmxpbmUoKSwgc2VsZi5wZW4oKS53aWR0aEYoKSkKCiAgICAgICAgIyB1c2UgdGhlIHBlbiBhcyBicnVzaCB0byBkcmF3IHRoZSBhcnJvdyBzaGFwZQogICAgICAgIHBhaW50ZXIuc2V0UGVuKFF0LlBlblN0eWxlLk5vUGVuKQogICAgICAgIHBhaW50ZXIuc2V0QnJ1c2goc2VsZi5wZW4oKS5icnVzaCgpKQogICAgICAgIHBhaW50ZXIuZHJhd1BhdGgoYXJyb3dfc2hhcGUpCiAgICAgICAgcGFpbnRlci5kcmF3TGluZShzZWxmLmxpbmUoKSkKCiAgICAgICAgIyMjIGRyYXcgbGFiZWwKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuc2NlbmUoKS5mb250KCkpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICBmbSA9IFFGb250TWV0cmljcyhRQXBwbGljYXRpb24uaW5zdGFuY2UoKS5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3VGV4dChzZWxmLmxpbmUoKS5jZW50ZXIoKSAtIHNlbGYucG9zKCksIHNlbGYuX2xhYmVsKQoKICAgIGRlZiBzaGFwZShzZWxmKSAtPiBRUGFpbnRlclBhdGg6CiAgICAgICAgIiIiT3ZlcnJpZGUgc2hhcGUgdG8gcHJvdmlkZSBhIHdpZGVyIGNsaWNrYWJsZSBhcmVhLiIiIgogICAgICAgIHBhdGggPSBRUGFpbnRlclBhdGgoKQogICAgICAgIHBhdGgubW92ZVRvKHNlbGYubGluZSgpLnAxKCkpCiAgICAgICAgcGF0aC5saW5lVG8oc2VsZi5saW5lKCkucDIoKSkKICAgICAgICBzdHJva2VyID0gUVBhaW50ZXJQYXRoU3Ryb2tlcigpCiAgICAgICAgc3Ryb2tlci5zZXRXaWR0aCgxMCkKICAgICAgICBzdHJva2VyLnNldENhcFN0eWxlKFF0LlBlbkNhcFN0eWxlLlJvdW5kQ2FwKQogICAgICAgIHN0cm9rZXIuc2V0Sm9pblN0eWxlKFF0LlBlbkpvaW5TdHlsZS5Sb3VuZEpvaW4pCiAgICAgICAgcmV0dXJuIHN0cm9rZXIuY3JlYXRlU3Ryb2tlKHBhdGgpCgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmbSA9IFFGb250TWV0cmljcyhzZWxmLnNjZW5lKCkuZm9udCgpKQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgZm0gPSBRRm9udE1ldHJpY3MoUUFwcGxpY2F0aW9uLmluc3RhbmNlKCkuZm9udCgpKQoKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fbGFiZWwpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQoKICAgICAgICBzaGFwZV9iYm94ID0gc2VsZi5zaGFwZSgpLmJvdW5kaW5nUmVjdCgpCiAgICAgICAgdGV4dF9iYm94ID0gUVJlY3RGKAogICAgICAgICAgICBzZWxmLmxpbmUoKS5jZW50ZXIoKSAtIHNlbGYucG9zKCkgLSBRUG9pbnRGKDAsIHRleHRfaGVpZ2h0KSwKICAgICAgICAgICAgUVNpemVGKHRleHRfd2lkdGgsIHRleHRfaGVpZ2h0KSwKICAgICAgICApCgogICAgICAgIG0gPSBzZWxmLnBlbigpLndpZHRoRigpCiAgICAgICAgcmV0dXJuIHNoYXBlX2Jib3gudW5pdGVkKHRleHRfYmJveCkuYWRqdXN0ZWQoLW0sIC1tLCBtLCBtKQoKICAgIGRlZiBtb3ZlKAogICAgICAgIHNlbGYsCiAgICAgICAgc291cmNlX2dyYXBoaWNzX2l0ZW06IFFHcmFwaGljc0l0ZW18UVBhaW50ZXJQYXRofFFSZWN0RnxRcG9pbnRGLAogICAgICAgIHRhcmdldF9ncmFwaGljc19pdGVtOiBRR3JhcGhpY3NJdGVtfFFQYWludGVyUGF0aHxRUmVjdEZ8UXBvaW50RiwKICAgICk6CiAgICAgICAgbGluZSA9IG1ha2VMaW5lQmV0d2VlblNoYXBlcyhzb3VyY2VfZ3JhcGhpY3NfaXRlbSwgdGFyZ2V0X2dyYXBoaWNzX2l0ZW0pCiAgICAgICAgbGVuZ3RoID0gbGluZS5sZW5ndGgoKQogICAgICAgIGlmIGxlbmd0aCA+IDA6CiAgICAgICAgICAgIG9mZnNldCA9IG1pbig4LCBsZW5ndGggLyAyKQogICAgICAgICAgICBsaW5lID0gUUxpbmVGKAogICAgICAgICAgICAgICAgbGluZS5wb2ludEF0KG9mZnNldCAvIGxlbmd0aCksCiAgICAgICAgICAgICAgICBsaW5lLnBvaW50QXQoKGxlbmd0aCAtIG9mZnNldCkgLyBsZW5ndGgpLAogICAgICAgICAgICApCgogICAgICAgIHNlbGYuc2V0TGluZShsaW5lKQoKCmNsYXNzIE5vZGVTaGFwZShWZXJ0ZXhTaGFwZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdGl0bGUsIGlubGV0cywgb3V0bGV0cywgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18odGl0bGU9dGl0bGUsIHBhcmVudD1wYXJlbnQpCiAgICAgICAgc2VsZi5faW5sZXRzOiBsaXN0W1FHcmFwaGljc0l0ZW1dID0gW10KICAgICAgICBzZWxmLl9vdXRsZXRzOiBsaXN0W1FHcmFwaGljc0l0ZW1dID0gW10KICAgICAgICBzZWxmLnBvcnRzX21hcmdpbiA9IC01CgogICAgICAgIGZvciBpbmxldCBpbiBpbmxldHM6CiAgICAgICAgICAgIHNlbGYuX2FkZElubGV0KGlubGV0KQogICAgICAgIGZvciBvdXRsZXQgaW4gb3V0bGV0czoKICAgICAgICAgICAgc2VsZi5fYWRkT3V0bGV0KG91dGxldCkKCiAgICAgICAgc2VsZi5wb3J0c19tYXJnaW4gPSAtNDAKCiAgICBkZWYgYm91bmRpbmdSZWN0KHNlbGYpIC0+IFFSZWN0RjoKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBzdXBlcigpCiAgICAgICAgICAgIC5ib3VuZGluZ1JlY3QoKQogICAgICAgICAgICAudW5pdGVkKHNlbGYuY2hpbGRyZW5Cb3VuZGluZ1JlY3QoKSkKICAgICAgICAgICAgLmFkanVzdGVkKC00LCAwLCA0LCAyKQogICAgICAgICkKCiAgICBkZWYgX2FkZElubGV0KHNlbGYsIGlubGV0X3dpZGdldDogUUdyYXBoaWNzSXRlbSk6CiAgICAgICAgaW5sZXRfd2lkZ2V0LnNldFBhcmVudEl0ZW0oc2VsZikKICAgICAgICBzZWxmLl9pbmxldHMuYXBwZW5kKGlubGV0X3dpZGdldCkKICAgICAgICBzZWxmLmxheW91dFBvcnRzKCkKICAgICAgICBzZWxmLnVwZGF0ZSgpCgogICAgZGVmIF9yZW1vdmVJbmxldChzZWxmLCBpbmxldF93aWRnZXQ6IFFHcmFwaGljc0l0ZW0pOgogICAgICAgIHNlbGYuX2lubGV0cy5yZW1vdmUoaW5sZXRfd2lkZ2V0KQogICAgICAgIGlubGV0X3dpZGdldC5zZXRQYXJlbnRJdGVtKE5vbmUpCiAgICAgICAgaWYgc2NlbmUgOj0gaW5sZXRfd2lkZ2V0LnNjZW5lKCk6CiAgICAgICAgICAgIHNjZW5lLnJlbW92ZUl0ZW0oaW5sZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX2FkZE91dGxldChzZWxmLCBvdXRsZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBvdXRsZXRfd2lkZ2V0LnNldFBhcmVudEl0ZW0oc2VsZikKICAgICAgICBzZWxmLl9vdXRsZXRzLmFwcGVuZChvdXRsZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX3JlbW92ZU91dGxldChzZWxmLCBvdXRsZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBzZWxmLl9vdXRsZXRzLnJlbW92ZShvdXRsZXRfd2lkZ2V0KQogICAgICAgIG91dGxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIGlmIHNjZW5lIDo9IG91dGxldF93aWRnZXQuc2NlbmUoKToKICAgICAgICAgICAgc2NlbmUucmVtb3ZlSXRlbShvdXRsZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgbGF5b3V0UG9ydHMoc2VsZik6CiAgICAgICAgeSA9IDE0ICAjIGhlYWRlciBoZWlnaG4KICAgICAgICBmb3IgaW5sZXRfd2lkZ2V0IGluIHNlbGYuX2lubGV0czoKICAgICAgICAgICAgaW5sZXRfd2lkZ2V0LnNldFBvcyg0LCB5KQogICAgICAgICAgICB5ICs9IGlubGV0X3dpZGdldC5ib3VuZGluZ1JlY3QoKS5oZWlnaHQoKQoKICAgICAgICBmb3Igb3V0bGV0X3dpZGdldCBpbiBzZWxmLl9vdXRsZXRzOgogICAgICAgICAgICBvdXRsZXRfd2lkZ2V0LnNldFBvcyg0LCB5KQogICAgICAgICAgICB5ICs9IG91dGxldF93aWRnZXQuYm91bmRpbmdSZWN0KCkuaGVpZ2h0KCkKCgpjbGFzcyBQb3J0U2hhcGUoQWJzdHJhY3RTaGFwZSk6CiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBsYWJlbDogc3RyLAogICAgICAgIHBhcmVudDogUUdyYXBoaWNzSXRlbSB8IE5vbmUgPSBOb25lLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1wYXJlbnQpCiAgICAgICAgc2VsZi5fbGFiZWwgPSBsYWJlbAoKICAgIGRlZiBsYWJlbChzZWxmKSAtPiBzdHI6CiAgICAgICAgcmV0dXJuIHNlbGYuX2xhYmVsCgogICAgZGVmIHNldExhYmVsKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fbGFiZWwgPSB0ZXh0CgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIGVsbGlwc2VfYmJveCA9IFFSZWN0RigwLCAwLCAxMCwgMTApCiAgICAgICAgdGV4dF93aWR0aCA9IGZtLmhvcml6b250YWxBZHZhbmNlKHNlbGYuX2xhYmVsKQogICAgICAgIHRleHRfaGVpZ2h0ID0gZm0uaGVpZ2h0KCkKCiAgICAgICAgdGV4dF9wb3MgPSBRUG9pbnRGKDEyLCAwKQogICAgICAgIHRleHRfYmJveCA9IFFSZWN0Rih0ZXh0X3BvcywgUVNpemVGKHRleHRfd2lkdGgsIHRleHRfaGVpZ2h0KSkKICAgICAgICByZXR1cm4gZWxsaXBzZV9iYm94LnVuaXRlZCh0ZXh0X2Jib3gpCgogICAgZGVmIHBhaW50KHNlbGYsIHBhaW50ZXIsIG9wdGlvbiwgd2lkZ2V0PU5vbmUpOgogICAgICAgICMjIyBkcmF3IGxhYmVsCiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0QnJ1c2goc2VsZi5icnVzaCgpKQogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3RWxsaXBzZShRUmVjdEYoMiwgNywgNiwgNikpCgogICAgICAgIHRleHRfaGVpZ2h0ID0gZm0uaGVpZ2h0KCkKICAgICAgICB0ZXh0X3BvcyA9IFFQb2ludEYoMTIsIHRleHRfaGVpZ2h0IC0gMikKICAgICAgICBwYWludGVyLmRyYXdUZXh0KHRleHRfcG9zLCBzZWxmLl9sYWJlbCkKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaW1wb3J0IHN5cwoKICAgIGFwcCA9IFFBcHBsaWNhdGlvbihzeXMuYXJndikKCiAgICBncmFwaHZpZXcgPSBRR3JhcGhpY3NWaWV3KCkKICAgIGdyYXBodmlldy5zZXRXaW5kb3dUaXRsZSgiSHJhcGhpY3NJdGVtIGZvciBOb2RlRWRpdG9yIikKICAgIGdyYXBodmlldy5zZXRSZW5kZXJIaW50KFFQYWludGVyLlJlbmRlckhpbnQuQW50aWFsaWFzaW5nLCBUcnVlKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5UZXh0QW50aWFsaWFzaW5nLCBUcnVlKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5TbW9vdGhQaXhtYXBUcmFuc2Zvcm0sIFRydWUpCgogICAgIyBjcmVhdGUgZ3JhcGggc2NlbmUKICAgIGdyYXBoc2NlbmUgPSBRR3JhcGhpY3NTY2VuZSgpCiAgICBncmFwaHNjZW5lLnNldFNjZW5lUmVjdChRUmVjdEYoLTQwMCwgLTQwMCwgODAwLCA4MDApKQogICAgZ3JhcGh2aWV3LnNldFNjZW5lKGdyYXBoc2NlbmUpCgogICAgIyMgY3JlYXRlIGdyYXBoaWNzCiAgICB2ZXJ0ZXhfaXRlbV8xID0gVmVydGV4U2hhcGUoIkdyYXBoaWNzVmVydGV4SXRlbTEiKQogICAgZ3JhcGhzY2VuZS5hZGRJdGVtKHZlcnRleF9pdGVtXzEpCiAgICB2ZXJ0ZXhfaXRlbV8xLnNldFBvcygwLCAtMTUwKQoKICAgIG5vZGVfaXRlbV8xID0gTm9kZVNoYXBlKAogICAgICAgICJHcmFwaGljc05vZGVJdGVtMSIsCiAgICAgICAgaW5sZXRzPVtQb3J0U2hhcGUoIkdyYXBoaWNzUG9ydEl0ZW1tIildLAogICAgICAgIG91dGxldHM9W1BvcnRTaGFwZSgiR3JhcGhpY3NQb3J0SXRlbSIpXSwKICAgICkKICAgIGdyYXBoc2NlbmUuYWRkSXRlbShub2RlX2l0ZW1fMSkKICAgIG5vZGVfaXRlbV8xLnNldFBvcygwLCAtMTIwKQoKICAgIGxpbmtfaXRlbV8xID0gTGlua1NoYXBlKCJsaW5rMSIpCiAgICBsaW5rX2l0ZW1fMS5zZXRMaW5lKFFMaW5lRigwMCwgLTUwLCAxMDAsIC0yMCkpCiAgICBncmFwaHNjZW5lLmFkZEl0ZW0obGlua19pdGVtXzEpCgogICAgZ3JhcGh2aWV3LnNob3coKQogICAgYXBwLmV4ZWMoKQo",
					"AQAAAAAAAAABAAAA7iEAAAAAAADuIQAAAAAAAAAAAAAAAPC/"
				],
				[
					526,
					1,
					"left_delete",
					null,
					"AQAAALQhAAAAAAAAtCEAAAAAAAABAAAAcA",
					"AQAAAAAAAAABAAAAtSEAAAAAAAC1IQAAAAAAAAAAAAAAAPC/"
				],
				[
					527,
					1,
					"insert",
					{
						"characters": "P"
					},
					"AQAAALQhAAAAAAAAtSEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtCEAAAAAAAC0IQAAAAAAAAAAAAAAAPC/"
				],
				[
					529,
					1,
					"left_delete",
					null,
					"AQAAAAMiAAAAAAAAAyIAAAAAAAABAAAAcA",
					"AQAAAAAAAAABAAAABCIAAAAAAAAEIgAAAAAAAAAAAAAAsH1A"
				],
				[
					530,
					1,
					"insert",
					{
						"characters": "P"
					},
					"AQAAAAMiAAAAAAAABCIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAAyIAAAAAAAADIgAAAAAAAAAAAAAAAPC/"
				],
				[
					534,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAOzMAAAAAAAA7MwAAIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCiMgUUdyYXBoaWNzSXRlbSBzaGFwZXMuIHB1cmVseSB2aXN1YWwsIGJ1dCBpbnRlcmFjdGl2ZS4KIyB0aGVzIGFyZSB0aGUgc3VwZXJjbGFzcyBvZiB0aGUgTW9kZWxWaWV3IFdpZGdldHMgZm9yIHRoZSBOWEdyYXBoU2NlbmUKIyB0aGVyIGFyZSBubyBzdXBwb3NlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBtb2RlbCBpbiBhbnkgd2F5CiMgcmVzcG9uc2libGUgdG8gcGFpbnQgdWkgaXRlbXMsCiMgYW5kIGNhbiByZWFjdCB0byBtb3VzZSBvciBrZXlib2FyZCBldmVudCwgc3RyaWN0bHkgaW4gYSB2b3N1YWwgd2F5LgojIGluIE1WQyB0aGVzZSB3b3VsZCBiZSB0aGUgdmlld3MuCiMgaW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoZXNlIGFyZSBzZWxmIGNvbnRhaW5lZCB3aWRnZXRzLAojIHRoYXQgY2FuIGJlIHVzZWQgYnkgdGhlICdWaWV3cycKCgpmcm9tIHR5cGluZyBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRHdWkgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0Q29yZSBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRXaWRnZXRzIGltcG9ydCAqCgpmcm9tIHB5bGl2ZS5RdEdyYXBoRWRpdG9yLnFncmFwaGljc19hcnJvd19pdGVtIGltcG9ydCAoCiAgICBtYWtlQXJyb3dTaGFwZSwKKQpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IG1ha2VMaW5lQmV0d2VlblNoYXBlcwoKCmNsYXNzIEFic3RyYWN0U2hhcGUoUUdyYXBoaWNzSXRlbSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLnNldEZsYWcoUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUpCiAgICAgICAgc2VsZi5zZXRBY2NlcHRIb3ZlckV2ZW50cyhUcnVlKQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQgPSBGYWxzZQogICAgICAgIHNlbGYuX2hvdmVyTW91c2VQb3M6IFFQb2ludEYgfCBOb25lID0gTm9uZQoKICAgIGRlZiBzZXRIaWdobGlnaHRlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgc2VsZi5faXNIaWdobGlnaHRlZCA9IHZhbHVlCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBpc0hpZ2hsaWdodGVkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9pc0hpZ2hsaWdodGVkCgogICAgZGVmIGhvdmVyRW50ZXJFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVIb3ZlckV2ZW50KToKICAgICAgICBzZWxmLnNldEhpZ2hsaWdodGVkKFRydWUpCgogICAgZGVmIGhvdmVyTW92ZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZUhvdmVyRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5faG92ZXJNb3VzZVBvcyA9IGV2ZW50LnBvcygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBob3ZlckxlYXZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lSG92ZXJFdmVudCk6CiAgICAgICAgc2VsZi5zZXRIaWdobGlnaHRlZChGYWxzZSkKCiAgICBkZWYgZm9udChzZWxmKToKICAgICAgICBpZiBmb250IDo9IGdldGF0dHIoc2VsZiwgIl9mb250IiwgTm9uZSk6CiAgICAgICAgICAgIHJldHVybiBmb250CiAgICAgICAgZWxpZiBwYXJlbnRXaWRnZXQgOj0gc2VsZi5wYXJlbnRXaWRnZXQoKToKICAgICAgICAgICAgcmV0dXJuIHBhcmVudFdpZGdldC5mb250KCkKICAgICAgICBlbGlmIHNjZW5lIDo9IHNlbGYuc2NlbmUoKToKICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmZvbnQoKQogICAgICAgIGVsaWYgYXBwIDo9IFFBcHBsaWNhdGlvbi5pbnN0YW5jZSgpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFwcCwgUUd1aUFwcGxpY2F0aW9uKToKICAgICAgICAgICAgICAgIHJldHVybiBhcHAuZm9udCgpCgogICAgICAgIHJldHVybiBRRm9udCgpCgogICAgZGVmIHBhbGV0dGUoc2VsZikgLT4gUVBhbGV0dGU6CiAgICAgICAgaWYgcGFsZXR0ZSA6PSBnZXRhdHRyKHNlbGYsICJfcGFsZXR0ZSIsIE5vbmUpOgogICAgICAgICAgICByZXR1cm4gcGFsZXR0ZQogICAgICAgIGVsaWYgcGFyZW50V2lkZ2V0IDo9IHNlbGYucGFyZW50V2lkZ2V0KCk6CiAgICAgICAgICAgIHJldHVybiBwYXJlbnRXaWRnZXQucGFsZXR0ZSgpCiAgICAgICAgZWxpZiBzY2VuZSA6PSBzZWxmLnNjZW5lKCk6CiAgICAgICAgICAgIHJldHVybiBzY2VuZS5wYWxldHRlKCkKICAgICAgICBlbGlmIGFwcCA6PSBRQXBwbGljYXRpb24uaW5zdGFuY2UoKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhcHAsIFFHdWlBcHBsaWNhdGlvbik6CiAgICAgICAgICAgICAgICByZXR1cm4gYXBwLnBhbGV0dGUoKQoKICAgICAgICByZXR1cm4gUVBhbGV0dGUoKQoKICAgIGRlZiBicnVzaChzZWxmKToKICAgICAgICBiYXNlQ29sb3IgPSBzZWxmLnBhbGV0dGUoKS5iYXNlKCkuY29sb3IoKQogICAgICAgIGJhc2VDb2xvci5zZXRBbHBoYSgyNTUpCiAgICAgICAgYnJ1c2ggPSBRQnJ1c2goYmFzZUNvbG9yKQogICAgICAgIHJldHVybiBicnVzaAoKICAgIGRlZiBwZW4oc2VsZik6CiAgICAgICAgcGFsZXR0ZSA9IHNlbGYucGFsZXR0ZSgpCgogICAgICAgIHBlbiA9IFFQZW4ocGFsZXR0ZS50ZXh0KCkuY29sb3IoKSkKCiAgICAgICAgaWYgc2VsZi5pc1NlbGVjdGVkKCk6CiAgICAgICAgICAgIHBlbi5zZXRDb2xvcihwYWxldHRlLmhpZ2hsaWdodCgpLmNvbG9yKCkpICAjIENvbG9yIGZvciBzZWxlY3RlZAoKICAgICAgICBpZiBzZWxmLmlzSGlnaGxpZ2h0ZWQoKToKICAgICAgICAgICAgcGVuLnNldENvbG9yKHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkgICMgQ29sb3IgZm9yIGhvdmVyCgogICAgICAgIHJldHVybiBwZW4KCgpjbGFzcyBWZXJ0ZXhTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkEgZ3JhcGggJ1ZlcnRleCcgZ3JhcGhpY3MgaXRlbS4gbm8gaW5sZXRzIG9yIG91dGxldHMuIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgdGl0bGU6IHN0ciA9ICJOb2RlIiwKICAgICAgICBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhwYXJlbnQpCiAgICAgICAgIyBwcml2YXRlIHZhcmlhYmxlcwogICAgICAgIHNlbGYuX3RpdGxlOiBzdHIgPSB0aXRsZQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQ6IGJvb2wgPSBGYWxzZQoKICAgICAgICAjIEVuYWJsZSBzZWxlY3Rpb24gYW5kIG1vdmVtZW50CiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc01vdmFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc0ZvY3VzYWJsZSwgVHJ1ZSkKICAgICAgICBzZWxmLnNldEZsYWcoCiAgICAgICAgICAgIFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtU2VuZHNTY2VuZVBvc2l0aW9uQ2hhbmdlcwogICAgICAgICkKICAgICAgICBzZWxmLnNldEFjY2VwdEhvdmVyRXZlbnRzKFRydWUpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmIntzZWxmLl9fY2xhc3NfXy5fX25hbWVfX30oe3NlbGYuX3RpdGxlIXJ9KSIKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYmFzZUNvbG9yID0gc2VsZi5wYWxldHRlKCkuYmFzZSgpLmNvbG9yKCkKICAgICAgICBiYXNlQ29sb3Iuc2V0QWxwaGEoMjAwKQogICAgICAgIGJydXNoID0gUUJydXNoKGJhc2VDb2xvcikKICAgICAgICByZXR1cm4gYnJ1c2gKCiAgICBAb3ZlcnJpZGUKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQoKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fdGl0bGUpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHJldHVybiBRUmVjdEYoMCwgMCwgdGV4dF93aWR0aCArIDgsIHRleHRfaGVpZ2h0ICsgNCkKCiAgICBkZWYgcGFpbnQoCiAgICAgICAgc2VsZiwgcGFpbnRlcjogUVBhaW50ZXIsIG9wdGlvbjogUVN0eWxlT3B0aW9uR3JhcGhpY3NJdGVtLCB3aWRnZXQ9Tm9uZQogICAgKToKICAgICAgICBwYWludGVyLnNldEJydXNoKHNlbGYuYnJ1c2goKSkKICAgICAgICBwYWludGVyLnNldFBlbihzZWxmLnBlbigpKQogICAgICAgIHBhaW50ZXIuZHJhd1JvdW5kZWRSZWN0KHNlbGYuYm91bmRpbmdSZWN0KCksIDQsIDQpCgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQoNCwgZm0uaGVpZ2h0KCkgLSAxLCBzZWxmLl90aXRsZSkKCiAgICBkZWYgdGl0bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3RpdGxlCgogICAgZGVmIHNldFRpdGxlKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fdGl0bGUgPSB0ZXh0CiAgICAgICAgc2VsZi51cGRhdGUoKQoKCmNsYXNzIExpbmtTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkdyYXBoaWNzIGl0ZW0gcmVwcmVzZW50aW5nIGFuIGVkZ2UgaW4gYSBncmFwaC4iIiIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwgbGFiZWw6IHN0ciA9ICItbGluay0iLCBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZQogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1Ob25lKQogICAgICAgIHNlbGYuX2xhYmVsID0gbGFiZWwKCiAgICAgICAgIyBFbmFibGUgc2VsZWN0aW5nCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtSXNTZWxlY3RhYmxlKQogICAgICAgIHNlbGYuc2V0QWNjZXB0SG92ZXJFdmVudHMoVHJ1ZSkKICAgICAgICAjIHNlbGYuc2V0WlZhbHVlKC0xKQoKICAgICAgICBzZWxmLl9saW5lOiBRTGluZUYgPSBRTGluZUYoKQoKICAgIGRlZiBzZXRMaW5lKHNlbGYsIGxpbmU6IFFMaW5lRik6CiAgICAgICAgc2VsZi5wcmVwYXJlR2VvbWV0cnlDaGFuZ2UoKQogICAgICAgIHNlbGYuX2xpbmUgPSBsaW5lCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBsaW5lKHNlbGYpIC0+IFFMaW5lRjoKICAgICAgICByZXR1cm4gc2VsZi5fbGluZQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZiJ7c2VsZi5fX2NsYXNzX18uX19uYW1lX199KHtzZWxmLl9sYWJlbCFyfSkiCgogICAgZGVmIHNldExhYmVsVGV4dChzZWxmLCB0ZXh0OiBzdHIpOgogICAgICAgIHNlbGYuX2xhYmVsID0gdGV4dAogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgbGFiZWxUZXh0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9sYWJlbAoKICAgIGRlZiBwZW4oc2VsZik6CiAgICAgICAgIiIib3ZlcnJpZGUgdG8gaW5kaWNhdGUgZW5kcG9pbnRzIHVuZGVyIG1vdXNlIiIiCiAgICAgICAgcGFsZXR0ZSA9IHNlbGYucGFsZXR0ZSgpCgogICAgICAgIHBlbiA9IFFQZW4ocGFsZXR0ZS50ZXh0KCkuY29sb3IoKSkKCiAgICAgICAgaWYgc2VsZi5pc1NlbGVjdGVkKCk6CiAgICAgICAgICAgIHBlbi5zZXRDb2xvcihwYWxldHRlLmhpZ2hsaWdodCgpLmNvbG9yKCkpICAjIENvbG9yIGZvciBzZWxlY3RlZAoKICAgICAgICBpZiBzZWxmLmlzSGlnaGxpZ2h0ZWQoKToKICAgICAgICAgICAgaWYgc2VsZi5faG92ZXJNb3VzZVBvczoKICAgICAgICAgICAgICAgIGxpbmVhckdyYWQgPSBRTGluZWFyR3JhZGllbnQoc2VsZi5saW5lKCkucDEoKSwgc2VsZi5saW5lKCkucDIoKSkKICAgICAgICAgICAgICAgIGQxID0gUUxpbmVGKAogICAgICAgICAgICAgICAgICAgIHNlbGYubWFwRnJvbVBhcmVudChzZWxmLmxpbmUoKS5wMSgpKSwgc2VsZi5faG92ZXJNb3VzZVBvcwogICAgICAgICAgICAgICAgKS5sZW5ndGgoKQogICAgICAgICAgICAgICAgZDIgPSBRTGluZUYoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXBGcm9tUGFyZW50KHNlbGYubGluZSgpLnAyKCkpLCBzZWxmLl9ob3Zlck1vdXNlUG9zCiAgICAgICAgICAgICAgICApLmxlbmd0aCgpCiAgICAgICAgICAgICAgICBpZiBkMSA8IGQyOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjAsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMC41LCBwYWxldHRlLmFjY2VudCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICAgICAgbGluZWFyR3JhZC5zZXRDb2xvckF0KDAuNTUsIHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjQ1LCBwYWxldHRlLnRleHQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjUsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMSwgcGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgcGVuLnNldEJydXNoKFFCcnVzaChsaW5lYXJHcmFkKSkgICMgQ29sb3IgZm9yIGhvdmVyCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwZW4uc2V0QnJ1c2gocGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3IgaG92ZXIKCiAgICAgICAgcmV0dXJuIHBlbgoKICAgIGRlZiBwYWludCgKICAgICAgICBzZWxmLCBwYWludGVyOiBRUGFpbnRlciwgb3B0aW9uOiBRU3R5bGVPcHRpb25HcmFwaGljc0l0ZW0sIHdpZGdldD1Ob25lCiAgICApOgogICAgICAgICMjIyBkcmF3IGFycm93IHNoYXBlCiAgICAgICAgYXJyb3dfc2hhcGUgPSBtYWtlQXJyb3dTaGFwZShzZWxmLmxpbmUoKSwgc2VsZi5wZW4oKS53aWR0aEYoKSkKCiAgICAgICAgIyB1c2UgdGhlIHBlbiBhcyBicnVzaCB0byBkcmF3IHRoZSBhcnJvdyBzaGFwZQogICAgICAgIHBhaW50ZXIuc2V0UGVuKFF0LlBlblN0eWxlLk5vUGVuKQogICAgICAgIHBhaW50ZXIuc2V0QnJ1c2goc2VsZi5wZW4oKS5icnVzaCgpKQogICAgICAgIHBhaW50ZXIuZHJhd1BhdGgoYXJyb3dfc2hhcGUpCiAgICAgICAgcGFpbnRlci5kcmF3TGluZShzZWxmLmxpbmUoKSkKCiAgICAgICAgIyMjIGRyYXcgbGFiZWwKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuc2NlbmUoKS5mb250KCkpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICBmbSA9IFFGb250TWV0cmljcyhRQXBwbGljYXRpb24uaW5zdGFuY2UoKS5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3VGV4dChzZWxmLmxpbmUoKS5jZW50ZXIoKSAtIHNlbGYucG9zKCksIHNlbGYuX2xhYmVsKQoKICAgIGRlZiBzaGFwZShzZWxmKSAtPiBRUGFpbnRlclBhdGg6CiAgICAgICAgIiIiT3ZlcnJpZGUgc2hhcGUgdG8gcHJvdmlkZSBhIHdpZGVyIGNsaWNrYWJsZSBhcmVhLiIiIgogICAgICAgIHBhdGggPSBRUGFpbnRlclBhdGgoKQogICAgICAgIHBhdGgubW92ZVRvKHNlbGYubGluZSgpLnAxKCkpCiAgICAgICAgcGF0aC5saW5lVG8oc2VsZi5saW5lKCkucDIoKSkKICAgICAgICBzdHJva2VyID0gUVBhaW50ZXJQYXRoU3Ryb2tlcigpCiAgICAgICAgc3Ryb2tlci5zZXRXaWR0aCgxMCkKICAgICAgICBzdHJva2VyLnNldENhcFN0eWxlKFF0LlBlbkNhcFN0eWxlLlJvdW5kQ2FwKQogICAgICAgIHN0cm9rZXIuc2V0Sm9pblN0eWxlKFF0LlBlbkpvaW5TdHlsZS5Sb3VuZEpvaW4pCiAgICAgICAgcmV0dXJuIHN0cm9rZXIuY3JlYXRlU3Ryb2tlKHBhdGgpCgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmbSA9IFFGb250TWV0cmljcyhzZWxmLnNjZW5lKCkuZm9udCgpKQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgZm0gPSBRRm9udE1ldHJpY3MoUUFwcGxpY2F0aW9uLmluc3RhbmNlKCkuZm9udCgpKQoKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fbGFiZWwpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQoKICAgICAgICBzaGFwZV9iYm94ID0gc2VsZi5zaGFwZSgpLmJvdW5kaW5nUmVjdCgpCiAgICAgICAgdGV4dF9iYm94ID0gUVJlY3RGKAogICAgICAgICAgICBzZWxmLmxpbmUoKS5jZW50ZXIoKSAtIHNlbGYucG9zKCkgLSBRUG9pbnRGKDAsIHRleHRfaGVpZ2h0KSwKICAgICAgICAgICAgUVNpemVGKHRleHRfd2lkdGgsIHRleHRfaGVpZ2h0KSwKICAgICAgICApCgogICAgICAgIG0gPSBzZWxmLnBlbigpLndpZHRoRigpCiAgICAgICAgcmV0dXJuIHNoYXBlX2Jib3gudW5pdGVkKHRleHRfYmJveCkuYWRqdXN0ZWQoLW0sIC1tLCBtLCBtKQoKICAgIGRlZiBtb3ZlKAogICAgICAgIHNlbGYsCiAgICAgICAgc291cmNlX2dyYXBoaWNzX2l0ZW06IFFHcmFwaGljc0l0ZW0gfCBRUGFpbnRlclBhdGggfCBRUmVjdEYgfCBRUG9pbnRGLAogICAgICAgIHRhcmdldF9ncmFwaGljc19pdGVtOiBRR3JhcGhpY3NJdGVtIHwgUVBhaW50ZXJQYXRoIHwgUVJlY3RGIHwgUVBvaW50RiwKICAgICk6CiAgICAgICAgbGluZSA9IG1ha2VMaW5lQmV0d2VlblNoYXBlcyhzb3VyY2VfZ3JhcGhpY3NfaXRlbSwgdGFyZ2V0X2dyYXBoaWNzX2l0ZW0pCiAgICAgICAgbGVuZ3RoID0gbGluZS5sZW5ndGgoKQogICAgICAgIGlmIGxlbmd0aCA+IDA6CiAgICAgICAgICAgIG9mZnNldCA9IG1pbig4LCBsZW5ndGggLyAyKQogICAgICAgICAgICBsaW5lID0gUUxpbmVGKAogICAgICAgICAgICAgICAgbGluZS5wb2ludEF0KG9mZnNldCAvIGxlbmd0aCksCiAgICAgICAgICAgICAgICBsaW5lLnBvaW50QXQoKGxlbmd0aCAtIG9mZnNldCkgLyBsZW5ndGgpLAogICAgICAgICAgICApCgogICAgICAgIHNlbGYuc2V0TGluZShsaW5lKQoKCmNsYXNzIE5vZGVTaGFwZShWZXJ0ZXhTaGFwZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdGl0bGUsIGlubGV0cywgb3V0bGV0cywgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18odGl0bGU9dGl0bGUsIHBhcmVudD1wYXJlbnQpCiAgICAgICAgc2VsZi5faW5sZXRzOiBsaXN0W1FHcmFwaGljc0l0ZW1dID0gW10KICAgICAgICBzZWxmLl9vdXRsZXRzOiBsaXN0W1FHcmFwaGljc0l0ZW1dID0gW10KICAgICAgICBzZWxmLnBvcnRzX21hcmdpbiA9IC01CgogICAgICAgIGZvciBpbmxldCBpbiBpbmxldHM6CiAgICAgICAgICAgIHNlbGYuX2FkZElubGV0KGlubGV0KQogICAgICAgIGZvciBvdXRsZXQgaW4gb3V0bGV0czoKICAgICAgICAgICAgc2VsZi5fYWRkT3V0bGV0KG91dGxldCkKCiAgICAgICAgc2VsZi5wb3J0c19tYXJnaW4gPSAtNDAKCiAgICBkZWYgYm91bmRpbmdSZWN0KHNlbGYpIC0+IFFSZWN0RjoKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBzdXBlcigpCiAgICAgICAgICAgIC5ib3VuZGluZ1JlY3QoKQogICAgICAgICAgICAudW5pdGVkKHNlbGYuY2hpbGRyZW5Cb3VuZGluZ1JlY3QoKSkKICAgICAgICAgICAgLmFkanVzdGVkKC00LCAwLCA0LCAyKQogICAgICAgICkKCiAgICBkZWYgX2FkZElubGV0KHNlbGYsIGlubGV0X3dpZGdldDogUUdyYXBoaWNzSXRlbSk6CiAgICAgICAgaW5sZXRfd2lkZ2V0LnNldFBhcmVudEl0ZW0oc2VsZikKICAgICAgICBzZWxmLl9pbmxldHMuYXBwZW5kKGlubGV0X3dpZGdldCkKICAgICAgICBzZWxmLmxheW91dFBvcnRzKCkKICAgICAgICBzZWxmLnVwZGF0ZSgpCgogICAgZGVmIF9yZW1vdmVJbmxldChzZWxmLCBpbmxldF93aWRnZXQ6IFFHcmFwaGljc0l0ZW0pOgogICAgICAgIHNlbGYuX2lubGV0cy5yZW1vdmUoaW5sZXRfd2lkZ2V0KQogICAgICAgIGlubGV0X3dpZGdldC5zZXRQYXJlbnRJdGVtKE5vbmUpCiAgICAgICAgaWYgc2NlbmUgOj0gaW5sZXRfd2lkZ2V0LnNjZW5lKCk6CiAgICAgICAgICAgIHNjZW5lLnJlbW92ZUl0ZW0oaW5sZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX2FkZE91dGxldChzZWxmLCBvdXRsZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBvdXRsZXRfd2lkZ2V0LnNldFBhcmVudEl0ZW0oc2VsZikKICAgICAgICBzZWxmLl9vdXRsZXRzLmFwcGVuZChvdXRsZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX3JlbW92ZU91dGxldChzZWxmLCBvdXRsZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBzZWxmLl9vdXRsZXRzLnJlbW92ZShvdXRsZXRfd2lkZ2V0KQogICAgICAgIG91dGxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIGlmIHNjZW5lIDo9IG91dGxldF93aWRnZXQuc2NlbmUoKToKICAgICAgICAgICAgc2NlbmUucmVtb3ZlSXRlbShvdXRsZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgbGF5b3V0UG9ydHMoc2VsZik6CiAgICAgICAgeSA9IDE0ICAjIGhlYWRlciBoZWlnaG4KICAgICAgICBmb3IgaW5sZXRfd2lkZ2V0IGluIHNlbGYuX2lubGV0czoKICAgICAgICAgICAgaW5sZXRfd2lkZ2V0LnNldFBvcyg0LCB5KQogICAgICAgICAgICB5ICs9IGlubGV0X3dpZGdldC5ib3VuZGluZ1JlY3QoKS5oZWlnaHQoKQoKICAgICAgICBmb3Igb3V0bGV0X3dpZGdldCBpbiBzZWxmLl9vdXRsZXRzOgogICAgICAgICAgICBvdXRsZXRfd2lkZ2V0LnNldFBvcyg0LCB5KQogICAgICAgICAgICB5ICs9IG91dGxldF93aWRnZXQuYm91bmRpbmdSZWN0KCkuaGVpZ2h0KCkKCgpjbGFzcyBQb3J0U2hhcGUoQWJzdHJhY3RTaGFwZSk6CiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBsYWJlbDogc3RyLAogICAgICAgIHBhcmVudDogUUdyYXBoaWNzSXRlbSB8IE5vbmUgPSBOb25lLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1wYXJlbnQpCiAgICAgICAgc2VsZi5fbGFiZWwgPSBsYWJlbAoKICAgIGRlZiBsYWJlbChzZWxmKSAtPiBzdHI6CiAgICAgICAgcmV0dXJuIHNlbGYuX2xhYmVsCgogICAgZGVmIHNldExhYmVsKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fbGFiZWwgPSB0ZXh0CgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIGVsbGlwc2VfYmJveCA9IFFSZWN0RigwLCAwLCAxMCwgMTApCiAgICAgICAgdGV4dF93aWR0aCA9IGZtLmhvcml6b250YWxBZHZhbmNlKHNlbGYuX2xhYmVsKQogICAgICAgIHRleHRfaGVpZ2h0ID0gZm0uaGVpZ2h0KCkKCiAgICAgICAgdGV4dF9wb3MgPSBRUG9pbnRGKDEyLCAwKQogICAgICAgIHRleHRfYmJveCA9IFFSZWN0Rih0ZXh0X3BvcywgUVNpemVGKHRleHRfd2lkdGgsIHRleHRfaGVpZ2h0KSkKICAgICAgICByZXR1cm4gZWxsaXBzZV9iYm94LnVuaXRlZCh0ZXh0X2Jib3gpCgogICAgZGVmIHBhaW50KHNlbGYsIHBhaW50ZXIsIG9wdGlvbiwgd2lkZ2V0PU5vbmUpOgogICAgICAgICMjIyBkcmF3IGxhYmVsCiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0QnJ1c2goc2VsZi5icnVzaCgpKQogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3RWxsaXBzZShRUmVjdEYoMiwgNywgNiwgNikpCgogICAgICAgIHRleHRfaGVpZ2h0ID0gZm0uaGVpZ2h0KCkKICAgICAgICB0ZXh0X3BvcyA9IFFQb2ludEYoMTIsIHRleHRfaGVpZ2h0IC0gMikKICAgICAgICBwYWludGVyLmRyYXdUZXh0KHRleHRfcG9zLCBzZWxmLl9sYWJlbCkKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaW1wb3J0IHN5cwoKICAgIGFwcCA9IFFBcHBsaWNhdGlvbihzeXMuYXJndikKCiAgICBncmFwaHZpZXcgPSBRR3JhcGhpY3NWaWV3KCkKICAgIGdyYXBodmlldy5zZXRXaW5kb3dUaXRsZSgiSHJhcGhpY3NJdGVtIGZvciBOb2RlRWRpdG9yIikKICAgIGdyYXBodmlldy5zZXRSZW5kZXJIaW50KFFQYWludGVyLlJlbmRlckhpbnQuQW50aWFsaWFzaW5nLCBUcnVlKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5UZXh0QW50aWFsaWFzaW5nLCBUcnVlKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5TbW9vdGhQaXhtYXBUcmFuc2Zvcm0sIFRydWUpCgogICAgIyBjcmVhdGUgZ3JhcGggc2NlbmUKICAgIGdyYXBoc2NlbmUgPSBRR3JhcGhpY3NTY2VuZSgpCiAgICBncmFwaHNjZW5lLnNldFNjZW5lUmVjdChRUmVjdEYoLTQwMCwgLTQwMCwgODAwLCA4MDApKQogICAgZ3JhcGh2aWV3LnNldFNjZW5lKGdyYXBoc2NlbmUpCgogICAgIyMgY3JlYXRlIGdyYXBoaWNzCiAgICB2ZXJ0ZXhfaXRlbV8xID0gVmVydGV4U2hhcGUoIkdyYXBoaWNzVmVydGV4SXRlbTEiKQogICAgZ3JhcGhzY2VuZS5hZGRJdGVtKHZlcnRleF9pdGVtXzEpCiAgICB2ZXJ0ZXhfaXRlbV8xLnNldFBvcygwLCAtMTUwKQoKICAgIG5vZGVfaXRlbV8xID0gTm9kZVNoYXBlKAogICAgICAgICJHcmFwaGljc05vZGVJdGVtMSIsCiAgICAgICAgaW5sZXRzPVtQb3J0U2hhcGUoIkdyYXBoaWNzUG9ydEl0ZW1tIildLAogICAgICAgIG91dGxldHM9W1BvcnRTaGFwZSgiR3JhcGhpY3NQb3J0SXRlbSIpXSwKICAgICkKICAgIGdyYXBoc2NlbmUuYWRkSXRlbShub2RlX2l0ZW1fMSkKICAgIG5vZGVfaXRlbV8xLnNldFBvcygwLCAtMTIwKQoKICAgIGxpbmtfaXRlbV8xID0gTGlua1NoYXBlKCJsaW5rMSIpCiAgICBsaW5rX2l0ZW1fMS5zZXRMaW5lKFFMaW5lRigwMCwgLTUwLCAxMDAsIC0yMCkpCiAgICBncmFwaHNjZW5lLmFkZEl0ZW0obGlua19pdGVtXzEpCgogICAgZ3JhcGh2aWV3LnNob3coKQogICAgYXBwLmV4ZWMoKQo",
					"AQAAAAAAAAABAAAATyEAAAAAAABPIQAAAAAAAAAAAAAAAPC/"
				],
				[
					548,
					1,
					"insert",
					{
						"characters": "_"
					},
					"AQAAADkUAAAAAAAAOhQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAORQAAAAAAAA5FAAAAAAAAAAAAAAAAPC/"
				],
				[
					558,
					2,
					"left_delete",
					null,
					"AgAAANAWAAAAAAAA0BYAAAAAAAABAAAAKc8WAAAAAAAAzxYAAAAAAAABAAAAKA",
					"AQAAAAAAAAABAAAA0RYAAAAAAADRFgAAAAAAAAAAAAAAAPC/"
				],
				[
					561,
					1,
					"insert",
					{
						"characters": "_"
					},
					"AQAAAMsWAAAAAAAAzBYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAyxYAAAAAAADLFgAAAAAAAAAAAAAAAPC/"
				],
				[
					571,
					3,
					"right_delete",
					null,
					"AwAAANwWAAAAAAAA3BYAAAAAAAAEAAAAbGluZdwWAAAAAAAA3BYAAAAAAAABAAAAKNwWAAAAAAAA3BYAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAA3BYAAAAAAADgFgAAAAAAAAAAAAAAAPC/"
				],
				[
					572,
					1,
					"paste",
					null,
					"AQAAANwWAAAAAAAA4RYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA3BYAAAAAAADcFgAAAAAAAAAAAAAAAPC/"
				],
				[
					578,
					3,
					"right_delete",
					null,
					"AwAAADEXAAAAAAAAMRcAAAAAAAAEAAAAbGluZTEXAAAAAAAAMRcAAAAAAAABAAAAKDEXAAAAAAAAMRcAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAAMRcAAAAAAAA1FwAAAAAAAAAAAAAAAPC/"
				],
				[
					579,
					1,
					"paste",
					null,
					"AQAAADEXAAAAAAAANhcAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMRcAAAAAAAAxFwAAAAAAAAAAAAAAAPC/"
				],
				[
					585,
					3,
					"right_delete",
					null,
					"AwAAALYXAAAAAAAAthcAAAAAAAAEAAAAbGluZbYXAAAAAAAAthcAAAAAAAABAAAAKLYXAAAAAAAAthcAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAAthcAAAAAAAC6FwAAAAAAAAAAAAAAAPC/"
				],
				[
					586,
					1,
					"paste",
					null,
					"AQAAALYXAAAAAAAAuxcAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAthcAAAAAAAC2FwAAAAAAAAAAAAAAAPC/"
				],
				[
					589,
					1,
					"toggle_comment",
					{
						"block": false
					},
					"BgAAAFQUAAAAAAAAVhQAAAAAAAAAAAAANRQAAAAAAAA3FAAAAAAAAAAAAAAeFAAAAAAAACAUAAAAAAAAAAAAAAQUAAAAAAAABhQAAAAAAAAAAAAA3xMAAAAAAADhEwAAAAAAAAAAAAC6EwAAAAAAALwTAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAahQAAAAAAAC2EwAAAAAAAAAAAAAAAPC/"
				],
				[
					597,
					1,
					"paste",
					null,
					"AgAAAEMbAAAAAAAASBsAAAAAAAAAAAAASBsAAAAAAABIGwAAAAAAAAYAAABsaW5lKCk",
					"AQAAAAAAAAABAAAASRsAAAAAAABDGwAAAAAAAAAAAAAAAPC/"
				],
				[
					600,
					1,
					"paste",
					null,
					"AgAAADIcAAAAAAAANxwAAAAAAAAAAAAANxwAAAAAAAA3HAAAAAAAAAYAAABsaW5lKCk",
					"AQAAAAAAAAABAAAAOBwAAAAAAAAyHAAAAAAAAAAAAAAAAPC/"
				],
				[
					603,
					1,
					"insert",
					{
						"characters": "\nfm"
					},
					"BAAAAFAcAAAAAAAAURwAAAAAAAAAAAAAURwAAAAAAABZHAAAAAAAAAAAAABZHAAAAAAAAFocAAAAAAAAAAAAAFocAAAAAAAAWxwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAUBwAAAAAAABQHAAAAAAAAAAAAAAAAPC/"
				],
				[
					604,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAAFscAAAAAAAAXBwAAAAAAAAAAAAAXBwAAAAAAABdHAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWxwAAAAAAABbHAAAAAAAAAAAAAAAAPC/"
				],
				[
					605,
					1,
					"insert",
					{
						"characters": " QfontM"
					},
					"BwAAAF0cAAAAAAAAXhwAAAAAAAAAAAAAXhwAAAAAAABfHAAAAAAAAAAAAABfHAAAAAAAAGAcAAAAAAAAAAAAAGAcAAAAAAAAYRwAAAAAAAAAAAAAYRwAAAAAAABiHAAAAAAAAAAAAABiHAAAAAAAAGMcAAAAAAAAAAAAAGMcAAAAAAAAZBwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAXRwAAAAAAABdHAAAAAAAAAAAAAAAAPC/"
				],
				[
					606,
					1,
					"insert_completion",
					{
						"completion": "lsp_select_completion {\"index\":1,\"session_name\":\"LSP-pyright\"}",
						"format": "command",
						"keep_prefix": false,
						"must_insert": false,
						"trigger": "QFontMetrics"
					},
					"AgAAAF4cAAAAAAAAXhwAAAAAAAAGAAAAUWZvbnRNXhwAAAAAAABqHAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAZBwAAAAAAABkHAAAAAAAAAAAAAAAAPC/"
				],
				[
					607,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAGocAAAAAAAAbBwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAahwAAAAAAABqHAAAAAAAAAAAAAAAAPC/"
				],
				[
					608,
					1,
					"insert",
					{
						"characters": "self.fon"
					},
					"CAAAAGscAAAAAAAAbBwAAAAAAAAAAAAAbBwAAAAAAABtHAAAAAAAAAAAAABtHAAAAAAAAG4cAAAAAAAAAAAAAG4cAAAAAAAAbxwAAAAAAAAAAAAAbxwAAAAAAABwHAAAAAAAAAAAAABwHAAAAAAAAHEcAAAAAAAAAAAAAHEcAAAAAAAAchwAAAAAAAAAAAAAchwAAAAAAABzHAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAaxwAAAAAAABrHAAAAAAAAAAAAAAAAPC/"
				],
				[
					609,
					1,
					"insert",
					{
						"characters": "t"
					},
					"AQAAAHMcAAAAAAAAdBwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcxwAAAAAAABzHAAAAAAAAAAAAAAAAPC/"
				],
				[
					610,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAHQcAAAAAAAAdhwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAdBwAAAAAAAB0HAAAAAAAAAAAAAAAAPC/"
				],
				[
					613,
					1,
					"left_delete",
					null,
					"AQAAAHgcAAAAAAAAeBwAAAAAAACcAAAAICAgICAgICB0cnk6CiAgICAgICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuc2NlbmUoKS5mb250KCkpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICBmbSA9IFFGb250TWV0cmljcyhRQXBwbGljYXRpb24uaW5zdGFuY2UoKS5mb250KCkp",
					"AQAAAAAAAAABAAAAFB0AAAAAAAB4HAAAAAAAAAAAAAAAAPC/"
				],
				[
					614,
					1,
					"right_delete",
					null,
					"AQAAAHgcAAAAAAAAeBwAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAAeBwAAAAAAAB4HAAAAAAAAAAAAAAAAPC/"
				],
				[
					617,
					1,
					"paste",
					null,
					"AgAAALocAAAAAAAAvxwAAAAAAAAAAAAAvxwAAAAAAAC/HAAAAAAAAAYAAABsaW5lKCk",
					"AQAAAAAAAAABAAAAwBwAAAAAAAC6HAAAAAAAAAAAAAAAAPC/"
				],
				[
					623,
					1,
					"paste",
					null,
					"BAAAAKcdAAAAAAAArB0AAAAAAAAAAAAArB0AAAAAAACsHQAAAAAAAAYAAABsaW5lKCmBHQAAAAAAAIYdAAAAAAAAAAAAAIYdAAAAAAAAhh0AAAAAAAAGAAAAbGluZSgp",
					"AQAAAAAAAAACAAAAgR0AAAAAAACHHQAAAAAAAAAAAAAAAPC/px0AAAAAAACtHQAAAAAAAAAAAAAAAPC/"
				],
				[
					630,
					1,
					"left_delete",
					null,
					"AQAAAPUeAAAAAAAA9R4AAAAAAABcAAAAICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKFFBcHBsaWNhdGlvbi5pbnN0YW5jZSgpLmZvbnQoKSk",
					"AQAAAAAAAAABAAAAUR8AAAAAAAD1HgAAAAAAAAAAAAAAAPC/"
				],
				[
					633,
					1,
					"left_delete",
					null,
					"AQAAALUeAAAAAAAAtR4AAAAAAAAMAAAAICAgICAgICB0cnk6",
					"AQAAAAAAAAABAAAAwR4AAAAAAAC1HgAAAAAAAAAAAAAAAPC/"
				],
				[
					636,
					1,
					"right_delete",
					null,
					"AQAAAMIeAAAAAAAAwh4AAAAAAAABAAAAZg",
					"AQAAAAAAAAABAAAAwh4AAAAAAADCHgAAAAAAAAAAAAAAAPC/"
				],
				[
					637,
					1,
					"left_delete",
					null,
					"AQAAAL4eAAAAAAAAvh4AAAAAAAAEAAAAICAgIA",
					"AQAAAAAAAAABAAAAwh4AAAAAAADCHgAAAAAAAAAAAAAAAPC/"
				],
				[
					638,
					1,
					"insert",
					{
						"characters": "f"
					},
					"AQAAAL4eAAAAAAAAvx4AAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAvh4AAAAAAAC+HgAAAAAAAAAAAAAAAPC/"
				],
				[
					644,
					3,
					"right_delete",
					null,
					"AwAAANUeAAAAAAAA1R4AAAAAAAAFAAAAc2NlbmXVHgAAAAAAANUeAAAAAAAAAQAAACjVHgAAAAAAANUeAAAAAAAAAQAAACk",
					"AQAAAAAAAAABAAAA1R4AAAAAAADaHgAAAAAAAAAAAAAAAPC/"
				],
				[
					645,
					1,
					"left_delete",
					null,
					"AQAAANQeAAAAAAAA1B4AAAAAAAABAAAALg",
					"AQAAAAAAAAABAAAA1R4AAAAAAADVHgAAAAAAAAAAAAAAAPC/"
				],
				[
					650,
					1,
					"left_delete",
					null,
					"AQAAALQeAAAAAAAAtB4AAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAAtR4AAAAAAAC1HgAAAAAAAAAAAAAAAPC/"
				],
				[
					653,
					1,
					"left_delete",
					null,
					"AQAAANweAAAAAAAA3B4AAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAA3R4AAAAAAADdHgAAAAAAAAAAAAAAAPC/"
				],
				[
					656,
					1,
					"paste",
					null,
					"AgAAAJUfAAAAAAAAmh8AAAAAAAAAAAAAmh8AAAAAAACaHwAAAAAAAAYAAABsaW5lKCk",
					"AQAAAAAAAAABAAAAmx8AAAAAAACVHwAAAAAAAAAAAAAAAPC/"
				],
				[
					668,
					1,
					"paste",
					null,
					"AgAAAHMiAAAAAAAAzSIAAAAAAAAAAAAAzSIAAAAAAADNIgAAAAAAABIAAABzZWxmLnNldExpbmUobGluZSk",
					"AQAAAAAAAAABAAAAhSIAAAAAAABzIgAAAAAAAAAAAAAAAPC/"
				],
				[
					671,
					1,
					"toggle_comment",
					{
						"block": false
					},
					"AwAAALoiAAAAAAAAuiIAAAAAAAACAAAAIyCeIgAAAAAAAJ4iAAAAAAAAAgAAACMgdyIAAAAAAAB3IgAAAAAAAAIAAAAjIA",
					"AQAAAAAAAAABAAAAzSIAAAAAAABrIgAAAAAAAAAAAAAAAPC/"
				],
				[
					673,
					2,
					"left_delete",
					null,
					"AgAAAHciAAAAAAAAdyIAAAAAAAAEAAAAICAgIHMiAAAAAAAAcyIAAAAAAAAEAAAAICAgIA",
					"AQAAAAAAAAABAAAAeyIAAAAAAAB7IgAAAAAAAAAAAAAAAPC/"
				],
				[
					677,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAjDIAAAAAAACMMgAAIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCiMgUUdyYXBoaWNzSXRlbSBzaGFwZXMuIHB1cmVseSB2aXN1YWwsIGJ1dCBpbnRlcmFjdGl2ZS4KIyB0aGVzIGFyZSB0aGUgc3VwZXJjbGFzcyBvZiB0aGUgTW9kZWxWaWV3IFdpZGdldHMgZm9yIHRoZSBOWEdyYXBoU2NlbmUKIyB0aGVyIGFyZSBubyBzdXBwb3NlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBtb2RlbCBpbiBhbnkgd2F5CiMgcmVzcG9uc2libGUgdG8gcGFpbnQgdWkgaXRlbXMsCiMgYW5kIGNhbiByZWFjdCB0byBtb3VzZSBvciBrZXlib2FyZCBldmVudCwgc3RyaWN0bHkgaW4gYSB2b3N1YWwgd2F5LgojIGluIE1WQyB0aGVzZSB3b3VsZCBiZSB0aGUgdmlld3MuCiMgaW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoZXNlIGFyZSBzZWxmIGNvbnRhaW5lZCB3aWRnZXRzLAojIHRoYXQgY2FuIGJlIHVzZWQgYnkgdGhlICdWaWV3cycKCgpmcm9tIHR5cGluZyBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRHdWkgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0Q29yZSBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRXaWRnZXRzIGltcG9ydCAqCgpmcm9tIHB5bGl2ZS5RdEdyYXBoRWRpdG9yLnFncmFwaGljc19hcnJvd19pdGVtIGltcG9ydCAoCiAgICBtYWtlQXJyb3dTaGFwZSwKKQpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IG1ha2VMaW5lQmV0d2VlblNoYXBlcwoKCmNsYXNzIEFic3RyYWN0U2hhcGUoUUdyYXBoaWNzSXRlbSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLnNldEZsYWcoUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUpCiAgICAgICAgc2VsZi5zZXRBY2NlcHRIb3ZlckV2ZW50cyhUcnVlKQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQgPSBGYWxzZQogICAgICAgIHNlbGYuX2hvdmVyTW91c2VQb3M6IFFQb2ludEYgfCBOb25lID0gTm9uZQoKICAgIGRlZiBzZXRIaWdobGlnaHRlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgc2VsZi5faXNIaWdobGlnaHRlZCA9IHZhbHVlCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBpc0hpZ2hsaWdodGVkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9pc0hpZ2hsaWdodGVkCgogICAgZGVmIGhvdmVyRW50ZXJFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVIb3ZlckV2ZW50KToKICAgICAgICBzZWxmLnNldEhpZ2hsaWdodGVkKFRydWUpCgogICAgZGVmIGhvdmVyTW92ZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZUhvdmVyRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5faG92ZXJNb3VzZVBvcyA9IGV2ZW50LnBvcygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBob3ZlckxlYXZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lSG92ZXJFdmVudCk6CiAgICAgICAgc2VsZi5zZXRIaWdobGlnaHRlZChGYWxzZSkKCiAgICBkZWYgZm9udChzZWxmKToKICAgICAgICBpZiBmb250IDo9IGdldGF0dHIoc2VsZiwgIl9mb250IiwgTm9uZSk6CiAgICAgICAgICAgIHJldHVybiBmb250CiAgICAgICAgZWxpZiBwYXJlbnRXaWRnZXQgOj0gc2VsZi5wYXJlbnRXaWRnZXQoKToKICAgICAgICAgICAgcmV0dXJuIHBhcmVudFdpZGdldC5mb250KCkKICAgICAgICBlbGlmIHNjZW5lIDo9IHNlbGYuc2NlbmUoKToKICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmZvbnQoKQogICAgICAgIGVsaWYgYXBwIDo9IFFBcHBsaWNhdGlvbi5pbnN0YW5jZSgpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFwcCwgUUd1aUFwcGxpY2F0aW9uKToKICAgICAgICAgICAgICAgIHJldHVybiBhcHAuZm9udCgpCgogICAgICAgIHJldHVybiBRRm9udCgpCgogICAgZGVmIHBhbGV0dGUoc2VsZikgLT4gUVBhbGV0dGU6CiAgICAgICAgaWYgcGFsZXR0ZSA6PSBnZXRhdHRyKHNlbGYsICJfcGFsZXR0ZSIsIE5vbmUpOgogICAgICAgICAgICByZXR1cm4gcGFsZXR0ZQogICAgICAgIGVsaWYgcGFyZW50V2lkZ2V0IDo9IHNlbGYucGFyZW50V2lkZ2V0KCk6CiAgICAgICAgICAgIHJldHVybiBwYXJlbnRXaWRnZXQucGFsZXR0ZSgpCiAgICAgICAgZWxpZiBzY2VuZSA6PSBzZWxmLnNjZW5lKCk6CiAgICAgICAgICAgIHJldHVybiBzY2VuZS5wYWxldHRlKCkKICAgICAgICBlbGlmIGFwcCA6PSBRQXBwbGljYXRpb24uaW5zdGFuY2UoKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhcHAsIFFHdWlBcHBsaWNhdGlvbik6CiAgICAgICAgICAgICAgICByZXR1cm4gYXBwLnBhbGV0dGUoKQoKICAgICAgICByZXR1cm4gUVBhbGV0dGUoKQoKICAgIGRlZiBicnVzaChzZWxmKToKICAgICAgICBiYXNlQ29sb3IgPSBzZWxmLnBhbGV0dGUoKS5iYXNlKCkuY29sb3IoKQogICAgICAgIGJhc2VDb2xvci5zZXRBbHBoYSgyNTUpCiAgICAgICAgYnJ1c2ggPSBRQnJ1c2goYmFzZUNvbG9yKQogICAgICAgIHJldHVybiBicnVzaAoKICAgIGRlZiBwZW4oc2VsZik6CiAgICAgICAgcGFsZXR0ZSA9IHNlbGYucGFsZXR0ZSgpCgogICAgICAgIHBlbiA9IFFQZW4ocGFsZXR0ZS50ZXh0KCkuY29sb3IoKSkKCiAgICAgICAgaWYgc2VsZi5pc1NlbGVjdGVkKCk6CiAgICAgICAgICAgIHBlbi5zZXRDb2xvcihwYWxldHRlLmhpZ2hsaWdodCgpLmNvbG9yKCkpICAjIENvbG9yIGZvciBzZWxlY3RlZAoKICAgICAgICBpZiBzZWxmLmlzSGlnaGxpZ2h0ZWQoKToKICAgICAgICAgICAgcGVuLnNldENvbG9yKHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkgICMgQ29sb3IgZm9yIGhvdmVyCgogICAgICAgIHJldHVybiBwZW4KCgpjbGFzcyBWZXJ0ZXhTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkEgZ3JhcGggJ1ZlcnRleCcgZ3JhcGhpY3MgaXRlbS4gbm8gaW5sZXRzIG9yIG91dGxldHMuIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgdGl0bGU6IHN0ciA9ICJOb2RlIiwKICAgICAgICBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhwYXJlbnQpCiAgICAgICAgIyBwcml2YXRlIHZhcmlhYmxlcwogICAgICAgIHNlbGYuX3RpdGxlOiBzdHIgPSB0aXRsZQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQ6IGJvb2wgPSBGYWxzZQoKICAgICAgICAjIEVuYWJsZSBzZWxlY3Rpb24gYW5kIG1vdmVtZW50CiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc01vdmFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc0ZvY3VzYWJsZSwgVHJ1ZSkKICAgICAgICBzZWxmLnNldEZsYWcoCiAgICAgICAgICAgIFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtU2VuZHNTY2VuZVBvc2l0aW9uQ2hhbmdlcwogICAgICAgICkKICAgICAgICBzZWxmLnNldEFjY2VwdEhvdmVyRXZlbnRzKFRydWUpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmIntzZWxmLl9fY2xhc3NfXy5fX25hbWVfX30oe3NlbGYuX3RpdGxlIXJ9KSIKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYmFzZUNvbG9yID0gc2VsZi5wYWxldHRlKCkuYmFzZSgpLmNvbG9yKCkKICAgICAgICBiYXNlQ29sb3Iuc2V0QWxwaGEoMjAwKQogICAgICAgIGJydXNoID0gUUJydXNoKGJhc2VDb2xvcikKICAgICAgICByZXR1cm4gYnJ1c2gKCiAgICBAb3ZlcnJpZGUKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQoKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fdGl0bGUpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHJldHVybiBRUmVjdEYoMCwgMCwgdGV4dF93aWR0aCArIDgsIHRleHRfaGVpZ2h0ICsgNCkKCiAgICBkZWYgcGFpbnQoCiAgICAgICAgc2VsZiwgcGFpbnRlcjogUVBhaW50ZXIsIG9wdGlvbjogUVN0eWxlT3B0aW9uR3JhcGhpY3NJdGVtLCB3aWRnZXQ9Tm9uZQogICAgKToKICAgICAgICBwYWludGVyLnNldEJydXNoKHNlbGYuYnJ1c2goKSkKICAgICAgICBwYWludGVyLnNldFBlbihzZWxmLnBlbigpKQogICAgICAgIHBhaW50ZXIuZHJhd1JvdW5kZWRSZWN0KHNlbGYuYm91bmRpbmdSZWN0KCksIDQsIDQpCgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQoNCwgZm0uaGVpZ2h0KCkgLSAxLCBzZWxmLl90aXRsZSkKCiAgICBkZWYgdGl0bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3RpdGxlCgogICAgZGVmIHNldFRpdGxlKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fdGl0bGUgPSB0ZXh0CiAgICAgICAgc2VsZi51cGRhdGUoKQoKCmNsYXNzIExpbmtTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkdyYXBoaWNzIGl0ZW0gcmVwcmVzZW50aW5nIGFuIGVkZ2UgaW4gYSBncmFwaC4iIiIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwgbGFiZWw6IHN0ciA9ICItbGluay0iLCBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZQogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1Ob25lKQogICAgICAgIHNlbGYuX2xhYmVsID0gbGFiZWwKCiAgICAgICAgIyBFbmFibGUgc2VsZWN0aW5nCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtSXNTZWxlY3RhYmxlKQogICAgICAgIHNlbGYuc2V0QWNjZXB0SG92ZXJFdmVudHMoVHJ1ZSkKICAgICAgICAjIHNlbGYuc2V0WlZhbHVlKC0xKQoKICAgICAgICBzZWxmLl9saW5lOiBRTGluZUYgPSBRTGluZUYoKQoKICAgICMgZGVmIHNldExpbmUoc2VsZiwgbGluZTogUUxpbmVGKToKICAgICMgICAgIHNlbGYucHJlcGFyZUdlb21ldHJ5Q2hhbmdlKCkKICAgICMgICAgIHNlbGYuX2xpbmUgPSBsaW5lCiAgICAjICAgICBzZWxmLnVwZGF0ZSgpCgogICAgIyBkZWYgX2xpbmUoc2VsZikgLT4gUUxpbmVGOgogICAgIyAgICAgcmV0dXJuIHNlbGYuX2xpbmUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYie3NlbGYuX19jbGFzc19fLl9fbmFtZV9ffSh7c2VsZi5fbGFiZWwhcn0pIgoKICAgIGRlZiBzZXRMYWJlbFRleHQoc2VsZiwgdGV4dDogc3RyKToKICAgICAgICBzZWxmLl9sYWJlbCA9IHRleHQKICAgICAgICBzZWxmLnVwZGF0ZSgpCgogICAgZGVmIGxhYmVsVGV4dChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbGFiZWwKCiAgICBkZWYgcGVuKHNlbGYpOgogICAgICAgICIiIm92ZXJyaWRlIHRvIGluZGljYXRlIGVuZHBvaW50cyB1bmRlciBtb3VzZSIiIgogICAgICAgIHBhbGV0dGUgPSBzZWxmLnBhbGV0dGUoKQoKICAgICAgICBwZW4gPSBRUGVuKHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCgogICAgICAgIGlmIHNlbGYuaXNTZWxlY3RlZCgpOgogICAgICAgICAgICBwZW4uc2V0Q29sb3IocGFsZXR0ZS5oaWdobGlnaHQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3Igc2VsZWN0ZWQKCiAgICAgICAgaWYgc2VsZi5pc0hpZ2hsaWdodGVkKCk6CiAgICAgICAgICAgIGlmIHNlbGYuX2hvdmVyTW91c2VQb3M6CiAgICAgICAgICAgICAgICBsaW5lYXJHcmFkID0gUUxpbmVhckdyYWRpZW50KHNlbGYuX2xpbmUucDEoKSwgc2VsZi5fbGluZS5wMigpKQogICAgICAgICAgICAgICAgZDEgPSBRTGluZUYoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXBGcm9tUGFyZW50KHNlbGYuX2xpbmUucDEoKSksIHNlbGYuX2hvdmVyTW91c2VQb3MKICAgICAgICAgICAgICAgICkubGVuZ3RoKCkKICAgICAgICAgICAgICAgIGQyID0gUUxpbmVGKAogICAgICAgICAgICAgICAgICAgIHNlbGYubWFwRnJvbVBhcmVudChzZWxmLl9saW5lLnAyKCkpLCBzZWxmLl9ob3Zlck1vdXNlUG9zCiAgICAgICAgICAgICAgICApLmxlbmd0aCgpCiAgICAgICAgICAgICAgICBpZiBkMSA8IGQyOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjAsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMC41LCBwYWxldHRlLmFjY2VudCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICAgICAgbGluZWFyR3JhZC5zZXRDb2xvckF0KDAuNTUsIHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjQ1LCBwYWxldHRlLnRleHQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjUsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMSwgcGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgcGVuLnNldEJydXNoKFFCcnVzaChsaW5lYXJHcmFkKSkgICMgQ29sb3IgZm9yIGhvdmVyCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwZW4uc2V0QnJ1c2gocGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3IgaG92ZXIKCiAgICAgICAgcmV0dXJuIHBlbgoKICAgIGRlZiBwYWludCgKICAgICAgICBzZWxmLCBwYWludGVyOiBRUGFpbnRlciwgb3B0aW9uOiBRU3R5bGVPcHRpb25HcmFwaGljc0l0ZW0sIHdpZGdldD1Ob25lCiAgICApOgogICAgICAgICMjIyBkcmF3IGFycm93IHNoYXBlCiAgICAgICAgYXJyb3dfc2hhcGUgPSBtYWtlQXJyb3dTaGFwZShzZWxmLl9saW5lLCBzZWxmLnBlbigpLndpZHRoRigpKQoKICAgICAgICAjIHVzZSB0aGUgcGVuIGFzIGJydXNoIHRvIGRyYXcgdGhlIGFycm93IHNoYXBlCiAgICAgICAgcGFpbnRlci5zZXRQZW4oUXQuUGVuU3R5bGUuTm9QZW4pCiAgICAgICAgcGFpbnRlci5zZXRCcnVzaChzZWxmLnBlbigpLmJydXNoKCkpCiAgICAgICAgcGFpbnRlci5kcmF3UGF0aChhcnJvd19zaGFwZSkKICAgICAgICBwYWludGVyLmRyYXdMaW5lKHNlbGYuX2xpbmUpCgogICAgICAgICMjIyBkcmF3IGxhYmVsCiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3VGV4dChzZWxmLl9saW5lLmNlbnRlcigpIC0gc2VsZi5wb3MoKSwgc2VsZi5fbGFiZWwpCgogICAgZGVmIHNoYXBlKHNlbGYpIC0+IFFQYWludGVyUGF0aDoKICAgICAgICAiIiJPdmVycmlkZSBzaGFwZSB0byBwcm92aWRlIGEgd2lkZXIgY2xpY2thYmxlIGFyZWEuIiIiCiAgICAgICAgcGF0aCA9IFFQYWludGVyUGF0aCgpCiAgICAgICAgcGF0aC5tb3ZlVG8oc2VsZi5fbGluZS5wMSgpKQogICAgICAgIHBhdGgubGluZVRvKHNlbGYuX2xpbmUucDIoKSkKICAgICAgICBzdHJva2VyID0gUVBhaW50ZXJQYXRoU3Ryb2tlcigpCiAgICAgICAgc3Ryb2tlci5zZXRXaWR0aCgxMCkKICAgICAgICBzdHJva2VyLnNldENhcFN0eWxlKFF0LlBlbkNhcFN0eWxlLlJvdW5kQ2FwKQogICAgICAgIHN0cm9rZXIuc2V0Sm9pblN0eWxlKFF0LlBlbkpvaW5TdHlsZS5Sb3VuZEpvaW4pCiAgICAgICAgcmV0dXJuIHN0cm9rZXIuY3JlYXRlU3Ryb2tlKHBhdGgpCgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHRleHRfd2lkdGggPSBmbS5ob3Jpem9udGFsQWR2YW5jZShzZWxmLl9sYWJlbCkKICAgICAgICB0ZXh0X2hlaWdodCA9IGZtLmhlaWdodCgpCgogICAgICAgIHNoYXBlX2Jib3ggPSBzZWxmLnNoYXBlKCkuYm91bmRpbmdSZWN0KCkKICAgICAgICB0ZXh0X2Jib3ggPSBRUmVjdEYoCiAgICAgICAgICAgIHNlbGYuX2xpbmUuY2VudGVyKCkgLSBzZWxmLnBvcygpIC0gUVBvaW50RigwLCB0ZXh0X2hlaWdodCksCiAgICAgICAgICAgIFFTaXplRih0ZXh0X3dpZHRoLCB0ZXh0X2hlaWdodCksCiAgICAgICAgKQoKICAgICAgICBtID0gc2VsZi5wZW4oKS53aWR0aEYoKQogICAgICAgIHJldHVybiBzaGFwZV9iYm94LnVuaXRlZCh0ZXh0X2Jib3gpLmFkanVzdGVkKC1tLCAtbSwgbSwgbSkKCiAgICBkZWYgbW92ZSgKICAgICAgICBzZWxmLAogICAgICAgIHNvdXJjZV9ncmFwaGljc19pdGVtOiBRR3JhcGhpY3NJdGVtIHwgUVBhaW50ZXJQYXRoIHwgUVJlY3RGIHwgUVBvaW50RiwKICAgICAgICB0YXJnZXRfZ3JhcGhpY3NfaXRlbTogUUdyYXBoaWNzSXRlbSB8IFFQYWludGVyUGF0aCB8IFFSZWN0RiB8IFFQb2ludEYsCiAgICApOgogICAgICAgIGxpbmUgPSBtYWtlTGluZUJldHdlZW5TaGFwZXMoc291cmNlX2dyYXBoaWNzX2l0ZW0sIHRhcmdldF9ncmFwaGljc19pdGVtKQogICAgICAgIGxlbmd0aCA9IGxpbmUubGVuZ3RoKCkKICAgICAgICBpZiBsZW5ndGggPiAwOgogICAgICAgICAgICBvZmZzZXQgPSBtaW4oOCwgbGVuZ3RoIC8gMikKICAgICAgICAgICAgbGluZSA9IFFMaW5lRigKICAgICAgICAgICAgICAgIGxpbmUucG9pbnRBdChvZmZzZXQgLyBsZW5ndGgpLAogICAgICAgICAgICAgICAgbGluZS5wb2ludEF0KChsZW5ndGggLSBvZmZzZXQpIC8gbGVuZ3RoKSwKICAgICAgICAgICAgKQoKICAgICAgICBzZWxmLnByZXBhcmVHZW9tZXRyeUNoYW5nZSgpCiAgICAgICAgc2VsZi5fbGluZSA9IGxpbmUKICAgICAgICBzZWxmLnVwZGF0ZSgpCgoKY2xhc3MgTm9kZVNoYXBlKFZlcnRleFNoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0aXRsZSwgaW5sZXRzLCBvdXRsZXRzLCBwYXJlbnQ9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyh0aXRsZT10aXRsZSwgcGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9pbmxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYuX291dGxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYucG9ydHNfbWFyZ2luID0gLTUKCiAgICAgICAgZm9yIGlubGV0IGluIGlubGV0czoKICAgICAgICAgICAgc2VsZi5fYWRkSW5sZXQoaW5sZXQpCiAgICAgICAgZm9yIG91dGxldCBpbiBvdXRsZXRzOgogICAgICAgICAgICBzZWxmLl9hZGRPdXRsZXQob3V0bGV0KQoKICAgICAgICBzZWxmLnBvcnRzX21hcmdpbiA9IC00MAoKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIHN1cGVyKCkKICAgICAgICAgICAgLmJvdW5kaW5nUmVjdCgpCiAgICAgICAgICAgIC51bml0ZWQoc2VsZi5jaGlsZHJlbkJvdW5kaW5nUmVjdCgpKQogICAgICAgICAgICAuYWRqdXN0ZWQoLTQsIDAsIDQsIDIpCiAgICAgICAgKQoKICAgIGRlZiBfYWRkSW5sZXQoc2VsZiwgaW5sZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBpbmxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIHNlbGYuX2lubGV0cy5hcHBlbmQoaW5sZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX3JlbW92ZUlubGV0KHNlbGYsIGlubGV0X3dpZGdldDogUUdyYXBoaWNzSXRlbSk6CiAgICAgICAgc2VsZi5faW5sZXRzLnJlbW92ZShpbmxldF93aWRnZXQpCiAgICAgICAgaW5sZXRfd2lkZ2V0LnNldFBhcmVudEl0ZW0oTm9uZSkKICAgICAgICBpZiBzY2VuZSA6PSBpbmxldF93aWRnZXQuc2NlbmUoKToKICAgICAgICAgICAgc2NlbmUucmVtb3ZlSXRlbShpbmxldF93aWRnZXQpCiAgICAgICAgc2VsZi5sYXlvdXRQb3J0cygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBfYWRkT3V0bGV0KHNlbGYsIG91dGxldF93aWRnZXQ6IFFHcmFwaGljc0l0ZW0pOgogICAgICAgIG91dGxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIHNlbGYuX291dGxldHMuYXBwZW5kKG91dGxldF93aWRnZXQpCiAgICAgICAgc2VsZi5sYXlvdXRQb3J0cygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBfcmVtb3ZlT3V0bGV0KHNlbGYsIG91dGxldF93aWRnZXQ6IFFHcmFwaGljc0l0ZW0pOgogICAgICAgIHNlbGYuX291dGxldHMucmVtb3ZlKG91dGxldF93aWRnZXQpCiAgICAgICAgb3V0bGV0X3dpZGdldC5zZXRQYXJlbnRJdGVtKHNlbGYpCiAgICAgICAgaWYgc2NlbmUgOj0gb3V0bGV0X3dpZGdldC5zY2VuZSgpOgogICAgICAgICAgICBzY2VuZS5yZW1vdmVJdGVtKG91dGxldF93aWRnZXQpCiAgICAgICAgc2VsZi5sYXlvdXRQb3J0cygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBsYXlvdXRQb3J0cyhzZWxmKToKICAgICAgICB5ID0gMTQgICMgaGVhZGVyIGhlaWdobgogICAgICAgIGZvciBpbmxldF93aWRnZXQgaW4gc2VsZi5faW5sZXRzOgogICAgICAgICAgICBpbmxldF93aWRnZXQuc2V0UG9zKDQsIHkpCiAgICAgICAgICAgIHkgKz0gaW5sZXRfd2lkZ2V0LmJvdW5kaW5nUmVjdCgpLmhlaWdodCgpCgogICAgICAgIGZvciBvdXRsZXRfd2lkZ2V0IGluIHNlbGYuX291dGxldHM6CiAgICAgICAgICAgIG91dGxldF93aWRnZXQuc2V0UG9zKDQsIHkpCiAgICAgICAgICAgIHkgKz0gb3V0bGV0X3dpZGdldC5ib3VuZGluZ1JlY3QoKS5oZWlnaHQoKQoKCmNsYXNzIFBvcnRTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIGxhYmVsOiBzdHIsCiAgICAgICAgcGFyZW50OiBRR3JhcGhpY3NJdGVtIHwgTm9uZSA9IE5vbmUsCiAgICApOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9sYWJlbCA9IGxhYmVsCgogICAgZGVmIGxhYmVsKHNlbGYpIC0+IHN0cjoKICAgICAgICByZXR1cm4gc2VsZi5fbGFiZWwKCiAgICBkZWYgc2V0TGFiZWwoc2VsZiwgdGV4dDogc3RyKToKICAgICAgICBzZWxmLl9sYWJlbCA9IHRleHQKCiAgICBkZWYgYm91bmRpbmdSZWN0KHNlbGYpIC0+IFFSZWN0RjoKICAgICAgICBmbSA9IFFGb250TWV0cmljcyhzZWxmLmZvbnQoKSkKCiAgICAgICAgZWxsaXBzZV9iYm94ID0gUVJlY3RGKDAsIDAsIDEwLCAxMCkKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fbGFiZWwpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQoKICAgICAgICB0ZXh0X3BvcyA9IFFQb2ludEYoMTIsIDApCiAgICAgICAgdGV4dF9iYm94ID0gUVJlY3RGKHRleHRfcG9zLCBRU2l6ZUYodGV4dF93aWR0aCwgdGV4dF9oZWlnaHQpKQogICAgICAgIHJldHVybiBlbGxpcHNlX2Jib3gudW5pdGVkKHRleHRfYmJveCkKCiAgICBkZWYgcGFpbnQoc2VsZiwgcGFpbnRlciwgb3B0aW9uLCB3aWRnZXQ9Tm9uZSk6CiAgICAgICAgIyMjIGRyYXcgbGFiZWwKICAgICAgICBmbSA9IFFGb250TWV0cmljcyhzZWxmLmZvbnQoKSkKCiAgICAgICAgcGFpbnRlci5zZXRCcnVzaChzZWxmLmJydXNoKCkpCiAgICAgICAgcGFpbnRlci5zZXRQZW4oc2VsZi5wZW4oKSkKICAgICAgICBwYWludGVyLmRyYXdFbGxpcHNlKFFSZWN0RigyLCA3LCA2LCA2KSkKCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHRleHRfcG9zID0gUVBvaW50RigxMiwgdGV4dF9oZWlnaHQgLSAyKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQodGV4dF9wb3MsIHNlbGYuX2xhYmVsKQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpbXBvcnQgc3lzCgogICAgYXBwID0gUUFwcGxpY2F0aW9uKHN5cy5hcmd2KQoKICAgIGdyYXBodmlldyA9IFFHcmFwaGljc1ZpZXcoKQogICAgZ3JhcGh2aWV3LnNldFdpbmRvd1RpdGxlKCJIcmFwaGljc0l0ZW0gZm9yIE5vZGVFZGl0b3IiKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5BbnRpYWxpYXNpbmcsIFRydWUpCiAgICBncmFwaHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlRleHRBbnRpYWxpYXNpbmcsIFRydWUpCiAgICBncmFwaHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlNtb290aFBpeG1hcFRyYW5zZm9ybSwgVHJ1ZSkKCiAgICAjIGNyZWF0ZSBncmFwaCBzY2VuZQogICAgZ3JhcGhzY2VuZSA9IFFHcmFwaGljc1NjZW5lKCkKICAgIGdyYXBoc2NlbmUuc2V0U2NlbmVSZWN0KFFSZWN0RigtNDAwLCAtNDAwLCA4MDAsIDgwMCkpCiAgICBncmFwaHZpZXcuc2V0U2NlbmUoZ3JhcGhzY2VuZSkKCiAgICAjIyBjcmVhdGUgZ3JhcGhpY3MKICAgIHZlcnRleF9pdGVtXzEgPSBWZXJ0ZXhTaGFwZSgiR3JhcGhpY3NWZXJ0ZXhJdGVtMSIpCiAgICBncmFwaHNjZW5lLmFkZEl0ZW0odmVydGV4X2l0ZW1fMSkKICAgIHZlcnRleF9pdGVtXzEuc2V0UG9zKDAsIC0xNTApCgogICAgbm9kZV9pdGVtXzEgPSBOb2RlU2hhcGUoCiAgICAgICAgIkdyYXBoaWNzTm9kZUl0ZW0xIiwKICAgICAgICBpbmxldHM9W1BvcnRTaGFwZSgiR3JhcGhpY3NQb3J0SXRlbW0iKV0sCiAgICAgICAgb3V0bGV0cz1bUG9ydFNoYXBlKCJHcmFwaGljc1BvcnRJdGVtIildLAogICAgKQogICAgZ3JhcGhzY2VuZS5hZGRJdGVtKG5vZGVfaXRlbV8xKQogICAgbm9kZV9pdGVtXzEuc2V0UG9zKDAsIC0xMjApCgogICAgbGlua19pdGVtXzEgPSBMaW5rU2hhcGUoImxpbmsxIikKICAgIGxpbmtfaXRlbV8xLnNldExpbmUoUUxpbmVGKDAwLCAtNTAsIDEwMCwgLTIwKSkKICAgIGdyYXBoc2NlbmUuYWRkSXRlbShsaW5rX2l0ZW1fMSkKCiAgICBncmFwaHZpZXcuc2hvdygpCiAgICBhcHAuZXhlYygpCg",
					"AQAAAAAAAAABAAAAqSIAAAAAAACpIgAAAAAAAAAAAAAAAPC/"
				],
				[
					679,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAjDIAAAAAAACMMgAAIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCiMgUUdyYXBoaWNzSXRlbSBzaGFwZXMuIHB1cmVseSB2aXN1YWwsIGJ1dCBpbnRlcmFjdGl2ZS4KIyB0aGVzIGFyZSB0aGUgc3VwZXJjbGFzcyBvZiB0aGUgTW9kZWxWaWV3IFdpZGdldHMgZm9yIHRoZSBOWEdyYXBoU2NlbmUKIyB0aGVyIGFyZSBubyBzdXBwb3NlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBtb2RlbCBpbiBhbnkgd2F5CiMgcmVzcG9uc2libGUgdG8gcGFpbnQgdWkgaXRlbXMsCiMgYW5kIGNhbiByZWFjdCB0byBtb3VzZSBvciBrZXlib2FyZCBldmVudCwgc3RyaWN0bHkgaW4gYSB2b3N1YWwgd2F5LgojIGluIE1WQyB0aGVzZSB3b3VsZCBiZSB0aGUgdmlld3MuCiMgaW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoZXNlIGFyZSBzZWxmIGNvbnRhaW5lZCB3aWRnZXRzLAojIHRoYXQgY2FuIGJlIHVzZWQgYnkgdGhlICdWaWV3cycKCgpmcm9tIHR5cGluZyBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRHdWkgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0Q29yZSBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRXaWRnZXRzIGltcG9ydCAqCgpmcm9tIHB5bGl2ZS5RdEdyYXBoRWRpdG9yLnFncmFwaGljc19hcnJvd19pdGVtIGltcG9ydCAoCiAgICBtYWtlQXJyb3dTaGFwZSwKKQpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IG1ha2VMaW5lQmV0d2VlblNoYXBlcwoKCmNsYXNzIEFic3RyYWN0U2hhcGUoUUdyYXBoaWNzSXRlbSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLnNldEZsYWcoUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUpCiAgICAgICAgc2VsZi5zZXRBY2NlcHRIb3ZlckV2ZW50cyhUcnVlKQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQgPSBGYWxzZQogICAgICAgIHNlbGYuX2hvdmVyTW91c2VQb3M6IFFQb2ludEYgfCBOb25lID0gTm9uZQoKICAgIGRlZiBzZXRIaWdobGlnaHRlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgc2VsZi5faXNIaWdobGlnaHRlZCA9IHZhbHVlCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBpc0hpZ2hsaWdodGVkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9pc0hpZ2hsaWdodGVkCgogICAgZGVmIGhvdmVyRW50ZXJFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVIb3ZlckV2ZW50KToKICAgICAgICBzZWxmLnNldEhpZ2hsaWdodGVkKFRydWUpCgogICAgZGVmIGhvdmVyTW92ZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZUhvdmVyRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5faG92ZXJNb3VzZVBvcyA9IGV2ZW50LnBvcygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBob3ZlckxlYXZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lSG92ZXJFdmVudCk6CiAgICAgICAgc2VsZi5zZXRIaWdobGlnaHRlZChGYWxzZSkKCiAgICBkZWYgZm9udChzZWxmKToKICAgICAgICBpZiBmb250IDo9IGdldGF0dHIoc2VsZiwgIl9mb250IiwgTm9uZSk6CiAgICAgICAgICAgIHJldHVybiBmb250CiAgICAgICAgZWxpZiBwYXJlbnRXaWRnZXQgOj0gc2VsZi5wYXJlbnRXaWRnZXQoKToKICAgICAgICAgICAgcmV0dXJuIHBhcmVudFdpZGdldC5mb250KCkKICAgICAgICBlbGlmIHNjZW5lIDo9IHNlbGYuc2NlbmUoKToKICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmZvbnQoKQogICAgICAgIGVsaWYgYXBwIDo9IFFBcHBsaWNhdGlvbi5pbnN0YW5jZSgpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFwcCwgUUd1aUFwcGxpY2F0aW9uKToKICAgICAgICAgICAgICAgIHJldHVybiBhcHAuZm9udCgpCgogICAgICAgIHJldHVybiBRRm9udCgpCgogICAgZGVmIHBhbGV0dGUoc2VsZikgLT4gUVBhbGV0dGU6CiAgICAgICAgaWYgcGFsZXR0ZSA6PSBnZXRhdHRyKHNlbGYsICJfcGFsZXR0ZSIsIE5vbmUpOgogICAgICAgICAgICByZXR1cm4gcGFsZXR0ZQogICAgICAgIGVsaWYgcGFyZW50V2lkZ2V0IDo9IHNlbGYucGFyZW50V2lkZ2V0KCk6CiAgICAgICAgICAgIHJldHVybiBwYXJlbnRXaWRnZXQucGFsZXR0ZSgpCiAgICAgICAgZWxpZiBzY2VuZSA6PSBzZWxmLnNjZW5lKCk6CiAgICAgICAgICAgIHJldHVybiBzY2VuZS5wYWxldHRlKCkKICAgICAgICBlbGlmIGFwcCA6PSBRQXBwbGljYXRpb24uaW5zdGFuY2UoKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhcHAsIFFHdWlBcHBsaWNhdGlvbik6CiAgICAgICAgICAgICAgICByZXR1cm4gYXBwLnBhbGV0dGUoKQoKICAgICAgICByZXR1cm4gUVBhbGV0dGUoKQoKICAgIGRlZiBicnVzaChzZWxmKToKICAgICAgICBiYXNlQ29sb3IgPSBzZWxmLnBhbGV0dGUoKS5iYXNlKCkuY29sb3IoKQogICAgICAgIGJhc2VDb2xvci5zZXRBbHBoYSgyNTUpCiAgICAgICAgYnJ1c2ggPSBRQnJ1c2goYmFzZUNvbG9yKQogICAgICAgIHJldHVybiBicnVzaAoKICAgIGRlZiBwZW4oc2VsZik6CiAgICAgICAgcGFsZXR0ZSA9IHNlbGYucGFsZXR0ZSgpCgogICAgICAgIHBlbiA9IFFQZW4ocGFsZXR0ZS50ZXh0KCkuY29sb3IoKSkKCiAgICAgICAgaWYgc2VsZi5pc1NlbGVjdGVkKCk6CiAgICAgICAgICAgIHBlbi5zZXRDb2xvcihwYWxldHRlLmhpZ2hsaWdodCgpLmNvbG9yKCkpICAjIENvbG9yIGZvciBzZWxlY3RlZAoKICAgICAgICBpZiBzZWxmLmlzSGlnaGxpZ2h0ZWQoKToKICAgICAgICAgICAgcGVuLnNldENvbG9yKHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkgICMgQ29sb3IgZm9yIGhvdmVyCgogICAgICAgIHJldHVybiBwZW4KCgpjbGFzcyBWZXJ0ZXhTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkEgZ3JhcGggJ1ZlcnRleCcgZ3JhcGhpY3MgaXRlbS4gbm8gaW5sZXRzIG9yIG91dGxldHMuIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgdGl0bGU6IHN0ciA9ICJOb2RlIiwKICAgICAgICBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhwYXJlbnQpCiAgICAgICAgIyBwcml2YXRlIHZhcmlhYmxlcwogICAgICAgIHNlbGYuX3RpdGxlOiBzdHIgPSB0aXRsZQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQ6IGJvb2wgPSBGYWxzZQoKICAgICAgICAjIEVuYWJsZSBzZWxlY3Rpb24gYW5kIG1vdmVtZW50CiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc01vdmFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc0ZvY3VzYWJsZSwgVHJ1ZSkKICAgICAgICBzZWxmLnNldEZsYWcoCiAgICAgICAgICAgIFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtU2VuZHNTY2VuZVBvc2l0aW9uQ2hhbmdlcwogICAgICAgICkKICAgICAgICBzZWxmLnNldEFjY2VwdEhvdmVyRXZlbnRzKFRydWUpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmIntzZWxmLl9fY2xhc3NfXy5fX25hbWVfX30oe3NlbGYuX3RpdGxlIXJ9KSIKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYmFzZUNvbG9yID0gc2VsZi5wYWxldHRlKCkuYmFzZSgpLmNvbG9yKCkKICAgICAgICBiYXNlQ29sb3Iuc2V0QWxwaGEoMjAwKQogICAgICAgIGJydXNoID0gUUJydXNoKGJhc2VDb2xvcikKICAgICAgICByZXR1cm4gYnJ1c2gKCiAgICBAb3ZlcnJpZGUKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQoKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fdGl0bGUpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHJldHVybiBRUmVjdEYoMCwgMCwgdGV4dF93aWR0aCArIDgsIHRleHRfaGVpZ2h0ICsgNCkKCiAgICBkZWYgcGFpbnQoCiAgICAgICAgc2VsZiwgcGFpbnRlcjogUVBhaW50ZXIsIG9wdGlvbjogUVN0eWxlT3B0aW9uR3JhcGhpY3NJdGVtLCB3aWRnZXQ9Tm9uZQogICAgKToKICAgICAgICBwYWludGVyLnNldEJydXNoKHNlbGYuYnJ1c2goKSkKICAgICAgICBwYWludGVyLnNldFBlbihzZWxmLnBlbigpKQogICAgICAgIHBhaW50ZXIuZHJhd1JvdW5kZWRSZWN0KHNlbGYuYm91bmRpbmdSZWN0KCksIDQsIDQpCgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQoNCwgZm0uaGVpZ2h0KCkgLSAxLCBzZWxmLl90aXRsZSkKCiAgICBkZWYgdGl0bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3RpdGxlCgogICAgZGVmIHNldFRpdGxlKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fdGl0bGUgPSB0ZXh0CiAgICAgICAgc2VsZi51cGRhdGUoKQoKCmNsYXNzIExpbmtTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkdyYXBoaWNzIGl0ZW0gcmVwcmVzZW50aW5nIGFuIGVkZ2UgaW4gYSBncmFwaC4iIiIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwgbGFiZWw6IHN0ciA9ICItbGluay0iLCBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZQogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1Ob25lKQogICAgICAgIHNlbGYuX2xhYmVsID0gbGFiZWwKCiAgICAgICAgIyBFbmFibGUgc2VsZWN0aW5nCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtSXNTZWxlY3RhYmxlKQogICAgICAgIHNlbGYuc2V0QWNjZXB0SG92ZXJFdmVudHMoVHJ1ZSkKICAgICAgICAjIHNlbGYuc2V0WlZhbHVlKC0xKQoKICAgICAgICBzZWxmLl9saW5lOiBRTGluZUYgPSBRTGluZUYoKQoKICAgICMgZGVmIHNldExpbmUoc2VsZiwgbGluZTogUUxpbmVGKToKICAgICMgICAgIHNlbGYucHJlcGFyZUdlb21ldHJ5Q2hhbmdlKCkKICAgICMgICAgIHNlbGYuX2xpbmUgPSBsaW5lCiAgICAjICAgICBzZWxmLnVwZGF0ZSgpCgogICAgIyBkZWYgX2xpbmUoc2VsZikgLT4gUUxpbmVGOgogICAgIyAgICAgcmV0dXJuIHNlbGYuX2xpbmUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYie3NlbGYuX19jbGFzc19fLl9fbmFtZV9ffSh7c2VsZi5fbGFiZWwhcn0pIgoKICAgIGRlZiBzZXRMYWJlbFRleHQoc2VsZiwgdGV4dDogc3RyKToKICAgICAgICBzZWxmLl9sYWJlbCA9IHRleHQKICAgICAgICBzZWxmLnVwZGF0ZSgpCgogICAgZGVmIGxhYmVsVGV4dChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbGFiZWwKCiAgICBkZWYgcGVuKHNlbGYpOgogICAgICAgICIiIm92ZXJyaWRlIHRvIGluZGljYXRlIGVuZHBvaW50cyB1bmRlciBtb3VzZSIiIgogICAgICAgIHBhbGV0dGUgPSBzZWxmLnBhbGV0dGUoKQoKICAgICAgICBwZW4gPSBRUGVuKHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCgogICAgICAgIGlmIHNlbGYuaXNTZWxlY3RlZCgpOgogICAgICAgICAgICBwZW4uc2V0Q29sb3IocGFsZXR0ZS5oaWdobGlnaHQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3Igc2VsZWN0ZWQKCiAgICAgICAgaWYgc2VsZi5pc0hpZ2hsaWdodGVkKCk6CiAgICAgICAgICAgIGlmIHNlbGYuX2hvdmVyTW91c2VQb3M6CiAgICAgICAgICAgICAgICBsaW5lYXJHcmFkID0gUUxpbmVhckdyYWRpZW50KHNlbGYuX2xpbmUucDEoKSwgc2VsZi5fbGluZS5wMigpKQogICAgICAgICAgICAgICAgZDEgPSBRTGluZUYoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXBGcm9tUGFyZW50KHNlbGYuX2xpbmUucDEoKSksIHNlbGYuX2hvdmVyTW91c2VQb3MKICAgICAgICAgICAgICAgICkubGVuZ3RoKCkKICAgICAgICAgICAgICAgIGQyID0gUUxpbmVGKAogICAgICAgICAgICAgICAgICAgIHNlbGYubWFwRnJvbVBhcmVudChzZWxmLl9saW5lLnAyKCkpLCBzZWxmLl9ob3Zlck1vdXNlUG9zCiAgICAgICAgICAgICAgICApLmxlbmd0aCgpCiAgICAgICAgICAgICAgICBpZiBkMSA8IGQyOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjAsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMC41LCBwYWxldHRlLmFjY2VudCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICAgICAgbGluZWFyR3JhZC5zZXRDb2xvckF0KDAuNTUsIHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjQ1LCBwYWxldHRlLnRleHQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjUsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMSwgcGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgcGVuLnNldEJydXNoKFFCcnVzaChsaW5lYXJHcmFkKSkgICMgQ29sb3IgZm9yIGhvdmVyCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwZW4uc2V0QnJ1c2gocGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3IgaG92ZXIKCiAgICAgICAgcmV0dXJuIHBlbgoKICAgIGRlZiBwYWludCgKICAgICAgICBzZWxmLCBwYWludGVyOiBRUGFpbnRlciwgb3B0aW9uOiBRU3R5bGVPcHRpb25HcmFwaGljc0l0ZW0sIHdpZGdldD1Ob25lCiAgICApOgogICAgICAgICMjIyBkcmF3IGFycm93IHNoYXBlCiAgICAgICAgYXJyb3dfc2hhcGUgPSBtYWtlQXJyb3dTaGFwZShzZWxmLl9saW5lLCBzZWxmLnBlbigpLndpZHRoRigpKQoKICAgICAgICAjIHVzZSB0aGUgcGVuIGFzIGJydXNoIHRvIGRyYXcgdGhlIGFycm93IHNoYXBlCiAgICAgICAgcGFpbnRlci5zZXRQZW4oUXQuUGVuU3R5bGUuTm9QZW4pCiAgICAgICAgcGFpbnRlci5zZXRCcnVzaChzZWxmLnBlbigpLmJydXNoKCkpCiAgICAgICAgcGFpbnRlci5kcmF3UGF0aChhcnJvd19zaGFwZSkKICAgICAgICBwYWludGVyLmRyYXdMaW5lKHNlbGYuX2xpbmUpCgogICAgICAgICMjIyBkcmF3IGxhYmVsCiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3VGV4dChzZWxmLl9saW5lLmNlbnRlcigpIC0gc2VsZi5wb3MoKSwgc2VsZi5fbGFiZWwpCgogICAgZGVmIHNoYXBlKHNlbGYpIC0+IFFQYWludGVyUGF0aDoKICAgICAgICAiIiJPdmVycmlkZSBzaGFwZSB0byBwcm92aWRlIGEgd2lkZXIgY2xpY2thYmxlIGFyZWEuIiIiCiAgICAgICAgcGF0aCA9IFFQYWludGVyUGF0aCgpCiAgICAgICAgcGF0aC5tb3ZlVG8oc2VsZi5fbGluZS5wMSgpKQogICAgICAgIHBhdGgubGluZVRvKHNlbGYuX2xpbmUucDIoKSkKICAgICAgICBzdHJva2VyID0gUVBhaW50ZXJQYXRoU3Ryb2tlcigpCiAgICAgICAgc3Ryb2tlci5zZXRXaWR0aCgxMCkKICAgICAgICBzdHJva2VyLnNldENhcFN0eWxlKFF0LlBlbkNhcFN0eWxlLlJvdW5kQ2FwKQogICAgICAgIHN0cm9rZXIuc2V0Sm9pblN0eWxlKFF0LlBlbkpvaW5TdHlsZS5Sb3VuZEpvaW4pCiAgICAgICAgcmV0dXJuIHN0cm9rZXIuY3JlYXRlU3Ryb2tlKHBhdGgpCgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHRleHRfd2lkdGggPSBmbS5ob3Jpem9udGFsQWR2YW5jZShzZWxmLl9sYWJlbCkKICAgICAgICB0ZXh0X2hlaWdodCA9IGZtLmhlaWdodCgpCgogICAgICAgIHNoYXBlX2Jib3ggPSBzZWxmLnNoYXBlKCkuYm91bmRpbmdSZWN0KCkKICAgICAgICB0ZXh0X2Jib3ggPSBRUmVjdEYoCiAgICAgICAgICAgIHNlbGYuX2xpbmUuY2VudGVyKCkgLSBzZWxmLnBvcygpIC0gUVBvaW50RigwLCB0ZXh0X2hlaWdodCksCiAgICAgICAgICAgIFFTaXplRih0ZXh0X3dpZHRoLCB0ZXh0X2hlaWdodCksCiAgICAgICAgKQoKICAgICAgICBtID0gc2VsZi5wZW4oKS53aWR0aEYoKQogICAgICAgIHJldHVybiBzaGFwZV9iYm94LnVuaXRlZCh0ZXh0X2Jib3gpLmFkanVzdGVkKC1tLCAtbSwgbSwgbSkKCiAgICBkZWYgbW92ZSgKICAgICAgICBzZWxmLAogICAgICAgIHNvdXJjZV9ncmFwaGljc19pdGVtOiBRR3JhcGhpY3NJdGVtIHwgUVBhaW50ZXJQYXRoIHwgUVJlY3RGIHwgUVBvaW50RiwKICAgICAgICB0YXJnZXRfZ3JhcGhpY3NfaXRlbTogUUdyYXBoaWNzSXRlbSB8IFFQYWludGVyUGF0aCB8IFFSZWN0RiB8IFFQb2ludEYsCiAgICApOgogICAgICAgIGxpbmUgPSBtYWtlTGluZUJldHdlZW5TaGFwZXMoc291cmNlX2dyYXBoaWNzX2l0ZW0sIHRhcmdldF9ncmFwaGljc19pdGVtKQogICAgICAgIGxlbmd0aCA9IGxpbmUubGVuZ3RoKCkKICAgICAgICBpZiBsZW5ndGggPiAwOgogICAgICAgICAgICBvZmZzZXQgPSBtaW4oOCwgbGVuZ3RoIC8gMikKICAgICAgICAgICAgbGluZSA9IFFMaW5lRigKICAgICAgICAgICAgICAgIGxpbmUucG9pbnRBdChvZmZzZXQgLyBsZW5ndGgpLAogICAgICAgICAgICAgICAgbGluZS5wb2ludEF0KChsZW5ndGggLSBvZmZzZXQpIC8gbGVuZ3RoKSwKICAgICAgICAgICAgKQoKICAgICAgICBzZWxmLnByZXBhcmVHZW9tZXRyeUNoYW5nZSgpCiAgICAgICAgc2VsZi5fbGluZSA9IGxpbmUKICAgICAgICBzZWxmLnVwZGF0ZSgpCgoKY2xhc3MgTm9kZVNoYXBlKFZlcnRleFNoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0aXRsZSwgaW5sZXRzLCBvdXRsZXRzLCBwYXJlbnQ9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyh0aXRsZT10aXRsZSwgcGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9pbmxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYuX291dGxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYucG9ydHNfbWFyZ2luID0gLTUKCiAgICAgICAgZm9yIGlubGV0IGluIGlubGV0czoKICAgICAgICAgICAgc2VsZi5fYWRkSW5sZXQoaW5sZXQpCiAgICAgICAgZm9yIG91dGxldCBpbiBvdXRsZXRzOgogICAgICAgICAgICBzZWxmLl9hZGRPdXRsZXQob3V0bGV0KQoKICAgICAgICBzZWxmLnBvcnRzX21hcmdpbiA9IC00MAoKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIHN1cGVyKCkKICAgICAgICAgICAgLmJvdW5kaW5nUmVjdCgpCiAgICAgICAgICAgIC51bml0ZWQoc2VsZi5jaGlsZHJlbkJvdW5kaW5nUmVjdCgpKQogICAgICAgICAgICAuYWRqdXN0ZWQoLTQsIDAsIDQsIDIpCiAgICAgICAgKQoKICAgIGRlZiBfYWRkSW5sZXQoc2VsZiwgaW5sZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBpbmxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIHNlbGYuX2lubGV0cy5hcHBlbmQoaW5sZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX3JlbW92ZUlubGV0KHNlbGYsIGlubGV0X3dpZGdldDogUUdyYXBoaWNzSXRlbSk6CiAgICAgICAgc2VsZi5faW5sZXRzLnJlbW92ZShpbmxldF93aWRnZXQpCiAgICAgICAgaW5sZXRfd2lkZ2V0LnNldFBhcmVudEl0ZW0oTm9uZSkKICAgICAgICBpZiBzY2VuZSA6PSBpbmxldF93aWRnZXQuc2NlbmUoKToKICAgICAgICAgICAgc2NlbmUucmVtb3ZlSXRlbShpbmxldF93aWRnZXQpCiAgICAgICAgc2VsZi5sYXlvdXRQb3J0cygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBfYWRkT3V0bGV0KHNlbGYsIG91dGxldF93aWRnZXQ6IFFHcmFwaGljc0l0ZW0pOgogICAgICAgIG91dGxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIHNlbGYuX291dGxldHMuYXBwZW5kKG91dGxldF93aWRnZXQpCiAgICAgICAgc2VsZi5sYXlvdXRQb3J0cygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBfcmVtb3ZlT3V0bGV0KHNlbGYsIG91dGxldF93aWRnZXQ6IFFHcmFwaGljc0l0ZW0pOgogICAgICAgIHNlbGYuX291dGxldHMucmVtb3ZlKG91dGxldF93aWRnZXQpCiAgICAgICAgb3V0bGV0X3dpZGdldC5zZXRQYXJlbnRJdGVtKHNlbGYpCiAgICAgICAgaWYgc2NlbmUgOj0gb3V0bGV0X3dpZGdldC5zY2VuZSgpOgogICAgICAgICAgICBzY2VuZS5yZW1vdmVJdGVtKG91dGxldF93aWRnZXQpCiAgICAgICAgc2VsZi5sYXlvdXRQb3J0cygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBsYXlvdXRQb3J0cyhzZWxmKToKICAgICAgICB5ID0gMTQgICMgaGVhZGVyIGhlaWdobgogICAgICAgIGZvciBpbmxldF93aWRnZXQgaW4gc2VsZi5faW5sZXRzOgogICAgICAgICAgICBpbmxldF93aWRnZXQuc2V0UG9zKDQsIHkpCiAgICAgICAgICAgIHkgKz0gaW5sZXRfd2lkZ2V0LmJvdW5kaW5nUmVjdCgpLmhlaWdodCgpCgogICAgICAgIGZvciBvdXRsZXRfd2lkZ2V0IGluIHNlbGYuX291dGxldHM6CiAgICAgICAgICAgIG91dGxldF93aWRnZXQuc2V0UG9zKDQsIHkpCiAgICAgICAgICAgIHkgKz0gb3V0bGV0X3dpZGdldC5ib3VuZGluZ1JlY3QoKS5oZWlnaHQoKQoKCmNsYXNzIFBvcnRTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIGxhYmVsOiBzdHIsCiAgICAgICAgcGFyZW50OiBRR3JhcGhpY3NJdGVtIHwgTm9uZSA9IE5vbmUsCiAgICApOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9sYWJlbCA9IGxhYmVsCgogICAgZGVmIGxhYmVsKHNlbGYpIC0+IHN0cjoKICAgICAgICByZXR1cm4gc2VsZi5fbGFiZWwKCiAgICBkZWYgc2V0TGFiZWwoc2VsZiwgdGV4dDogc3RyKToKICAgICAgICBzZWxmLl9sYWJlbCA9IHRleHQKCiAgICBkZWYgYm91bmRpbmdSZWN0KHNlbGYpIC0+IFFSZWN0RjoKICAgICAgICBmbSA9IFFGb250TWV0cmljcyhzZWxmLmZvbnQoKSkKCiAgICAgICAgZWxsaXBzZV9iYm94ID0gUVJlY3RGKDAsIDAsIDEwLCAxMCkKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fbGFiZWwpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQoKICAgICAgICB0ZXh0X3BvcyA9IFFQb2ludEYoMTIsIDApCiAgICAgICAgdGV4dF9iYm94ID0gUVJlY3RGKHRleHRfcG9zLCBRU2l6ZUYodGV4dF93aWR0aCwgdGV4dF9oZWlnaHQpKQogICAgICAgIHJldHVybiBlbGxpcHNlX2Jib3gudW5pdGVkKHRleHRfYmJveCkKCiAgICBkZWYgcGFpbnQoc2VsZiwgcGFpbnRlciwgb3B0aW9uLCB3aWRnZXQ9Tm9uZSk6CiAgICAgICAgIyMjIGRyYXcgbGFiZWwKICAgICAgICBmbSA9IFFGb250TWV0cmljcyhzZWxmLmZvbnQoKSkKCiAgICAgICAgcGFpbnRlci5zZXRCcnVzaChzZWxmLmJydXNoKCkpCiAgICAgICAgcGFpbnRlci5zZXRQZW4oc2VsZi5wZW4oKSkKICAgICAgICBwYWludGVyLmRyYXdFbGxpcHNlKFFSZWN0RigyLCA3LCA2LCA2KSkKCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHRleHRfcG9zID0gUVBvaW50RigxMiwgdGV4dF9oZWlnaHQgLSAyKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQodGV4dF9wb3MsIHNlbGYuX2xhYmVsKQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpbXBvcnQgc3lzCgogICAgYXBwID0gUUFwcGxpY2F0aW9uKHN5cy5hcmd2KQoKICAgIGdyYXBodmlldyA9IFFHcmFwaGljc1ZpZXcoKQogICAgZ3JhcGh2aWV3LnNldFdpbmRvd1RpdGxlKCJIcmFwaGljc0l0ZW0gZm9yIE5vZGVFZGl0b3IiKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5BbnRpYWxpYXNpbmcsIFRydWUpCiAgICBncmFwaHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlRleHRBbnRpYWxpYXNpbmcsIFRydWUpCiAgICBncmFwaHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlNtb290aFBpeG1hcFRyYW5zZm9ybSwgVHJ1ZSkKCiAgICAjIGNyZWF0ZSBncmFwaCBzY2VuZQogICAgZ3JhcGhzY2VuZSA9IFFHcmFwaGljc1NjZW5lKCkKICAgIGdyYXBoc2NlbmUuc2V0U2NlbmVSZWN0KFFSZWN0RigtNDAwLCAtNDAwLCA4MDAsIDgwMCkpCiAgICBncmFwaHZpZXcuc2V0U2NlbmUoZ3JhcGhzY2VuZSkKCiAgICAjIyBjcmVhdGUgZ3JhcGhpY3MKICAgIHZlcnRleF9pdGVtXzEgPSBWZXJ0ZXhTaGFwZSgiR3JhcGhpY3NWZXJ0ZXhJdGVtMSIpCiAgICBncmFwaHNjZW5lLmFkZEl0ZW0odmVydGV4X2l0ZW1fMSkKICAgIHZlcnRleF9pdGVtXzEuc2V0UG9zKDAsIC0xNTApCgogICAgbm9kZV9pdGVtXzEgPSBOb2RlU2hhcGUoCiAgICAgICAgIkdyYXBoaWNzTm9kZUl0ZW0xIiwKICAgICAgICBpbmxldHM9W1BvcnRTaGFwZSgiR3JhcGhpY3NQb3J0SXRlbW0iKV0sCiAgICAgICAgb3V0bGV0cz1bUG9ydFNoYXBlKCJHcmFwaGljc1BvcnRJdGVtIildLAogICAgKQogICAgZ3JhcGhzY2VuZS5hZGRJdGVtKG5vZGVfaXRlbV8xKQogICAgbm9kZV9pdGVtXzEuc2V0UG9zKDAsIC0xMjApCgogICAgbGlua19pdGVtXzEgPSBMaW5rU2hhcGUoImxpbmsxIikKICAgIGxpbmtfaXRlbV8xLnNldExpbmUoUUxpbmVGKDAwLCAtNTAsIDEwMCwgLTIwKSkKICAgIGdyYXBoc2NlbmUuYWRkSXRlbShsaW5rX2l0ZW1fMSkKCiAgICBncmFwaHZpZXcuc2hvdygpCiAgICBhcHAuZXhlYygpCg",
					"AQAAAAAAAAABAAAAqSIAAAAAAACpIgAAAAAAAAAAAAAAAPC/"
				],
				[
					688,
					1,
					"insert",
					{
						"characters": "move"
					},
					"BQAAACAyAAAAAAAAITIAAAAAAAAAAAAAITIAAAAAAAAhMgAAAAAAAAcAAABzZXRMaW5lITIAAAAAAAAiMgAAAAAAAAAAAAAiMgAAAAAAACMyAAAAAAAAAAAAACMyAAAAAAAAJDIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAIDIAAAAAAAAnMgAAAAAAAAAAAAAAAPC/"
				],
				[
					694,
					1,
					"insert",
					{
						"characters": "QPointF"
					},
					"CAAAACUyAAAAAAAAJjIAAAAAAAAAAAAAJjIAAAAAAAAmMgAAAAAAAAYAAABRTGluZUYmMgAAAAAAACcyAAAAAAAAAAAAACcyAAAAAAAAKDIAAAAAAAAAAAAAKDIAAAAAAAApMgAAAAAAAAAAAAApMgAAAAAAACoyAAAAAAAAAAAAACoyAAAAAAAAKzIAAAAAAAAAAAAAKzIAAAAAAAAsMgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAJTIAAAAAAAArMgAAAAAAAAAAAAAAAPC/"
				],
				[
					696,
					1,
					"left_delete",
					null,
					"AQAAAC4yAAAAAAAALjIAAAAAAAABAAAAMA",
					"AQAAAAAAAAABAAAALzIAAAAAAAAvMgAAAAAAAAAAAAAAAPC/"
				],
				[
					698,
					1,
					"insert",
					{
						"characters": ")"
					},
					"AQAAADMyAAAAAAAANDIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMzIAAAAAAAAzMgAAAAAAAAAAAAAAAPC/"
				],
				[
					700,
					1,
					"insert",
					{
						"characters": "QPointF("
					},
					"CAAAADYyAAAAAAAANzIAAAAAAAAAAAAANzIAAAAAAAA4MgAAAAAAAAAAAAA4MgAAAAAAADkyAAAAAAAAAAAAADkyAAAAAAAAOjIAAAAAAAAAAAAAOjIAAAAAAAA7MgAAAAAAAAAAAAA7MgAAAAAAADwyAAAAAAAAAAAAADwyAAAAAAAAPTIAAAAAAAAAAAAAPTIAAAAAAAA+MgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAANjIAAAAAAAA2MgAAAAAAAAAAAAAAAPC/"
				],
				[
					705,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAkjIAAAAAAACSMgAAIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCiMgUUdyYXBoaWNzSXRlbSBzaGFwZXMuIHB1cmVseSB2aXN1YWwsIGJ1dCBpbnRlcmFjdGl2ZS4KIyB0aGVzIGFyZSB0aGUgc3VwZXJjbGFzcyBvZiB0aGUgTW9kZWxWaWV3IFdpZGdldHMgZm9yIHRoZSBOWEdyYXBoU2NlbmUKIyB0aGVyIGFyZSBubyBzdXBwb3NlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBtb2RlbCBpbiBhbnkgd2F5CiMgcmVzcG9uc2libGUgdG8gcGFpbnQgdWkgaXRlbXMsCiMgYW5kIGNhbiByZWFjdCB0byBtb3VzZSBvciBrZXlib2FyZCBldmVudCwgc3RyaWN0bHkgaW4gYSB2b3N1YWwgd2F5LgojIGluIE1WQyB0aGVzZSB3b3VsZCBiZSB0aGUgdmlld3MuCiMgaW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoZXNlIGFyZSBzZWxmIGNvbnRhaW5lZCB3aWRnZXRzLAojIHRoYXQgY2FuIGJlIHVzZWQgYnkgdGhlICdWaWV3cycKCgpmcm9tIHR5cGluZyBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRHdWkgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0Q29yZSBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRXaWRnZXRzIGltcG9ydCAqCgpmcm9tIHB5bGl2ZS5RdEdyYXBoRWRpdG9yLnFncmFwaGljc19hcnJvd19pdGVtIGltcG9ydCAoCiAgICBtYWtlQXJyb3dTaGFwZSwKKQpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IG1ha2VMaW5lQmV0d2VlblNoYXBlcwoKCmNsYXNzIEFic3RyYWN0U2hhcGUoUUdyYXBoaWNzSXRlbSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLnNldEZsYWcoUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUpCiAgICAgICAgc2VsZi5zZXRBY2NlcHRIb3ZlckV2ZW50cyhUcnVlKQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQgPSBGYWxzZQogICAgICAgIHNlbGYuX2hvdmVyTW91c2VQb3M6IFFQb2ludEYgfCBOb25lID0gTm9uZQoKICAgIGRlZiBzZXRIaWdobGlnaHRlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgc2VsZi5faXNIaWdobGlnaHRlZCA9IHZhbHVlCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBpc0hpZ2hsaWdodGVkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9pc0hpZ2hsaWdodGVkCgogICAgZGVmIGhvdmVyRW50ZXJFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVIb3ZlckV2ZW50KToKICAgICAgICBzZWxmLnNldEhpZ2hsaWdodGVkKFRydWUpCgogICAgZGVmIGhvdmVyTW92ZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZUhvdmVyRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5faG92ZXJNb3VzZVBvcyA9IGV2ZW50LnBvcygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBob3ZlckxlYXZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lSG92ZXJFdmVudCk6CiAgICAgICAgc2VsZi5zZXRIaWdobGlnaHRlZChGYWxzZSkKCiAgICBkZWYgZm9udChzZWxmKToKICAgICAgICBpZiBmb250IDo9IGdldGF0dHIoc2VsZiwgIl9mb250IiwgTm9uZSk6CiAgICAgICAgICAgIHJldHVybiBmb250CiAgICAgICAgZWxpZiBwYXJlbnRXaWRnZXQgOj0gc2VsZi5wYXJlbnRXaWRnZXQoKToKICAgICAgICAgICAgcmV0dXJuIHBhcmVudFdpZGdldC5mb250KCkKICAgICAgICBlbGlmIHNjZW5lIDo9IHNlbGYuc2NlbmUoKToKICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmZvbnQoKQogICAgICAgIGVsaWYgYXBwIDo9IFFBcHBsaWNhdGlvbi5pbnN0YW5jZSgpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFwcCwgUUd1aUFwcGxpY2F0aW9uKToKICAgICAgICAgICAgICAgIHJldHVybiBhcHAuZm9udCgpCgogICAgICAgIHJldHVybiBRRm9udCgpCgogICAgZGVmIHBhbGV0dGUoc2VsZikgLT4gUVBhbGV0dGU6CiAgICAgICAgaWYgcGFsZXR0ZSA6PSBnZXRhdHRyKHNlbGYsICJfcGFsZXR0ZSIsIE5vbmUpOgogICAgICAgICAgICByZXR1cm4gcGFsZXR0ZQogICAgICAgIGVsaWYgcGFyZW50V2lkZ2V0IDo9IHNlbGYucGFyZW50V2lkZ2V0KCk6CiAgICAgICAgICAgIHJldHVybiBwYXJlbnRXaWRnZXQucGFsZXR0ZSgpCiAgICAgICAgZWxpZiBzY2VuZSA6PSBzZWxmLnNjZW5lKCk6CiAgICAgICAgICAgIHJldHVybiBzY2VuZS5wYWxldHRlKCkKICAgICAgICBlbGlmIGFwcCA6PSBRQXBwbGljYXRpb24uaW5zdGFuY2UoKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhcHAsIFFHdWlBcHBsaWNhdGlvbik6CiAgICAgICAgICAgICAgICByZXR1cm4gYXBwLnBhbGV0dGUoKQoKICAgICAgICByZXR1cm4gUVBhbGV0dGUoKQoKICAgIGRlZiBicnVzaChzZWxmKToKICAgICAgICBiYXNlQ29sb3IgPSBzZWxmLnBhbGV0dGUoKS5iYXNlKCkuY29sb3IoKQogICAgICAgIGJhc2VDb2xvci5zZXRBbHBoYSgyNTUpCiAgICAgICAgYnJ1c2ggPSBRQnJ1c2goYmFzZUNvbG9yKQogICAgICAgIHJldHVybiBicnVzaAoKICAgIGRlZiBwZW4oc2VsZik6CiAgICAgICAgcGFsZXR0ZSA9IHNlbGYucGFsZXR0ZSgpCgogICAgICAgIHBlbiA9IFFQZW4ocGFsZXR0ZS50ZXh0KCkuY29sb3IoKSkKCiAgICAgICAgaWYgc2VsZi5pc1NlbGVjdGVkKCk6CiAgICAgICAgICAgIHBlbi5zZXRDb2xvcihwYWxldHRlLmhpZ2hsaWdodCgpLmNvbG9yKCkpICAjIENvbG9yIGZvciBzZWxlY3RlZAoKICAgICAgICBpZiBzZWxmLmlzSGlnaGxpZ2h0ZWQoKToKICAgICAgICAgICAgcGVuLnNldENvbG9yKHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkgICMgQ29sb3IgZm9yIGhvdmVyCgogICAgICAgIHJldHVybiBwZW4KCgpjbGFzcyBWZXJ0ZXhTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkEgZ3JhcGggJ1ZlcnRleCcgZ3JhcGhpY3MgaXRlbS4gbm8gaW5sZXRzIG9yIG91dGxldHMuIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgdGl0bGU6IHN0ciA9ICJOb2RlIiwKICAgICAgICBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhwYXJlbnQpCiAgICAgICAgIyBwcml2YXRlIHZhcmlhYmxlcwogICAgICAgIHNlbGYuX3RpdGxlOiBzdHIgPSB0aXRsZQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQ6IGJvb2wgPSBGYWxzZQoKICAgICAgICAjIEVuYWJsZSBzZWxlY3Rpb24gYW5kIG1vdmVtZW50CiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc01vdmFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc0ZvY3VzYWJsZSwgVHJ1ZSkKICAgICAgICBzZWxmLnNldEZsYWcoCiAgICAgICAgICAgIFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtU2VuZHNTY2VuZVBvc2l0aW9uQ2hhbmdlcwogICAgICAgICkKICAgICAgICBzZWxmLnNldEFjY2VwdEhvdmVyRXZlbnRzKFRydWUpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmIntzZWxmLl9fY2xhc3NfXy5fX25hbWVfX30oe3NlbGYuX3RpdGxlIXJ9KSIKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYmFzZUNvbG9yID0gc2VsZi5wYWxldHRlKCkuYmFzZSgpLmNvbG9yKCkKICAgICAgICBiYXNlQ29sb3Iuc2V0QWxwaGEoMjAwKQogICAgICAgIGJydXNoID0gUUJydXNoKGJhc2VDb2xvcikKICAgICAgICByZXR1cm4gYnJ1c2gKCiAgICBAb3ZlcnJpZGUKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQoKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fdGl0bGUpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHJldHVybiBRUmVjdEYoMCwgMCwgdGV4dF93aWR0aCArIDgsIHRleHRfaGVpZ2h0ICsgNCkKCiAgICBkZWYgcGFpbnQoCiAgICAgICAgc2VsZiwgcGFpbnRlcjogUVBhaW50ZXIsIG9wdGlvbjogUVN0eWxlT3B0aW9uR3JhcGhpY3NJdGVtLCB3aWRnZXQ9Tm9uZQogICAgKToKICAgICAgICBwYWludGVyLnNldEJydXNoKHNlbGYuYnJ1c2goKSkKICAgICAgICBwYWludGVyLnNldFBlbihzZWxmLnBlbigpKQogICAgICAgIHBhaW50ZXIuZHJhd1JvdW5kZWRSZWN0KHNlbGYuYm91bmRpbmdSZWN0KCksIDQsIDQpCgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQoNCwgZm0uaGVpZ2h0KCkgLSAxLCBzZWxmLl90aXRsZSkKCiAgICBkZWYgdGl0bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3RpdGxlCgogICAgZGVmIHNldFRpdGxlKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fdGl0bGUgPSB0ZXh0CiAgICAgICAgc2VsZi51cGRhdGUoKQoKCmNsYXNzIExpbmtTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkdyYXBoaWNzIGl0ZW0gcmVwcmVzZW50aW5nIGFuIGVkZ2UgaW4gYSBncmFwaC4iIiIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwgbGFiZWw6IHN0ciA9ICItbGluay0iLCBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZQogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1Ob25lKQogICAgICAgIHNlbGYuX2xhYmVsID0gbGFiZWwKCiAgICAgICAgIyBFbmFibGUgc2VsZWN0aW5nCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtSXNTZWxlY3RhYmxlKQogICAgICAgIHNlbGYuc2V0QWNjZXB0SG92ZXJFdmVudHMoVHJ1ZSkKICAgICAgICAjIHNlbGYuc2V0WlZhbHVlKC0xKQoKICAgICAgICBzZWxmLl9saW5lOiBRTGluZUYgPSBRTGluZUYoKQoKICAgICMgZGVmIHNldExpbmUoc2VsZiwgbGluZTogUUxpbmVGKToKICAgICMgICAgIHNlbGYucHJlcGFyZUdlb21ldHJ5Q2hhbmdlKCkKICAgICMgICAgIHNlbGYuX2xpbmUgPSBsaW5lCiAgICAjICAgICBzZWxmLnVwZGF0ZSgpCgogICAgIyBkZWYgX2xpbmUoc2VsZikgLT4gUUxpbmVGOgogICAgIyAgICAgcmV0dXJuIHNlbGYuX2xpbmUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYie3NlbGYuX19jbGFzc19fLl9fbmFtZV9ffSh7c2VsZi5fbGFiZWwhcn0pIgoKICAgIGRlZiBzZXRMYWJlbFRleHQoc2VsZiwgdGV4dDogc3RyKToKICAgICAgICBzZWxmLl9sYWJlbCA9IHRleHQKICAgICAgICBzZWxmLnVwZGF0ZSgpCgogICAgZGVmIGxhYmVsVGV4dChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbGFiZWwKCiAgICBkZWYgcGVuKHNlbGYpOgogICAgICAgICIiIm92ZXJyaWRlIHRvIGluZGljYXRlIGVuZHBvaW50cyB1bmRlciBtb3VzZSIiIgogICAgICAgIHBhbGV0dGUgPSBzZWxmLnBhbGV0dGUoKQoKICAgICAgICBwZW4gPSBRUGVuKHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCgogICAgICAgIGlmIHNlbGYuaXNTZWxlY3RlZCgpOgogICAgICAgICAgICBwZW4uc2V0Q29sb3IocGFsZXR0ZS5oaWdobGlnaHQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3Igc2VsZWN0ZWQKCiAgICAgICAgaWYgc2VsZi5pc0hpZ2hsaWdodGVkKCk6CiAgICAgICAgICAgIGlmIHNlbGYuX2hvdmVyTW91c2VQb3M6CiAgICAgICAgICAgICAgICBsaW5lYXJHcmFkID0gUUxpbmVhckdyYWRpZW50KHNlbGYuX2xpbmUucDEoKSwgc2VsZi5fbGluZS5wMigpKQogICAgICAgICAgICAgICAgZDEgPSBRTGluZUYoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXBGcm9tUGFyZW50KHNlbGYuX2xpbmUucDEoKSksIHNlbGYuX2hvdmVyTW91c2VQb3MKICAgICAgICAgICAgICAgICkubGVuZ3RoKCkKICAgICAgICAgICAgICAgIGQyID0gUUxpbmVGKAogICAgICAgICAgICAgICAgICAgIHNlbGYubWFwRnJvbVBhcmVudChzZWxmLl9saW5lLnAyKCkpLCBzZWxmLl9ob3Zlck1vdXNlUG9zCiAgICAgICAgICAgICAgICApLmxlbmd0aCgpCiAgICAgICAgICAgICAgICBpZiBkMSA8IGQyOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjAsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMC41LCBwYWxldHRlLmFjY2VudCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICAgICAgbGluZWFyR3JhZC5zZXRDb2xvckF0KDAuNTUsIHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjQ1LCBwYWxldHRlLnRleHQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjUsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMSwgcGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgcGVuLnNldEJydXNoKFFCcnVzaChsaW5lYXJHcmFkKSkgICMgQ29sb3IgZm9yIGhvdmVyCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwZW4uc2V0QnJ1c2gocGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3IgaG92ZXIKCiAgICAgICAgcmV0dXJuIHBlbgoKICAgIGRlZiBwYWludCgKICAgICAgICBzZWxmLCBwYWludGVyOiBRUGFpbnRlciwgb3B0aW9uOiBRU3R5bGVPcHRpb25HcmFwaGljc0l0ZW0sIHdpZGdldD1Ob25lCiAgICApOgogICAgICAgICMjIyBkcmF3IGFycm93IHNoYXBlCiAgICAgICAgYXJyb3dfc2hhcGUgPSBtYWtlQXJyb3dTaGFwZShzZWxmLl9saW5lLCBzZWxmLnBlbigpLndpZHRoRigpKQoKICAgICAgICAjIHVzZSB0aGUgcGVuIGFzIGJydXNoIHRvIGRyYXcgdGhlIGFycm93IHNoYXBlCiAgICAgICAgcGFpbnRlci5zZXRQZW4oUXQuUGVuU3R5bGUuTm9QZW4pCiAgICAgICAgcGFpbnRlci5zZXRCcnVzaChzZWxmLnBlbigpLmJydXNoKCkpCiAgICAgICAgcGFpbnRlci5kcmF3UGF0aChhcnJvd19zaGFwZSkKICAgICAgICBwYWludGVyLmRyYXdMaW5lKHNlbGYuX2xpbmUpCgogICAgICAgICMjIyBkcmF3IGxhYmVsCiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3VGV4dChzZWxmLl9saW5lLmNlbnRlcigpIC0gc2VsZi5wb3MoKSwgc2VsZi5fbGFiZWwpCgogICAgZGVmIHNoYXBlKHNlbGYpIC0+IFFQYWludGVyUGF0aDoKICAgICAgICAiIiJPdmVycmlkZSBzaGFwZSB0byBwcm92aWRlIGEgd2lkZXIgY2xpY2thYmxlIGFyZWEuIiIiCiAgICAgICAgcGF0aCA9IFFQYWludGVyUGF0aCgpCiAgICAgICAgcGF0aC5tb3ZlVG8oc2VsZi5fbGluZS5wMSgpKQogICAgICAgIHBhdGgubGluZVRvKHNlbGYuX2xpbmUucDIoKSkKICAgICAgICBzdHJva2VyID0gUVBhaW50ZXJQYXRoU3Ryb2tlcigpCiAgICAgICAgc3Ryb2tlci5zZXRXaWR0aCgxMCkKICAgICAgICBzdHJva2VyLnNldENhcFN0eWxlKFF0LlBlbkNhcFN0eWxlLlJvdW5kQ2FwKQogICAgICAgIHN0cm9rZXIuc2V0Sm9pblN0eWxlKFF0LlBlbkpvaW5TdHlsZS5Sb3VuZEpvaW4pCiAgICAgICAgcmV0dXJuIHN0cm9rZXIuY3JlYXRlU3Ryb2tlKHBhdGgpCgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHRleHRfd2lkdGggPSBmbS5ob3Jpem9udGFsQWR2YW5jZShzZWxmLl9sYWJlbCkKICAgICAgICB0ZXh0X2hlaWdodCA9IGZtLmhlaWdodCgpCgogICAgICAgIHNoYXBlX2Jib3ggPSBzZWxmLnNoYXBlKCkuYm91bmRpbmdSZWN0KCkKICAgICAgICB0ZXh0X2Jib3ggPSBRUmVjdEYoCiAgICAgICAgICAgIHNlbGYuX2xpbmUuY2VudGVyKCkgLSBzZWxmLnBvcygpIC0gUVBvaW50RigwLCB0ZXh0X2hlaWdodCksCiAgICAgICAgICAgIFFTaXplRih0ZXh0X3dpZHRoLCB0ZXh0X2hlaWdodCksCiAgICAgICAgKQoKICAgICAgICBtID0gc2VsZi5wZW4oKS53aWR0aEYoKQogICAgICAgIHJldHVybiBzaGFwZV9iYm94LnVuaXRlZCh0ZXh0X2Jib3gpLmFkanVzdGVkKC1tLCAtbSwgbSwgbSkKCiAgICBkZWYgbW92ZSgKICAgICAgICBzZWxmLAogICAgICAgIHNvdXJjZV9ncmFwaGljc19pdGVtOiBRR3JhcGhpY3NJdGVtIHwgUVBhaW50ZXJQYXRoIHwgUVJlY3RGIHwgUVBvaW50RiwKICAgICAgICB0YXJnZXRfZ3JhcGhpY3NfaXRlbTogUUdyYXBoaWNzSXRlbSB8IFFQYWludGVyUGF0aCB8IFFSZWN0RiB8IFFQb2ludEYsCiAgICApOgogICAgICAgIGxpbmUgPSBtYWtlTGluZUJldHdlZW5TaGFwZXMoc291cmNlX2dyYXBoaWNzX2l0ZW0sIHRhcmdldF9ncmFwaGljc19pdGVtKQogICAgICAgIGxlbmd0aCA9IGxpbmUubGVuZ3RoKCkKICAgICAgICBpZiBsZW5ndGggPiAwOgogICAgICAgICAgICBvZmZzZXQgPSBtaW4oOCwgbGVuZ3RoIC8gMikKICAgICAgICAgICAgbGluZSA9IFFMaW5lRigKICAgICAgICAgICAgICAgIGxpbmUucG9pbnRBdChvZmZzZXQgLyBsZW5ndGgpLAogICAgICAgICAgICAgICAgbGluZS5wb2ludEF0KChsZW5ndGggLSBvZmZzZXQpIC8gbGVuZ3RoKSwKICAgICAgICAgICAgKQoKICAgICAgICBzZWxmLnByZXBhcmVHZW9tZXRyeUNoYW5nZSgpCiAgICAgICAgc2VsZi5fbGluZSA9IGxpbmUKICAgICAgICBzZWxmLnVwZGF0ZSgpCgoKY2xhc3MgTm9kZVNoYXBlKFZlcnRleFNoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0aXRsZSwgaW5sZXRzLCBvdXRsZXRzLCBwYXJlbnQ9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyh0aXRsZT10aXRsZSwgcGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9pbmxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYuX291dGxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYucG9ydHNfbWFyZ2luID0gLTUKCiAgICAgICAgZm9yIGlubGV0IGluIGlubGV0czoKICAgICAgICAgICAgc2VsZi5fYWRkSW5sZXQoaW5sZXQpCiAgICAgICAgZm9yIG91dGxldCBpbiBvdXRsZXRzOgogICAgICAgICAgICBzZWxmLl9hZGRPdXRsZXQob3V0bGV0KQoKICAgICAgICBzZWxmLnBvcnRzX21hcmdpbiA9IC00MAoKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIHN1cGVyKCkKICAgICAgICAgICAgLmJvdW5kaW5nUmVjdCgpCiAgICAgICAgICAgIC51bml0ZWQoc2VsZi5jaGlsZHJlbkJvdW5kaW5nUmVjdCgpKQogICAgICAgICAgICAuYWRqdXN0ZWQoLTQsIDAsIDQsIDIpCiAgICAgICAgKQoKICAgIGRlZiBfYWRkSW5sZXQoc2VsZiwgaW5sZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBpbmxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIHNlbGYuX2lubGV0cy5hcHBlbmQoaW5sZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX3JlbW92ZUlubGV0KHNlbGYsIGlubGV0X3dpZGdldDogUUdyYXBoaWNzSXRlbSk6CiAgICAgICAgc2VsZi5faW5sZXRzLnJlbW92ZShpbmxldF93aWRnZXQpCiAgICAgICAgaW5sZXRfd2lkZ2V0LnNldFBhcmVudEl0ZW0oTm9uZSkKICAgICAgICBpZiBzY2VuZSA6PSBpbmxldF93aWRnZXQuc2NlbmUoKToKICAgICAgICAgICAgc2NlbmUucmVtb3ZlSXRlbShpbmxldF93aWRnZXQpCiAgICAgICAgc2VsZi5sYXlvdXRQb3J0cygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBfYWRkT3V0bGV0KHNlbGYsIG91dGxldF93aWRnZXQ6IFFHcmFwaGljc0l0ZW0pOgogICAgICAgIG91dGxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIHNlbGYuX291dGxldHMuYXBwZW5kKG91dGxldF93aWRnZXQpCiAgICAgICAgc2VsZi5sYXlvdXRQb3J0cygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBfcmVtb3ZlT3V0bGV0KHNlbGYsIG91dGxldF93aWRnZXQ6IFFHcmFwaGljc0l0ZW0pOgogICAgICAgIHNlbGYuX291dGxldHMucmVtb3ZlKG91dGxldF93aWRnZXQpCiAgICAgICAgb3V0bGV0X3dpZGdldC5zZXRQYXJlbnRJdGVtKHNlbGYpCiAgICAgICAgaWYgc2NlbmUgOj0gb3V0bGV0X3dpZGdldC5zY2VuZSgpOgogICAgICAgICAgICBzY2VuZS5yZW1vdmVJdGVtKG91dGxldF93aWRnZXQpCiAgICAgICAgc2VsZi5sYXlvdXRQb3J0cygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBsYXlvdXRQb3J0cyhzZWxmKToKICAgICAgICB5ID0gMTQgICMgaGVhZGVyIGhlaWdobgogICAgICAgIGZvciBpbmxldF93aWRnZXQgaW4gc2VsZi5faW5sZXRzOgogICAgICAgICAgICBpbmxldF93aWRnZXQuc2V0UG9zKDQsIHkpCiAgICAgICAgICAgIHkgKz0gaW5sZXRfd2lkZ2V0LmJvdW5kaW5nUmVjdCgpLmhlaWdodCgpCgogICAgICAgIGZvciBvdXRsZXRfd2lkZ2V0IGluIHNlbGYuX291dGxldHM6CiAgICAgICAgICAgIG91dGxldF93aWRnZXQuc2V0UG9zKDQsIHkpCiAgICAgICAgICAgIHkgKz0gb3V0bGV0X3dpZGdldC5ib3VuZGluZ1JlY3QoKS5oZWlnaHQoKQoKCmNsYXNzIFBvcnRTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIGxhYmVsOiBzdHIsCiAgICAgICAgcGFyZW50OiBRR3JhcGhpY3NJdGVtIHwgTm9uZSA9IE5vbmUsCiAgICApOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9sYWJlbCA9IGxhYmVsCgogICAgZGVmIGxhYmVsKHNlbGYpIC0+IHN0cjoKICAgICAgICByZXR1cm4gc2VsZi5fbGFiZWwKCiAgICBkZWYgc2V0TGFiZWwoc2VsZiwgdGV4dDogc3RyKToKICAgICAgICBzZWxmLl9sYWJlbCA9IHRleHQKCiAgICBkZWYgYm91bmRpbmdSZWN0KHNlbGYpIC0+IFFSZWN0RjoKICAgICAgICBmbSA9IFFGb250TWV0cmljcyhzZWxmLmZvbnQoKSkKCiAgICAgICAgZWxsaXBzZV9iYm94ID0gUVJlY3RGKDAsIDAsIDEwLCAxMCkKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fbGFiZWwpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQoKICAgICAgICB0ZXh0X3BvcyA9IFFQb2ludEYoMTIsIDApCiAgICAgICAgdGV4dF9iYm94ID0gUVJlY3RGKHRleHRfcG9zLCBRU2l6ZUYodGV4dF93aWR0aCwgdGV4dF9oZWlnaHQpKQogICAgICAgIHJldHVybiBlbGxpcHNlX2Jib3gudW5pdGVkKHRleHRfYmJveCkKCiAgICBkZWYgcGFpbnQoc2VsZiwgcGFpbnRlciwgb3B0aW9uLCB3aWRnZXQ9Tm9uZSk6CiAgICAgICAgIyMjIGRyYXcgbGFiZWwKICAgICAgICBmbSA9IFFGb250TWV0cmljcyhzZWxmLmZvbnQoKSkKCiAgICAgICAgcGFpbnRlci5zZXRCcnVzaChzZWxmLmJydXNoKCkpCiAgICAgICAgcGFpbnRlci5zZXRQZW4oc2VsZi5wZW4oKSkKICAgICAgICBwYWludGVyLmRyYXdFbGxpcHNlKFFSZWN0RigyLCA3LCA2LCA2KSkKCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHRleHRfcG9zID0gUVBvaW50RigxMiwgdGV4dF9oZWlnaHQgLSAyKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQodGV4dF9wb3MsIHNlbGYuX2xhYmVsKQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpbXBvcnQgc3lzCgogICAgYXBwID0gUUFwcGxpY2F0aW9uKHN5cy5hcmd2KQoKICAgIGdyYXBodmlldyA9IFFHcmFwaGljc1ZpZXcoKQogICAgZ3JhcGh2aWV3LnNldFdpbmRvd1RpdGxlKCJIcmFwaGljc0l0ZW0gZm9yIE5vZGVFZGl0b3IiKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5BbnRpYWxpYXNpbmcsIFRydWUpCiAgICBncmFwaHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlRleHRBbnRpYWxpYXNpbmcsIFRydWUpCiAgICBncmFwaHZpZXcuc2V0UmVuZGVySGludChRUGFpbnRlci5SZW5kZXJIaW50LlNtb290aFBpeG1hcFRyYW5zZm9ybSwgVHJ1ZSkKCiAgICAjIGNyZWF0ZSBncmFwaCBzY2VuZQogICAgZ3JhcGhzY2VuZSA9IFFHcmFwaGljc1NjZW5lKCkKICAgIGdyYXBoc2NlbmUuc2V0U2NlbmVSZWN0KFFSZWN0RigtNDAwLCAtNDAwLCA4MDAsIDgwMCkpCiAgICBncmFwaHZpZXcuc2V0U2NlbmUoZ3JhcGhzY2VuZSkKCiAgICAjIyBjcmVhdGUgZ3JhcGhpY3MKICAgIHZlcnRleF9pdGVtXzEgPSBWZXJ0ZXhTaGFwZSgiR3JhcGhpY3NWZXJ0ZXhJdGVtMSIpCiAgICBncmFwaHNjZW5lLmFkZEl0ZW0odmVydGV4X2l0ZW1fMSkKICAgIHZlcnRleF9pdGVtXzEuc2V0UG9zKDAsIC0xNTApCgogICAgbm9kZV9pdGVtXzEgPSBOb2RlU2hhcGUoCiAgICAgICAgIkdyYXBoaWNzTm9kZUl0ZW0xIiwKICAgICAgICBpbmxldHM9W1BvcnRTaGFwZSgiR3JhcGhpY3NQb3J0SXRlbW0iKV0sCiAgICAgICAgb3V0bGV0cz1bUG9ydFNoYXBlKCJHcmFwaGljc1BvcnRJdGVtIildLAogICAgKQogICAgZ3JhcGhzY2VuZS5hZGRJdGVtKG5vZGVfaXRlbV8xKQogICAgbm9kZV9pdGVtXzEuc2V0UG9zKDAsIC0xMjApCgogICAgbGlua19pdGVtXzEgPSBMaW5rU2hhcGUoImxpbmsxIikKICAgIGxpbmtfaXRlbV8xLm1vdmUoUVBvaW50RigwLCAtNTApLCBRUG9pbnRGKDEwMCwgLTIwKSkKICAgIGdyYXBoc2NlbmUuYWRkSXRlbShsaW5rX2l0ZW1fMSkKCiAgICBncmFwaHZpZXcuc2hvdygpCiAgICBhcHAuZXhlYygpCg",
					"AQAAAAAAAAABAAAA6jEAAAAAAADqMQAAAAAAAAAAAAAAAPC/"
				],
				[
					721,
					2,
					"left_delete",
					null,
					"AgAAAFkmAAAAAAAAWSYAAAAAAAAoAAAAICAgICAgICBpbmxldF93aWRnZXQuc2V0UGFyZW50SXRlbShOb25lKVgmAAAAAAAAWCYAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAAgSYAAAAAAABZJgAAAAAAAAAAAAAAAPC/"
				],
				[
					725,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAaTIAAAAAAABpMgAAIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCiMgUUdyYXBoaWNzSXRlbSBzaGFwZXMuIHB1cmVseSB2aXN1YWwsIGJ1dCBpbnRlcmFjdGl2ZS4KIyB0aGVzIGFyZSB0aGUgc3VwZXJjbGFzcyBvZiB0aGUgTW9kZWxWaWV3IFdpZGdldHMgZm9yIHRoZSBOWEdyYXBoU2NlbmUKIyB0aGVyIGFyZSBubyBzdXBwb3NlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBtb2RlbCBpbiBhbnkgd2F5CiMgcmVzcG9uc2libGUgdG8gcGFpbnQgdWkgaXRlbXMsCiMgYW5kIGNhbiByZWFjdCB0byBtb3VzZSBvciBrZXlib2FyZCBldmVudCwgc3RyaWN0bHkgaW4gYSB2b3N1YWwgd2F5LgojIGluIE1WQyB0aGVzZSB3b3VsZCBiZSB0aGUgdmlld3MuCiMgaW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoZXNlIGFyZSBzZWxmIGNvbnRhaW5lZCB3aWRnZXRzLAojIHRoYXQgY2FuIGJlIHVzZWQgYnkgdGhlICdWaWV3cycKCgpmcm9tIHR5cGluZyBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRHdWkgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0Q29yZSBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRXaWRnZXRzIGltcG9ydCAqCgpmcm9tIHB5bGl2ZS5RdEdyYXBoRWRpdG9yLnFncmFwaGljc19hcnJvd19pdGVtIGltcG9ydCAoCiAgICBtYWtlQXJyb3dTaGFwZSwKKQpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IG1ha2VMaW5lQmV0d2VlblNoYXBlcwoKCmNsYXNzIEFic3RyYWN0U2hhcGUoUUdyYXBoaWNzSXRlbSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLnNldEZsYWcoUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUpCiAgICAgICAgc2VsZi5zZXRBY2NlcHRIb3ZlckV2ZW50cyhUcnVlKQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQgPSBGYWxzZQogICAgICAgIHNlbGYuX2hvdmVyTW91c2VQb3M6IFFQb2ludEYgfCBOb25lID0gTm9uZQoKICAgIGRlZiBzZXRIaWdobGlnaHRlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgc2VsZi5faXNIaWdobGlnaHRlZCA9IHZhbHVlCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBpc0hpZ2hsaWdodGVkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9pc0hpZ2hsaWdodGVkCgogICAgZGVmIGhvdmVyRW50ZXJFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVIb3ZlckV2ZW50KToKICAgICAgICBzZWxmLnNldEhpZ2hsaWdodGVkKFRydWUpCgogICAgZGVmIGhvdmVyTW92ZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZUhvdmVyRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5faG92ZXJNb3VzZVBvcyA9IGV2ZW50LnBvcygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBob3ZlckxlYXZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lSG92ZXJFdmVudCk6CiAgICAgICAgc2VsZi5zZXRIaWdobGlnaHRlZChGYWxzZSkKCiAgICBkZWYgZm9udChzZWxmKToKICAgICAgICBpZiBmb250IDo9IGdldGF0dHIoc2VsZiwgIl9mb250IiwgTm9uZSk6CiAgICAgICAgICAgIHJldHVybiBmb250CiAgICAgICAgZWxpZiBwYXJlbnRXaWRnZXQgOj0gc2VsZi5wYXJlbnRXaWRnZXQoKToKICAgICAgICAgICAgcmV0dXJuIHBhcmVudFdpZGdldC5mb250KCkKICAgICAgICBlbGlmIHNjZW5lIDo9IHNlbGYuc2NlbmUoKToKICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmZvbnQoKQogICAgICAgIGVsaWYgYXBwIDo9IFFBcHBsaWNhdGlvbi5pbnN0YW5jZSgpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFwcCwgUUd1aUFwcGxpY2F0aW9uKToKICAgICAgICAgICAgICAgIHJldHVybiBhcHAuZm9udCgpCgogICAgICAgIHJldHVybiBRRm9udCgpCgogICAgZGVmIHBhbGV0dGUoc2VsZikgLT4gUVBhbGV0dGU6CiAgICAgICAgaWYgcGFsZXR0ZSA6PSBnZXRhdHRyKHNlbGYsICJfcGFsZXR0ZSIsIE5vbmUpOgogICAgICAgICAgICByZXR1cm4gcGFsZXR0ZQogICAgICAgIGVsaWYgcGFyZW50V2lkZ2V0IDo9IHNlbGYucGFyZW50V2lkZ2V0KCk6CiAgICAgICAgICAgIHJldHVybiBwYXJlbnRXaWRnZXQucGFsZXR0ZSgpCiAgICAgICAgZWxpZiBzY2VuZSA6PSBzZWxmLnNjZW5lKCk6CiAgICAgICAgICAgIHJldHVybiBzY2VuZS5wYWxldHRlKCkKICAgICAgICBlbGlmIGFwcCA6PSBRQXBwbGljYXRpb24uaW5zdGFuY2UoKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhcHAsIFFHdWlBcHBsaWNhdGlvbik6CiAgICAgICAgICAgICAgICByZXR1cm4gYXBwLnBhbGV0dGUoKQoKICAgICAgICByZXR1cm4gUVBhbGV0dGUoKQoKICAgIGRlZiBicnVzaChzZWxmKToKICAgICAgICBiYXNlQ29sb3IgPSBzZWxmLnBhbGV0dGUoKS5iYXNlKCkuY29sb3IoKQogICAgICAgIGJhc2VDb2xvci5zZXRBbHBoYSgyNTUpCiAgICAgICAgYnJ1c2ggPSBRQnJ1c2goYmFzZUNvbG9yKQogICAgICAgIHJldHVybiBicnVzaAoKICAgIGRlZiBwZW4oc2VsZik6CiAgICAgICAgcGFsZXR0ZSA9IHNlbGYucGFsZXR0ZSgpCgogICAgICAgIHBlbiA9IFFQZW4ocGFsZXR0ZS50ZXh0KCkuY29sb3IoKSkKCiAgICAgICAgaWYgc2VsZi5pc1NlbGVjdGVkKCk6CiAgICAgICAgICAgIHBlbi5zZXRDb2xvcihwYWxldHRlLmhpZ2hsaWdodCgpLmNvbG9yKCkpICAjIENvbG9yIGZvciBzZWxlY3RlZAoKICAgICAgICBpZiBzZWxmLmlzSGlnaGxpZ2h0ZWQoKToKICAgICAgICAgICAgcGVuLnNldENvbG9yKHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkgICMgQ29sb3IgZm9yIGhvdmVyCgogICAgICAgIHJldHVybiBwZW4KCgpjbGFzcyBWZXJ0ZXhTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkEgZ3JhcGggJ1ZlcnRleCcgZ3JhcGhpY3MgaXRlbS4gbm8gaW5sZXRzIG9yIG91dGxldHMuIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgdGl0bGU6IHN0ciA9ICJOb2RlIiwKICAgICAgICBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhwYXJlbnQpCiAgICAgICAgIyBwcml2YXRlIHZhcmlhYmxlcwogICAgICAgIHNlbGYuX3RpdGxlOiBzdHIgPSB0aXRsZQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQ6IGJvb2wgPSBGYWxzZQoKICAgICAgICAjIEVuYWJsZSBzZWxlY3Rpb24gYW5kIG1vdmVtZW50CiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc01vdmFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc0ZvY3VzYWJsZSwgVHJ1ZSkKICAgICAgICBzZWxmLnNldEZsYWcoCiAgICAgICAgICAgIFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtU2VuZHNTY2VuZVBvc2l0aW9uQ2hhbmdlcwogICAgICAgICkKICAgICAgICBzZWxmLnNldEFjY2VwdEhvdmVyRXZlbnRzKFRydWUpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmIntzZWxmLl9fY2xhc3NfXy5fX25hbWVfX30oe3NlbGYuX3RpdGxlIXJ9KSIKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYmFzZUNvbG9yID0gc2VsZi5wYWxldHRlKCkuYmFzZSgpLmNvbG9yKCkKICAgICAgICBiYXNlQ29sb3Iuc2V0QWxwaGEoMjAwKQogICAgICAgIGJydXNoID0gUUJydXNoKGJhc2VDb2xvcikKICAgICAgICByZXR1cm4gYnJ1c2gKCiAgICBAb3ZlcnJpZGUKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQoKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fdGl0bGUpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHJldHVybiBRUmVjdEYoMCwgMCwgdGV4dF93aWR0aCArIDgsIHRleHRfaGVpZ2h0ICsgNCkKCiAgICBkZWYgcGFpbnQoCiAgICAgICAgc2VsZiwgcGFpbnRlcjogUVBhaW50ZXIsIG9wdGlvbjogUVN0eWxlT3B0aW9uR3JhcGhpY3NJdGVtLCB3aWRnZXQ9Tm9uZQogICAgKToKICAgICAgICBwYWludGVyLnNldEJydXNoKHNlbGYuYnJ1c2goKSkKICAgICAgICBwYWludGVyLnNldFBlbihzZWxmLnBlbigpKQogICAgICAgIHBhaW50ZXIuZHJhd1JvdW5kZWRSZWN0KHNlbGYuYm91bmRpbmdSZWN0KCksIDQsIDQpCgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQoNCwgZm0uaGVpZ2h0KCkgLSAxLCBzZWxmLl90aXRsZSkKCiAgICBkZWYgdGl0bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3RpdGxlCgogICAgZGVmIHNldFRpdGxlKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fdGl0bGUgPSB0ZXh0CiAgICAgICAgc2VsZi51cGRhdGUoKQoKCmNsYXNzIExpbmtTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkdyYXBoaWNzIGl0ZW0gcmVwcmVzZW50aW5nIGFuIGVkZ2UgaW4gYSBncmFwaC4iIiIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwgbGFiZWw6IHN0ciA9ICItbGluay0iLCBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZQogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1Ob25lKQogICAgICAgIHNlbGYuX2xhYmVsID0gbGFiZWwKCiAgICAgICAgIyBFbmFibGUgc2VsZWN0aW5nCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtSXNTZWxlY3RhYmxlKQogICAgICAgIHNlbGYuc2V0QWNjZXB0SG92ZXJFdmVudHMoVHJ1ZSkKICAgICAgICAjIHNlbGYuc2V0WlZhbHVlKC0xKQoKICAgICAgICBzZWxmLl9saW5lOiBRTGluZUYgPSBRTGluZUYoKQoKICAgICMgZGVmIHNldExpbmUoc2VsZiwgbGluZTogUUxpbmVGKToKICAgICMgICAgIHNlbGYucHJlcGFyZUdlb21ldHJ5Q2hhbmdlKCkKICAgICMgICAgIHNlbGYuX2xpbmUgPSBsaW5lCiAgICAjICAgICBzZWxmLnVwZGF0ZSgpCgogICAgIyBkZWYgX2xpbmUoc2VsZikgLT4gUUxpbmVGOgogICAgIyAgICAgcmV0dXJuIHNlbGYuX2xpbmUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYie3NlbGYuX19jbGFzc19fLl9fbmFtZV9ffSh7c2VsZi5fbGFiZWwhcn0pIgoKICAgIGRlZiBzZXRMYWJlbFRleHQoc2VsZiwgdGV4dDogc3RyKToKICAgICAgICBzZWxmLl9sYWJlbCA9IHRleHQKICAgICAgICBzZWxmLnVwZGF0ZSgpCgogICAgZGVmIGxhYmVsVGV4dChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbGFiZWwKCiAgICBkZWYgcGVuKHNlbGYpOgogICAgICAgICIiIm92ZXJyaWRlIHRvIGluZGljYXRlIGVuZHBvaW50cyB1bmRlciBtb3VzZSIiIgogICAgICAgIHBhbGV0dGUgPSBzZWxmLnBhbGV0dGUoKQoKICAgICAgICBwZW4gPSBRUGVuKHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCgogICAgICAgIGlmIHNlbGYuaXNTZWxlY3RlZCgpOgogICAgICAgICAgICBwZW4uc2V0Q29sb3IocGFsZXR0ZS5oaWdobGlnaHQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3Igc2VsZWN0ZWQKCiAgICAgICAgaWYgc2VsZi5pc0hpZ2hsaWdodGVkKCk6CiAgICAgICAgICAgIGlmIHNlbGYuX2hvdmVyTW91c2VQb3M6CiAgICAgICAgICAgICAgICBsaW5lYXJHcmFkID0gUUxpbmVhckdyYWRpZW50KHNlbGYuX2xpbmUucDEoKSwgc2VsZi5fbGluZS5wMigpKQogICAgICAgICAgICAgICAgZDEgPSBRTGluZUYoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXBGcm9tUGFyZW50KHNlbGYuX2xpbmUucDEoKSksIHNlbGYuX2hvdmVyTW91c2VQb3MKICAgICAgICAgICAgICAgICkubGVuZ3RoKCkKICAgICAgICAgICAgICAgIGQyID0gUUxpbmVGKAogICAgICAgICAgICAgICAgICAgIHNlbGYubWFwRnJvbVBhcmVudChzZWxmLl9saW5lLnAyKCkpLCBzZWxmLl9ob3Zlck1vdXNlUG9zCiAgICAgICAgICAgICAgICApLmxlbmd0aCgpCiAgICAgICAgICAgICAgICBpZiBkMSA8IGQyOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjAsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMC41LCBwYWxldHRlLmFjY2VudCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICAgICAgbGluZWFyR3JhZC5zZXRDb2xvckF0KDAuNTUsIHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjQ1LCBwYWxldHRlLnRleHQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjUsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMSwgcGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgcGVuLnNldEJydXNoKFFCcnVzaChsaW5lYXJHcmFkKSkgICMgQ29sb3IgZm9yIGhvdmVyCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwZW4uc2V0QnJ1c2gocGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3IgaG92ZXIKCiAgICAgICAgcmV0dXJuIHBlbgoKICAgIGRlZiBwYWludCgKICAgICAgICBzZWxmLCBwYWludGVyOiBRUGFpbnRlciwgb3B0aW9uOiBRU3R5bGVPcHRpb25HcmFwaGljc0l0ZW0sIHdpZGdldD1Ob25lCiAgICApOgogICAgICAgICMjIyBkcmF3IGFycm93IHNoYXBlCiAgICAgICAgYXJyb3dfc2hhcGUgPSBtYWtlQXJyb3dTaGFwZShzZWxmLl9saW5lLCBzZWxmLnBlbigpLndpZHRoRigpKQoKICAgICAgICAjIHVzZSB0aGUgcGVuIGFzIGJydXNoIHRvIGRyYXcgdGhlIGFycm93IHNoYXBlCiAgICAgICAgcGFpbnRlci5zZXRQZW4oUXQuUGVuU3R5bGUuTm9QZW4pCiAgICAgICAgcGFpbnRlci5zZXRCcnVzaChzZWxmLnBlbigpLmJydXNoKCkpCiAgICAgICAgcGFpbnRlci5kcmF3UGF0aChhcnJvd19zaGFwZSkKICAgICAgICBwYWludGVyLmRyYXdMaW5lKHNlbGYuX2xpbmUpCgogICAgICAgICMjIyBkcmF3IGxhYmVsCiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3VGV4dChzZWxmLl9saW5lLmNlbnRlcigpIC0gc2VsZi5wb3MoKSwgc2VsZi5fbGFiZWwpCgogICAgZGVmIHNoYXBlKHNlbGYpIC0+IFFQYWludGVyUGF0aDoKICAgICAgICAiIiJPdmVycmlkZSBzaGFwZSB0byBwcm92aWRlIGEgd2lkZXIgY2xpY2thYmxlIGFyZWEuIiIiCiAgICAgICAgcGF0aCA9IFFQYWludGVyUGF0aCgpCiAgICAgICAgcGF0aC5tb3ZlVG8oc2VsZi5fbGluZS5wMSgpKQogICAgICAgIHBhdGgubGluZVRvKHNlbGYuX2xpbmUucDIoKSkKICAgICAgICBzdHJva2VyID0gUVBhaW50ZXJQYXRoU3Ryb2tlcigpCiAgICAgICAgc3Ryb2tlci5zZXRXaWR0aCgxMCkKICAgICAgICBzdHJva2VyLnNldENhcFN0eWxlKFF0LlBlbkNhcFN0eWxlLlJvdW5kQ2FwKQogICAgICAgIHN0cm9rZXIuc2V0Sm9pblN0eWxlKFF0LlBlbkpvaW5TdHlsZS5Sb3VuZEpvaW4pCiAgICAgICAgcmV0dXJuIHN0cm9rZXIuY3JlYXRlU3Ryb2tlKHBhdGgpCgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHRleHRfd2lkdGggPSBmbS5ob3Jpem9udGFsQWR2YW5jZShzZWxmLl9sYWJlbCkKICAgICAgICB0ZXh0X2hlaWdodCA9IGZtLmhlaWdodCgpCgogICAgICAgIHNoYXBlX2Jib3ggPSBzZWxmLnNoYXBlKCkuYm91bmRpbmdSZWN0KCkKICAgICAgICB0ZXh0X2Jib3ggPSBRUmVjdEYoCiAgICAgICAgICAgIHNlbGYuX2xpbmUuY2VudGVyKCkgLSBzZWxmLnBvcygpIC0gUVBvaW50RigwLCB0ZXh0X2hlaWdodCksCiAgICAgICAgICAgIFFTaXplRih0ZXh0X3dpZHRoLCB0ZXh0X2hlaWdodCksCiAgICAgICAgKQoKICAgICAgICBtID0gc2VsZi5wZW4oKS53aWR0aEYoKQogICAgICAgIHJldHVybiBzaGFwZV9iYm94LnVuaXRlZCh0ZXh0X2Jib3gpLmFkanVzdGVkKC1tLCAtbSwgbSwgbSkKCiAgICBkZWYgbW92ZSgKICAgICAgICBzZWxmLAogICAgICAgIHNvdXJjZV9ncmFwaGljc19pdGVtOiBRR3JhcGhpY3NJdGVtIHwgUVBhaW50ZXJQYXRoIHwgUVJlY3RGIHwgUVBvaW50RiwKICAgICAgICB0YXJnZXRfZ3JhcGhpY3NfaXRlbTogUUdyYXBoaWNzSXRlbSB8IFFQYWludGVyUGF0aCB8IFFSZWN0RiB8IFFQb2ludEYsCiAgICApOgogICAgICAgIGxpbmUgPSBtYWtlTGluZUJldHdlZW5TaGFwZXMoc291cmNlX2dyYXBoaWNzX2l0ZW0sIHRhcmdldF9ncmFwaGljc19pdGVtKQogICAgICAgIGxlbmd0aCA9IGxpbmUubGVuZ3RoKCkKICAgICAgICBpZiBsZW5ndGggPiAwOgogICAgICAgICAgICBvZmZzZXQgPSBtaW4oOCwgbGVuZ3RoIC8gMikKICAgICAgICAgICAgbGluZSA9IFFMaW5lRigKICAgICAgICAgICAgICAgIGxpbmUucG9pbnRBdChvZmZzZXQgLyBsZW5ndGgpLAogICAgICAgICAgICAgICAgbGluZS5wb2ludEF0KChsZW5ndGggLSBvZmZzZXQpIC8gbGVuZ3RoKSwKICAgICAgICAgICAgKQoKICAgICAgICBzZWxmLnByZXBhcmVHZW9tZXRyeUNoYW5nZSgpCiAgICAgICAgc2VsZi5fbGluZSA9IGxpbmUKICAgICAgICBzZWxmLnVwZGF0ZSgpCgoKY2xhc3MgTm9kZVNoYXBlKFZlcnRleFNoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0aXRsZSwgaW5sZXRzLCBvdXRsZXRzLCBwYXJlbnQ9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyh0aXRsZT10aXRsZSwgcGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9pbmxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYuX291dGxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYucG9ydHNfbWFyZ2luID0gLTUKCiAgICAgICAgZm9yIGlubGV0IGluIGlubGV0czoKICAgICAgICAgICAgc2VsZi5fYWRkSW5sZXQoaW5sZXQpCiAgICAgICAgZm9yIG91dGxldCBpbiBvdXRsZXRzOgogICAgICAgICAgICBzZWxmLl9hZGRPdXRsZXQob3V0bGV0KQoKICAgICAgICBzZWxmLnBvcnRzX21hcmdpbiA9IC00MAoKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIHN1cGVyKCkKICAgICAgICAgICAgLmJvdW5kaW5nUmVjdCgpCiAgICAgICAgICAgIC51bml0ZWQoc2VsZi5jaGlsZHJlbkJvdW5kaW5nUmVjdCgpKQogICAgICAgICAgICAuYWRqdXN0ZWQoLTQsIDAsIDQsIDIpCiAgICAgICAgKQoKICAgIGRlZiBfYWRkSW5sZXQoc2VsZiwgaW5sZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBpbmxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIHNlbGYuX2lubGV0cy5hcHBlbmQoaW5sZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX3JlbW92ZUlubGV0KHNlbGYsIGlubGV0X3dpZGdldDogUUdyYXBoaWNzSXRlbSk6CiAgICAgICAgc2VsZi5faW5sZXRzLnJlbW92ZShpbmxldF93aWRnZXQpCiAgICAgICAgaWYgc2NlbmUgOj0gaW5sZXRfd2lkZ2V0LnNjZW5lKCk6CiAgICAgICAgICAgIHNjZW5lLnJlbW92ZUl0ZW0oaW5sZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX2FkZE91dGxldChzZWxmLCBvdXRsZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBvdXRsZXRfd2lkZ2V0LnNldFBhcmVudEl0ZW0oc2VsZikKICAgICAgICBzZWxmLl9vdXRsZXRzLmFwcGVuZChvdXRsZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX3JlbW92ZU91dGxldChzZWxmLCBvdXRsZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBzZWxmLl9vdXRsZXRzLnJlbW92ZShvdXRsZXRfd2lkZ2V0KQogICAgICAgIG91dGxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIGlmIHNjZW5lIDo9IG91dGxldF93aWRnZXQuc2NlbmUoKToKICAgICAgICAgICAgc2NlbmUucmVtb3ZlSXRlbShvdXRsZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgbGF5b3V0UG9ydHMoc2VsZik6CiAgICAgICAgeSA9IDE0ICAjIGhlYWRlciBoZWlnaG4KICAgICAgICBmb3IgaW5sZXRfd2lkZ2V0IGluIHNlbGYuX2lubGV0czoKICAgICAgICAgICAgaW5sZXRfd2lkZ2V0LnNldFBvcyg0LCB5KQogICAgICAgICAgICB5ICs9IGlubGV0X3dpZGdldC5ib3VuZGluZ1JlY3QoKS5oZWlnaHQoKQoKICAgICAgICBmb3Igb3V0bGV0X3dpZGdldCBpbiBzZWxmLl9vdXRsZXRzOgogICAgICAgICAgICBvdXRsZXRfd2lkZ2V0LnNldFBvcyg0LCB5KQogICAgICAgICAgICB5ICs9IG91dGxldF93aWRnZXQuYm91bmRpbmdSZWN0KCkuaGVpZ2h0KCkKCgpjbGFzcyBQb3J0U2hhcGUoQWJzdHJhY3RTaGFwZSk6CiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBsYWJlbDogc3RyLAogICAgICAgIHBhcmVudDogUUdyYXBoaWNzSXRlbSB8IE5vbmUgPSBOb25lLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1wYXJlbnQpCiAgICAgICAgc2VsZi5fbGFiZWwgPSBsYWJlbAoKICAgIGRlZiBsYWJlbChzZWxmKSAtPiBzdHI6CiAgICAgICAgcmV0dXJuIHNlbGYuX2xhYmVsCgogICAgZGVmIHNldExhYmVsKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fbGFiZWwgPSB0ZXh0CgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIGVsbGlwc2VfYmJveCA9IFFSZWN0RigwLCAwLCAxMCwgMTApCiAgICAgICAgdGV4dF93aWR0aCA9IGZtLmhvcml6b250YWxBZHZhbmNlKHNlbGYuX2xhYmVsKQogICAgICAgIHRleHRfaGVpZ2h0ID0gZm0uaGVpZ2h0KCkKCiAgICAgICAgdGV4dF9wb3MgPSBRUG9pbnRGKDEyLCAwKQogICAgICAgIHRleHRfYmJveCA9IFFSZWN0Rih0ZXh0X3BvcywgUVNpemVGKHRleHRfd2lkdGgsIHRleHRfaGVpZ2h0KSkKICAgICAgICByZXR1cm4gZWxsaXBzZV9iYm94LnVuaXRlZCh0ZXh0X2Jib3gpCgogICAgZGVmIHBhaW50KHNlbGYsIHBhaW50ZXIsIG9wdGlvbiwgd2lkZ2V0PU5vbmUpOgogICAgICAgICMjIyBkcmF3IGxhYmVsCiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0QnJ1c2goc2VsZi5icnVzaCgpKQogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3RWxsaXBzZShRUmVjdEYoMiwgNywgNiwgNikpCgogICAgICAgIHRleHRfaGVpZ2h0ID0gZm0uaGVpZ2h0KCkKICAgICAgICB0ZXh0X3BvcyA9IFFQb2ludEYoMTIsIHRleHRfaGVpZ2h0IC0gMikKICAgICAgICBwYWludGVyLmRyYXdUZXh0KHRleHRfcG9zLCBzZWxmLl9sYWJlbCkKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaW1wb3J0IHN5cwoKICAgIGFwcCA9IFFBcHBsaWNhdGlvbihzeXMuYXJndikKCiAgICBncmFwaHZpZXcgPSBRR3JhcGhpY3NWaWV3KCkKICAgIGdyYXBodmlldy5zZXRXaW5kb3dUaXRsZSgiSHJhcGhpY3NJdGVtIGZvciBOb2RlRWRpdG9yIikKICAgIGdyYXBodmlldy5zZXRSZW5kZXJIaW50KFFQYWludGVyLlJlbmRlckhpbnQuQW50aWFsaWFzaW5nLCBUcnVlKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5UZXh0QW50aWFsaWFzaW5nLCBUcnVlKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5TbW9vdGhQaXhtYXBUcmFuc2Zvcm0sIFRydWUpCgogICAgIyBjcmVhdGUgZ3JhcGggc2NlbmUKICAgIGdyYXBoc2NlbmUgPSBRR3JhcGhpY3NTY2VuZSgpCiAgICBncmFwaHNjZW5lLnNldFNjZW5lUmVjdChRUmVjdEYoLTQwMCwgLTQwMCwgODAwLCA4MDApKQogICAgZ3JhcGh2aWV3LnNldFNjZW5lKGdyYXBoc2NlbmUpCgogICAgIyMgY3JlYXRlIGdyYXBoaWNzCiAgICB2ZXJ0ZXhfaXRlbV8xID0gVmVydGV4U2hhcGUoIkdyYXBoaWNzVmVydGV4SXRlbTEiKQogICAgZ3JhcGhzY2VuZS5hZGRJdGVtKHZlcnRleF9pdGVtXzEpCiAgICB2ZXJ0ZXhfaXRlbV8xLnNldFBvcygwLCAtMTUwKQoKICAgIG5vZGVfaXRlbV8xID0gTm9kZVNoYXBlKAogICAgICAgICJHcmFwaGljc05vZGVJdGVtMSIsCiAgICAgICAgaW5sZXRzPVtQb3J0U2hhcGUoIkdyYXBoaWNzUG9ydEl0ZW1tIildLAogICAgICAgIG91dGxldHM9W1BvcnRTaGFwZSgiR3JhcGhpY3NQb3J0SXRlbSIpXSwKICAgICkKICAgIGdyYXBoc2NlbmUuYWRkSXRlbShub2RlX2l0ZW1fMSkKICAgIG5vZGVfaXRlbV8xLnNldFBvcygwLCAtMTIwKQoKICAgIGxpbmtfaXRlbV8xID0gTGlua1NoYXBlKCJsaW5rMSIpCiAgICBsaW5rX2l0ZW1fMS5tb3ZlKFFQb2ludEYoMCwgLTUwKSwgUVBvaW50RigxMDAsIC0yMCkpCiAgICBncmFwaHNjZW5lLmFkZEl0ZW0obGlua19pdGVtXzEpCgogICAgZ3JhcGh2aWV3LnNob3coKQogICAgYXBwLmV4ZWMoKQo",
					"AQAAAAAAAAABAAAAwyUAAAAAAADDJQAAAAAAAAAAAAAAAPC/"
				],
				[
					729,
					1,
					"black",
					{
						"use_selection": false
					},
					"AQAAAAAAAAAAAAAAaTIAAAAAAABpMgAAIyMjIyMjIyMjIyMjIyMjIyMjCiMgR1JBUEhJQ1MgSVRFTVMgIwojIyMjIyMjIyMjIyMjIyMjIyMKCiMgUUdyYXBoaWNzSXRlbSBzaGFwZXMuIHB1cmVseSB2aXN1YWwsIGJ1dCBpbnRlcmFjdGl2ZS4KIyB0aGVzIGFyZSB0aGUgc3VwZXJjbGFzcyBvZiB0aGUgTW9kZWxWaWV3IFdpZGdldHMgZm9yIHRoZSBOWEdyYXBoU2NlbmUKIyB0aGVyIGFyZSBubyBzdXBwb3NlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBtb2RlbCBpbiBhbnkgd2F5CiMgcmVzcG9uc2libGUgdG8gcGFpbnQgdWkgaXRlbXMsCiMgYW5kIGNhbiByZWFjdCB0byBtb3VzZSBvciBrZXlib2FyZCBldmVudCwgc3RyaWN0bHkgaW4gYSB2b3N1YWwgd2F5LgojIGluIE1WQyB0aGVzZSB3b3VsZCBiZSB0aGUgdmlld3MuCiMgaW4gUVQgTW9kZWxWaWV3IHRlcm1pbm9sb2d5IHRoZXNlIGFyZSBzZWxmIGNvbnRhaW5lZCB3aWRnZXRzLAojIHRoYXQgY2FuIGJlIHVzZWQgYnkgdGhlICdWaWV3cycKCgpmcm9tIHR5cGluZyBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRHdWkgaW1wb3J0ICoKZnJvbSBQeVNpZGU2LlF0Q29yZSBpbXBvcnQgKgpmcm9tIFB5U2lkZTYuUXRXaWRnZXRzIGltcG9ydCAqCgpmcm9tIHB5bGl2ZS5RdEdyYXBoRWRpdG9yLnFncmFwaGljc19hcnJvd19pdGVtIGltcG9ydCAoCiAgICBtYWtlQXJyb3dTaGFwZSwKKQpmcm9tIHB5bGl2ZS51dGlscy5nZW8gaW1wb3J0IG1ha2VMaW5lQmV0d2VlblNoYXBlcwoKCmNsYXNzIEFic3RyYWN0U2hhcGUoUUdyYXBoaWNzSXRlbSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcGFyZW50PU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18ocGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLnNldEZsYWcoUUdyYXBoaWNzSXRlbS5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUpCiAgICAgICAgc2VsZi5zZXRBY2NlcHRIb3ZlckV2ZW50cyhUcnVlKQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQgPSBGYWxzZQogICAgICAgIHNlbGYuX2hvdmVyTW91c2VQb3M6IFFQb2ludEYgfCBOb25lID0gTm9uZQoKICAgIGRlZiBzZXRIaWdobGlnaHRlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgc2VsZi5faXNIaWdobGlnaHRlZCA9IHZhbHVlCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBpc0hpZ2hsaWdodGVkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9pc0hpZ2hsaWdodGVkCgogICAgZGVmIGhvdmVyRW50ZXJFdmVudChzZWxmLCBldmVudDogUUdyYXBoaWNzU2NlbmVIb3ZlckV2ZW50KToKICAgICAgICBzZWxmLnNldEhpZ2hsaWdodGVkKFRydWUpCgogICAgZGVmIGhvdmVyTW92ZUV2ZW50KHNlbGYsIGV2ZW50OiBRR3JhcGhpY3NTY2VuZUhvdmVyRXZlbnQpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5faG92ZXJNb3VzZVBvcyA9IGV2ZW50LnBvcygpCiAgICAgICAgc2VsZi51cGRhdGUoKQoKICAgIGRlZiBob3ZlckxlYXZlRXZlbnQoc2VsZiwgZXZlbnQ6IFFHcmFwaGljc1NjZW5lSG92ZXJFdmVudCk6CiAgICAgICAgc2VsZi5zZXRIaWdobGlnaHRlZChGYWxzZSkKCiAgICBkZWYgZm9udChzZWxmKToKICAgICAgICBpZiBmb250IDo9IGdldGF0dHIoc2VsZiwgIl9mb250IiwgTm9uZSk6CiAgICAgICAgICAgIHJldHVybiBmb250CiAgICAgICAgZWxpZiBwYXJlbnRXaWRnZXQgOj0gc2VsZi5wYXJlbnRXaWRnZXQoKToKICAgICAgICAgICAgcmV0dXJuIHBhcmVudFdpZGdldC5mb250KCkKICAgICAgICBlbGlmIHNjZW5lIDo9IHNlbGYuc2NlbmUoKToKICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmZvbnQoKQogICAgICAgIGVsaWYgYXBwIDo9IFFBcHBsaWNhdGlvbi5pbnN0YW5jZSgpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFwcCwgUUd1aUFwcGxpY2F0aW9uKToKICAgICAgICAgICAgICAgIHJldHVybiBhcHAuZm9udCgpCgogICAgICAgIHJldHVybiBRRm9udCgpCgogICAgZGVmIHBhbGV0dGUoc2VsZikgLT4gUVBhbGV0dGU6CiAgICAgICAgaWYgcGFsZXR0ZSA6PSBnZXRhdHRyKHNlbGYsICJfcGFsZXR0ZSIsIE5vbmUpOgogICAgICAgICAgICByZXR1cm4gcGFsZXR0ZQogICAgICAgIGVsaWYgcGFyZW50V2lkZ2V0IDo9IHNlbGYucGFyZW50V2lkZ2V0KCk6CiAgICAgICAgICAgIHJldHVybiBwYXJlbnRXaWRnZXQucGFsZXR0ZSgpCiAgICAgICAgZWxpZiBzY2VuZSA6PSBzZWxmLnNjZW5lKCk6CiAgICAgICAgICAgIHJldHVybiBzY2VuZS5wYWxldHRlKCkKICAgICAgICBlbGlmIGFwcCA6PSBRQXBwbGljYXRpb24uaW5zdGFuY2UoKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhcHAsIFFHdWlBcHBsaWNhdGlvbik6CiAgICAgICAgICAgICAgICByZXR1cm4gYXBwLnBhbGV0dGUoKQoKICAgICAgICByZXR1cm4gUVBhbGV0dGUoKQoKICAgIGRlZiBicnVzaChzZWxmKToKICAgICAgICBiYXNlQ29sb3IgPSBzZWxmLnBhbGV0dGUoKS5iYXNlKCkuY29sb3IoKQogICAgICAgIGJhc2VDb2xvci5zZXRBbHBoYSgyNTUpCiAgICAgICAgYnJ1c2ggPSBRQnJ1c2goYmFzZUNvbG9yKQogICAgICAgIHJldHVybiBicnVzaAoKICAgIGRlZiBwZW4oc2VsZik6CiAgICAgICAgcGFsZXR0ZSA9IHNlbGYucGFsZXR0ZSgpCgogICAgICAgIHBlbiA9IFFQZW4ocGFsZXR0ZS50ZXh0KCkuY29sb3IoKSkKCiAgICAgICAgaWYgc2VsZi5pc1NlbGVjdGVkKCk6CiAgICAgICAgICAgIHBlbi5zZXRDb2xvcihwYWxldHRlLmhpZ2hsaWdodCgpLmNvbG9yKCkpICAjIENvbG9yIGZvciBzZWxlY3RlZAoKICAgICAgICBpZiBzZWxmLmlzSGlnaGxpZ2h0ZWQoKToKICAgICAgICAgICAgcGVuLnNldENvbG9yKHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkgICMgQ29sb3IgZm9yIGhvdmVyCgogICAgICAgIHJldHVybiBwZW4KCgpjbGFzcyBWZXJ0ZXhTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkEgZ3JhcGggJ1ZlcnRleCcgZ3JhcGhpY3MgaXRlbS4gbm8gaW5sZXRzIG9yIG91dGxldHMuIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgdGl0bGU6IHN0ciA9ICJOb2RlIiwKICAgICAgICBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhwYXJlbnQpCiAgICAgICAgIyBwcml2YXRlIHZhcmlhYmxlcwogICAgICAgIHNlbGYuX3RpdGxlOiBzdHIgPSB0aXRsZQogICAgICAgIHNlbGYuX2lzSGlnaGxpZ2h0ZWQ6IGJvb2wgPSBGYWxzZQoKICAgICAgICAjIEVuYWJsZSBzZWxlY3Rpb24gYW5kIG1vdmVtZW50CiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc1NlbGVjdGFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc01vdmFibGUsIFRydWUpCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc1dpZGdldC5HcmFwaGljc0l0ZW1GbGFnLkl0ZW1Jc0ZvY3VzYWJsZSwgVHJ1ZSkKICAgICAgICBzZWxmLnNldEZsYWcoCiAgICAgICAgICAgIFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtU2VuZHNTY2VuZVBvc2l0aW9uQ2hhbmdlcwogICAgICAgICkKICAgICAgICBzZWxmLnNldEFjY2VwdEhvdmVyRXZlbnRzKFRydWUpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmIntzZWxmLl9fY2xhc3NfXy5fX25hbWVfX30oe3NlbGYuX3RpdGxlIXJ9KSIKCiAgICBkZWYgYnJ1c2goc2VsZik6CiAgICAgICAgYmFzZUNvbG9yID0gc2VsZi5wYWxldHRlKCkuYmFzZSgpLmNvbG9yKCkKICAgICAgICBiYXNlQ29sb3Iuc2V0QWxwaGEoMjAwKQogICAgICAgIGJydXNoID0gUUJydXNoKGJhc2VDb2xvcikKICAgICAgICByZXR1cm4gYnJ1c2gKCiAgICBAb3ZlcnJpZGUKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQoKICAgICAgICB0ZXh0X3dpZHRoID0gZm0uaG9yaXpvbnRhbEFkdmFuY2Uoc2VsZi5fdGl0bGUpCiAgICAgICAgdGV4dF9oZWlnaHQgPSBmbS5oZWlnaHQoKQogICAgICAgIHJldHVybiBRUmVjdEYoMCwgMCwgdGV4dF93aWR0aCArIDgsIHRleHRfaGVpZ2h0ICsgNCkKCiAgICBkZWYgcGFpbnQoCiAgICAgICAgc2VsZiwgcGFpbnRlcjogUVBhaW50ZXIsIG9wdGlvbjogUVN0eWxlT3B0aW9uR3JhcGhpY3NJdGVtLCB3aWRnZXQ9Tm9uZQogICAgKToKICAgICAgICBwYWludGVyLnNldEJydXNoKHNlbGYuYnJ1c2goKSkKICAgICAgICBwYWludGVyLnNldFBlbihzZWxmLnBlbigpKQogICAgICAgIHBhaW50ZXIuZHJhd1JvdW5kZWRSZWN0KHNlbGYuYm91bmRpbmdSZWN0KCksIDQsIDQpCgogICAgICAgIGZtID0gUUZvbnRNZXRyaWNzKHNlbGYuZm9udCgpKQogICAgICAgIHBhaW50ZXIuZHJhd1RleHQoNCwgZm0uaGVpZ2h0KCkgLSAxLCBzZWxmLl90aXRsZSkKCiAgICBkZWYgdGl0bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3RpdGxlCgogICAgZGVmIHNldFRpdGxlKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fdGl0bGUgPSB0ZXh0CiAgICAgICAgc2VsZi51cGRhdGUoKQoKCmNsYXNzIExpbmtTaGFwZShBYnN0cmFjdFNoYXBlKToKICAgICIiIkdyYXBoaWNzIGl0ZW0gcmVwcmVzZW50aW5nIGFuIGVkZ2UgaW4gYSBncmFwaC4iIiIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwgbGFiZWw6IHN0ciA9ICItbGluay0iLCBwYXJlbnQ6IFFHcmFwaGljc0l0ZW0gfCBOb25lID0gTm9uZQogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1Ob25lKQogICAgICAgIHNlbGYuX2xhYmVsID0gbGFiZWwKCiAgICAgICAgIyBFbmFibGUgc2VsZWN0aW5nCiAgICAgICAgc2VsZi5zZXRGbGFnKFFHcmFwaGljc0l0ZW0uR3JhcGhpY3NJdGVtRmxhZy5JdGVtSXNTZWxlY3RhYmxlKQogICAgICAgIHNlbGYuc2V0QWNjZXB0SG92ZXJFdmVudHMoVHJ1ZSkKICAgICAgICAjIHNlbGYuc2V0WlZhbHVlKC0xKQoKICAgICAgICBzZWxmLl9saW5lOiBRTGluZUYgPSBRTGluZUYoKQoKICAgICMgZGVmIHNldExpbmUoc2VsZiwgbGluZTogUUxpbmVGKToKICAgICMgICAgIHNlbGYucHJlcGFyZUdlb21ldHJ5Q2hhbmdlKCkKICAgICMgICAgIHNlbGYuX2xpbmUgPSBsaW5lCiAgICAjICAgICBzZWxmLnVwZGF0ZSgpCgogICAgIyBkZWYgX2xpbmUoc2VsZikgLT4gUUxpbmVGOgogICAgIyAgICAgcmV0dXJuIHNlbGYuX2xpbmUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYie3NlbGYuX19jbGFzc19fLl9fbmFtZV9ffSh7c2VsZi5fbGFiZWwhcn0pIgoKICAgIGRlZiBzZXRMYWJlbFRleHQoc2VsZiwgdGV4dDogc3RyKToKICAgICAgICBzZWxmLl9sYWJlbCA9IHRleHQKICAgICAgICBzZWxmLnVwZGF0ZSgpCgogICAgZGVmIGxhYmVsVGV4dChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbGFiZWwKCiAgICBkZWYgcGVuKHNlbGYpOgogICAgICAgICIiIm92ZXJyaWRlIHRvIGluZGljYXRlIGVuZHBvaW50cyB1bmRlciBtb3VzZSIiIgogICAgICAgIHBhbGV0dGUgPSBzZWxmLnBhbGV0dGUoKQoKICAgICAgICBwZW4gPSBRUGVuKHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCgogICAgICAgIGlmIHNlbGYuaXNTZWxlY3RlZCgpOgogICAgICAgICAgICBwZW4uc2V0Q29sb3IocGFsZXR0ZS5oaWdobGlnaHQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3Igc2VsZWN0ZWQKCiAgICAgICAgaWYgc2VsZi5pc0hpZ2hsaWdodGVkKCk6CiAgICAgICAgICAgIGlmIHNlbGYuX2hvdmVyTW91c2VQb3M6CiAgICAgICAgICAgICAgICBsaW5lYXJHcmFkID0gUUxpbmVhckdyYWRpZW50KHNlbGYuX2xpbmUucDEoKSwgc2VsZi5fbGluZS5wMigpKQogICAgICAgICAgICAgICAgZDEgPSBRTGluZUYoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXBGcm9tUGFyZW50KHNlbGYuX2xpbmUucDEoKSksIHNlbGYuX2hvdmVyTW91c2VQb3MKICAgICAgICAgICAgICAgICkubGVuZ3RoKCkKICAgICAgICAgICAgICAgIGQyID0gUUxpbmVGKAogICAgICAgICAgICAgICAgICAgIHNlbGYubWFwRnJvbVBhcmVudChzZWxmLl9saW5lLnAyKCkpLCBzZWxmLl9ob3Zlck1vdXNlUG9zCiAgICAgICAgICAgICAgICApLmxlbmd0aCgpCiAgICAgICAgICAgICAgICBpZiBkMSA8IGQyOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjAsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMC41LCBwYWxldHRlLmFjY2VudCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICAgICAgbGluZWFyR3JhZC5zZXRDb2xvckF0KDAuNTUsIHBhbGV0dGUudGV4dCgpLmNvbG9yKCkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjQ1LCBwYWxldHRlLnRleHQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgICAgIGxpbmVhckdyYWQuc2V0Q29sb3JBdCgwLjUsIHBhbGV0dGUuYWNjZW50KCkuY29sb3IoKSkKICAgICAgICAgICAgICAgICAgICBsaW5lYXJHcmFkLnNldENvbG9yQXQoMSwgcGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKQogICAgICAgICAgICAgICAgcGVuLnNldEJydXNoKFFCcnVzaChsaW5lYXJHcmFkKSkgICMgQ29sb3IgZm9yIGhvdmVyCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwZW4uc2V0QnJ1c2gocGFsZXR0ZS5hY2NlbnQoKS5jb2xvcigpKSAgIyBDb2xvciBmb3IgaG92ZXIKCiAgICAgICAgcmV0dXJuIHBlbgoKICAgIGRlZiBwYWludCgKICAgICAgICBzZWxmLCBwYWludGVyOiBRUGFpbnRlciwgb3B0aW9uOiBRU3R5bGVPcHRpb25HcmFwaGljc0l0ZW0sIHdpZGdldD1Ob25lCiAgICApOgogICAgICAgICMjIyBkcmF3IGFycm93IHNoYXBlCiAgICAgICAgYXJyb3dfc2hhcGUgPSBtYWtlQXJyb3dTaGFwZShzZWxmLl9saW5lLCBzZWxmLnBlbigpLndpZHRoRigpKQoKICAgICAgICAjIHVzZSB0aGUgcGVuIGFzIGJydXNoIHRvIGRyYXcgdGhlIGFycm93IHNoYXBlCiAgICAgICAgcGFpbnRlci5zZXRQZW4oUXQuUGVuU3R5bGUuTm9QZW4pCiAgICAgICAgcGFpbnRlci5zZXRCcnVzaChzZWxmLnBlbigpLmJydXNoKCkpCiAgICAgICAgcGFpbnRlci5kcmF3UGF0aChhcnJvd19zaGFwZSkKICAgICAgICBwYWludGVyLmRyYXdMaW5lKHNlbGYuX2xpbmUpCgogICAgICAgICMjIyBkcmF3IGxhYmVsCiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3VGV4dChzZWxmLl9saW5lLmNlbnRlcigpIC0gc2VsZi5wb3MoKSwgc2VsZi5fbGFiZWwpCgogICAgZGVmIHNoYXBlKHNlbGYpIC0+IFFQYWludGVyUGF0aDoKICAgICAgICAiIiJPdmVycmlkZSBzaGFwZSB0byBwcm92aWRlIGEgd2lkZXIgY2xpY2thYmxlIGFyZWEuIiIiCiAgICAgICAgcGF0aCA9IFFQYWludGVyUGF0aCgpCiAgICAgICAgcGF0aC5tb3ZlVG8oc2VsZi5fbGluZS5wMSgpKQogICAgICAgIHBhdGgubGluZVRvKHNlbGYuX2xpbmUucDIoKSkKICAgICAgICBzdHJva2VyID0gUVBhaW50ZXJQYXRoU3Ryb2tlcigpCiAgICAgICAgc3Ryb2tlci5zZXRXaWR0aCgxMCkKICAgICAgICBzdHJva2VyLnNldENhcFN0eWxlKFF0LlBlbkNhcFN0eWxlLlJvdW5kQ2FwKQogICAgICAgIHN0cm9rZXIuc2V0Sm9pblN0eWxlKFF0LlBlbkpvaW5TdHlsZS5Sb3VuZEpvaW4pCiAgICAgICAgcmV0dXJuIHN0cm9rZXIuY3JlYXRlU3Ryb2tlKHBhdGgpCgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHRleHRfd2lkdGggPSBmbS5ob3Jpem9udGFsQWR2YW5jZShzZWxmLl9sYWJlbCkKICAgICAgICB0ZXh0X2hlaWdodCA9IGZtLmhlaWdodCgpCgogICAgICAgIHNoYXBlX2Jib3ggPSBzZWxmLnNoYXBlKCkuYm91bmRpbmdSZWN0KCkKICAgICAgICB0ZXh0X2Jib3ggPSBRUmVjdEYoCiAgICAgICAgICAgIHNlbGYuX2xpbmUuY2VudGVyKCkgLSBzZWxmLnBvcygpIC0gUVBvaW50RigwLCB0ZXh0X2hlaWdodCksCiAgICAgICAgICAgIFFTaXplRih0ZXh0X3dpZHRoLCB0ZXh0X2hlaWdodCksCiAgICAgICAgKQoKICAgICAgICBtID0gc2VsZi5wZW4oKS53aWR0aEYoKQogICAgICAgIHJldHVybiBzaGFwZV9iYm94LnVuaXRlZCh0ZXh0X2Jib3gpLmFkanVzdGVkKC1tLCAtbSwgbSwgbSkKCiAgICBkZWYgbW92ZSgKICAgICAgICBzZWxmLAogICAgICAgIHNvdXJjZV9ncmFwaGljc19pdGVtOiBRR3JhcGhpY3NJdGVtIHwgUVBhaW50ZXJQYXRoIHwgUVJlY3RGIHwgUVBvaW50RiwKICAgICAgICB0YXJnZXRfZ3JhcGhpY3NfaXRlbTogUUdyYXBoaWNzSXRlbSB8IFFQYWludGVyUGF0aCB8IFFSZWN0RiB8IFFQb2ludEYsCiAgICApOgogICAgICAgIGxpbmUgPSBtYWtlTGluZUJldHdlZW5TaGFwZXMoc291cmNlX2dyYXBoaWNzX2l0ZW0sIHRhcmdldF9ncmFwaGljc19pdGVtKQogICAgICAgIGxlbmd0aCA9IGxpbmUubGVuZ3RoKCkKICAgICAgICBpZiBsZW5ndGggPiAwOgogICAgICAgICAgICBvZmZzZXQgPSBtaW4oOCwgbGVuZ3RoIC8gMikKICAgICAgICAgICAgbGluZSA9IFFMaW5lRigKICAgICAgICAgICAgICAgIGxpbmUucG9pbnRBdChvZmZzZXQgLyBsZW5ndGgpLAogICAgICAgICAgICAgICAgbGluZS5wb2ludEF0KChsZW5ndGggLSBvZmZzZXQpIC8gbGVuZ3RoKSwKICAgICAgICAgICAgKQoKICAgICAgICBzZWxmLnByZXBhcmVHZW9tZXRyeUNoYW5nZSgpCiAgICAgICAgc2VsZi5fbGluZSA9IGxpbmUKICAgICAgICBzZWxmLnVwZGF0ZSgpCgoKY2xhc3MgTm9kZVNoYXBlKFZlcnRleFNoYXBlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0aXRsZSwgaW5sZXRzLCBvdXRsZXRzLCBwYXJlbnQ9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyh0aXRsZT10aXRsZSwgcGFyZW50PXBhcmVudCkKICAgICAgICBzZWxmLl9pbmxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYuX291dGxldHM6IGxpc3RbUUdyYXBoaWNzSXRlbV0gPSBbXQogICAgICAgIHNlbGYucG9ydHNfbWFyZ2luID0gLTUKCiAgICAgICAgZm9yIGlubGV0IGluIGlubGV0czoKICAgICAgICAgICAgc2VsZi5fYWRkSW5sZXQoaW5sZXQpCiAgICAgICAgZm9yIG91dGxldCBpbiBvdXRsZXRzOgogICAgICAgICAgICBzZWxmLl9hZGRPdXRsZXQob3V0bGV0KQoKICAgICAgICBzZWxmLnBvcnRzX21hcmdpbiA9IC00MAoKICAgIGRlZiBib3VuZGluZ1JlY3Qoc2VsZikgLT4gUVJlY3RGOgogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIHN1cGVyKCkKICAgICAgICAgICAgLmJvdW5kaW5nUmVjdCgpCiAgICAgICAgICAgIC51bml0ZWQoc2VsZi5jaGlsZHJlbkJvdW5kaW5nUmVjdCgpKQogICAgICAgICAgICAuYWRqdXN0ZWQoLTQsIDAsIDQsIDIpCiAgICAgICAgKQoKICAgIGRlZiBfYWRkSW5sZXQoc2VsZiwgaW5sZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBpbmxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIHNlbGYuX2lubGV0cy5hcHBlbmQoaW5sZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX3JlbW92ZUlubGV0KHNlbGYsIGlubGV0X3dpZGdldDogUUdyYXBoaWNzSXRlbSk6CiAgICAgICAgc2VsZi5faW5sZXRzLnJlbW92ZShpbmxldF93aWRnZXQpCiAgICAgICAgaWYgc2NlbmUgOj0gaW5sZXRfd2lkZ2V0LnNjZW5lKCk6CiAgICAgICAgICAgIHNjZW5lLnJlbW92ZUl0ZW0oaW5sZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX2FkZE91dGxldChzZWxmLCBvdXRsZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBvdXRsZXRfd2lkZ2V0LnNldFBhcmVudEl0ZW0oc2VsZikKICAgICAgICBzZWxmLl9vdXRsZXRzLmFwcGVuZChvdXRsZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgX3JlbW92ZU91dGxldChzZWxmLCBvdXRsZXRfd2lkZ2V0OiBRR3JhcGhpY3NJdGVtKToKICAgICAgICBzZWxmLl9vdXRsZXRzLnJlbW92ZShvdXRsZXRfd2lkZ2V0KQogICAgICAgIG91dGxldF93aWRnZXQuc2V0UGFyZW50SXRlbShzZWxmKQogICAgICAgIGlmIHNjZW5lIDo9IG91dGxldF93aWRnZXQuc2NlbmUoKToKICAgICAgICAgICAgc2NlbmUucmVtb3ZlSXRlbShvdXRsZXRfd2lkZ2V0KQogICAgICAgIHNlbGYubGF5b3V0UG9ydHMoKQogICAgICAgIHNlbGYudXBkYXRlKCkKCiAgICBkZWYgbGF5b3V0UG9ydHMoc2VsZik6CiAgICAgICAgeSA9IDE0ICAjIGhlYWRlciBoZWlnaG4KICAgICAgICBmb3IgaW5sZXRfd2lkZ2V0IGluIHNlbGYuX2lubGV0czoKICAgICAgICAgICAgaW5sZXRfd2lkZ2V0LnNldFBvcyg0LCB5KQogICAgICAgICAgICB5ICs9IGlubGV0X3dpZGdldC5ib3VuZGluZ1JlY3QoKS5oZWlnaHQoKQoKICAgICAgICBmb3Igb3V0bGV0X3dpZGdldCBpbiBzZWxmLl9vdXRsZXRzOgogICAgICAgICAgICBvdXRsZXRfd2lkZ2V0LnNldFBvcyg0LCB5KQogICAgICAgICAgICB5ICs9IG91dGxldF93aWRnZXQuYm91bmRpbmdSZWN0KCkuaGVpZ2h0KCkKCgpjbGFzcyBQb3J0U2hhcGUoQWJzdHJhY3RTaGFwZSk6CiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBsYWJlbDogc3RyLAogICAgICAgIHBhcmVudDogUUdyYXBoaWNzSXRlbSB8IE5vbmUgPSBOb25lLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhcmVudD1wYXJlbnQpCiAgICAgICAgc2VsZi5fbGFiZWwgPSBsYWJlbAoKICAgIGRlZiBsYWJlbChzZWxmKSAtPiBzdHI6CiAgICAgICAgcmV0dXJuIHNlbGYuX2xhYmVsCgogICAgZGVmIHNldExhYmVsKHNlbGYsIHRleHQ6IHN0cik6CiAgICAgICAgc2VsZi5fbGFiZWwgPSB0ZXh0CgogICAgZGVmIGJvdW5kaW5nUmVjdChzZWxmKSAtPiBRUmVjdEY6CiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIGVsbGlwc2VfYmJveCA9IFFSZWN0RigwLCAwLCAxMCwgMTApCiAgICAgICAgdGV4dF93aWR0aCA9IGZtLmhvcml6b250YWxBZHZhbmNlKHNlbGYuX2xhYmVsKQogICAgICAgIHRleHRfaGVpZ2h0ID0gZm0uaGVpZ2h0KCkKCiAgICAgICAgdGV4dF9wb3MgPSBRUG9pbnRGKDEyLCAwKQogICAgICAgIHRleHRfYmJveCA9IFFSZWN0Rih0ZXh0X3BvcywgUVNpemVGKHRleHRfd2lkdGgsIHRleHRfaGVpZ2h0KSkKICAgICAgICByZXR1cm4gZWxsaXBzZV9iYm94LnVuaXRlZCh0ZXh0X2Jib3gpCgogICAgZGVmIHBhaW50KHNlbGYsIHBhaW50ZXIsIG9wdGlvbiwgd2lkZ2V0PU5vbmUpOgogICAgICAgICMjIyBkcmF3IGxhYmVsCiAgICAgICAgZm0gPSBRRm9udE1ldHJpY3Moc2VsZi5mb250KCkpCgogICAgICAgIHBhaW50ZXIuc2V0QnJ1c2goc2VsZi5icnVzaCgpKQogICAgICAgIHBhaW50ZXIuc2V0UGVuKHNlbGYucGVuKCkpCiAgICAgICAgcGFpbnRlci5kcmF3RWxsaXBzZShRUmVjdEYoMiwgNywgNiwgNikpCgogICAgICAgIHRleHRfaGVpZ2h0ID0gZm0uaGVpZ2h0KCkKICAgICAgICB0ZXh0X3BvcyA9IFFQb2ludEYoMTIsIHRleHRfaGVpZ2h0IC0gMikKICAgICAgICBwYWludGVyLmRyYXdUZXh0KHRleHRfcG9zLCBzZWxmLl9sYWJlbCkKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaW1wb3J0IHN5cwoKICAgIGFwcCA9IFFBcHBsaWNhdGlvbihzeXMuYXJndikKCiAgICBncmFwaHZpZXcgPSBRR3JhcGhpY3NWaWV3KCkKICAgIGdyYXBodmlldy5zZXRXaW5kb3dUaXRsZSgiSHJhcGhpY3NJdGVtIGZvciBOb2RlRWRpdG9yIikKICAgIGdyYXBodmlldy5zZXRSZW5kZXJIaW50KFFQYWludGVyLlJlbmRlckhpbnQuQW50aWFsaWFzaW5nLCBUcnVlKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5UZXh0QW50aWFsaWFzaW5nLCBUcnVlKQogICAgZ3JhcGh2aWV3LnNldFJlbmRlckhpbnQoUVBhaW50ZXIuUmVuZGVySGludC5TbW9vdGhQaXhtYXBUcmFuc2Zvcm0sIFRydWUpCgogICAgIyBjcmVhdGUgZ3JhcGggc2NlbmUKICAgIGdyYXBoc2NlbmUgPSBRR3JhcGhpY3NTY2VuZSgpCiAgICBncmFwaHNjZW5lLnNldFNjZW5lUmVjdChRUmVjdEYoLTQwMCwgLTQwMCwgODAwLCA4MDApKQogICAgZ3JhcGh2aWV3LnNldFNjZW5lKGdyYXBoc2NlbmUpCgogICAgIyMgY3JlYXRlIGdyYXBoaWNzCiAgICB2ZXJ0ZXhfaXRlbV8xID0gVmVydGV4U2hhcGUoIkdyYXBoaWNzVmVydGV4SXRlbTEiKQogICAgZ3JhcGhzY2VuZS5hZGRJdGVtKHZlcnRleF9pdGVtXzEpCiAgICB2ZXJ0ZXhfaXRlbV8xLnNldFBvcygwLCAtMTUwKQoKICAgIG5vZGVfaXRlbV8xID0gTm9kZVNoYXBlKAogICAgICAgICJHcmFwaGljc05vZGVJdGVtMSIsCiAgICAgICAgaW5sZXRzPVtQb3J0U2hhcGUoIkdyYXBoaWNzUG9ydEl0ZW1tIildLAogICAgICAgIG91dGxldHM9W1BvcnRTaGFwZSgiR3JhcGhpY3NQb3J0SXRlbSIpXSwKICAgICkKICAgIGdyYXBoc2NlbmUuYWRkSXRlbShub2RlX2l0ZW1fMSkKICAgIG5vZGVfaXRlbV8xLnNldFBvcygwLCAtMTIwKQoKICAgIGxpbmtfaXRlbV8xID0gTGlua1NoYXBlKCJsaW5rMSIpCiAgICBsaW5rX2l0ZW1fMS5tb3ZlKFFQb2ludEYoMCwgLTUwKSwgUVBvaW50RigxMDAsIC0yMCkpCiAgICBncmFwaHNjZW5lLmFkZEl0ZW0obGlua19pdGVtXzEpCgogICAgZ3JhcGh2aWV3LnNob3coKQogICAgYXBwLmV4ZWMoKQo",
					"AQAAAAAAAAABAAAAnycAAAAAAACfJwAAAAAAAAAAAAAAAPC/"
				]
			]
		}
	],
	"build_system": "Packages/Python/Python.sublime-build",
	"build_system_choices":
	[
		[
			[
				[
					"Packages/Python/Python.sublime-build",
					""
				],
				[
					"Packages/Python/Python.sublime-build",
					"Syntax Check"
				]
			],
			[
				"Packages/Python/Python.sublime-build",
				""
			]
		]
	],
	"build_varint": "",
	"command_palette":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"debu",
				"Debugger: Open"
			],
			[
				"debug",
				"Debugger: Open"
			],
			[
				"install",
				"Package Control: Install Package"
			],
			[
				"instal",
				"Package Control: Install Package"
			],
			[
				"pyrigth",
				"Preferences: LSP-pyright Settings"
			],
			[
				"remove",
				"Package Control: Remove Package"
			],
			[
				"inst",
				"Package Control: Install Package"
			],
			[
				"remov",
				"Package Control: Remove Package"
			],
			[
				"insta",
				"Package Control: Install Package"
			],
			[
				"termin",
				"Terminus: Toggle Panel"
			],
			[
				"terminus",
				"Terminus: Toggle Panel"
			],
			[
				"termi",
				"Terminus: Toggle Panel"
			],
			[
				"terminu",
				"Terminus: Close All"
			],
			[
				"instl",
				"Package Control: Install Package"
			],
			[
				"REMOE",
				"Package Control: Remove Package"
			],
			[
				"reinde",
				"Indentation: Reindent Lines"
			],
			[
				"reind",
				"Indentation: Reindent Lines"
			],
			[
				"enable",
				"Package Control: Enable Package"
			],
			[
				"package",
				"Package Control: Disable Package"
			],
			[
				"packa",
				"View Package File"
			]
		],
		"width": 0.0
	},
	"console":
	{
		"height": 0.0,
		"history":
		[
		]
	},
	"distraction_free":
	{
		"menu_visible": true,
		"show_minimap": false,
		"show_open_files": false,
		"show_tabs": false,
		"side_bar_visible": false,
		"status_bar_visible": false
	},
	"expanded_folders":
	[
		"/C/dev/src/pylive",
		"/C/dev/src/pylive/pylive"
	],
	"file_history":
	[
		"/C/dev/src/pylive/.venv/Lib/site-packages/networkx/classes/multidigraph.py",
		"/C/dev/src/pylive/pylive/QtTerminal/terminal_with_exec.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/NetrowkXGraphEditor/link_graphics_items.py",
		"/C/dev/src/pylive/pylive/NetworkXGraphEditor/nx_graph_graphics_items.py",
		"/C/dev/src/pylive/pylive/utils/geo.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/nx_graph_view.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/nx_inspector_view.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/nx_graph_model.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/nx_graph_graphics_scene.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/nx_graph_graphics_items.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/qtpy_nodeeditor.py",
		"/C/dev/src/pylive/pylive/utils/diff.py",
		"/C/dev/src/pylive/pylive/QtScriptEditor/components/jedi_completer.py",
		"/C/dev/src/pylive/expreiments/ipython/embedded_qtconsole.py",
		"/C/dev/src/pylive/expreiments/display_builtin_icons.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/nx_graph_selection_model.py",
		"/C/dev/src/pylive/tests/test_diff.py",
		"/C/dev/src/pylive/pylive/utils/unique.py",
		"/C/dev/src/pylive/pylive/utils/sugiyama_layout.py",
		"/C/dev/src/pylive/.venv/Lib/site-packages/networkx/drawing/layout.py",
		"/C/dev/src/pylive/pylive.sublime-project",
		"/C/dev/src/pylive/.venv/Lib/site-packages/networkx/classes/reportviews.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/nx_graph_graphics_scene_with_ports.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/NetrowkXGraphEditor/qgraphics_arrow_item.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/dag_graph_graphics_scene.py",
		"/C/dev/src/pylive/expreiments/qstyle_draw_ptimitive_elements.py",
		"/C/dev/src/pylive/tests/test_python_graphmodel.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/infinite_graphicsview_optimized.py",
		"/C/Users/andris/AppData/Local/Packages/PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0/LocalCache/local-packages/Python312/site-packages/PySide6/QtCore.pyi",
		"/C/dev/src/pylive/pylive/examples/python_function_graph/graph_view.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/node_connection_tool.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/text_widget.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/circle_widget.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/pin_connection_tool.py",
		"/C/dev/src/pylive/pylive/examples/python_function_graph/main.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/NetrowkXGraphEditor/graphview_with_delegate.py",
		"/C/dev/src/pylive/pylive/examples/python_function_graph/python_graph_model.py",
		"/C/Users/andris/Downloads/SideFX Houdini 20.5.278 x64 Win/readme.txt",
		"/C/Users/andris/Documents/Blender/Assets/blender_assets.cats.txt",
		"/C/dev/src/pylive/pyproject.toml",
		"/C/dev/src/pylive/pylive/QtGraphEditor/NetrowkXGraphditor/nx_graph_view.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/NetrowkXGraphditor/standard_graph_delegate.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/NetrowkXGraphditor/link_graphics_items.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/graphmodel_databased.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/graphview_databased.py",
		"/C/dev/src/pylive/pylive/QtGraphEditor/NXGraphView.py",
		"/C/dev/src/pylive/expreiments/built-a-dependency-graph-of-a-python-codebase.py",
		"/C/dev/src/pylive/pylive/QtLiveApp/live_script_with_exec.py",
		"/C/dev/src/pylive/pylive/QtLiveApp/live_script_skeleton.py",
		"/C/dev/src/pylive/script_examples_to_run_live/text_processing.py",
		"/C/dev/src/pylive/pylive/QtLiveApp/live_graph_with_exec.py",
		"/C/dev/src/pylive/expreiments/run-script-in-terminal.py",
		"/C/Users/andris/AppData/Local/Sublime Text/Package Storage/LSP-pyright/18.15.0/language-server/node_modules/pyright/dist/typeshed-fallback/stdlib/pathlib.pyi",
		"/C/dev/src/pylive/expreiments/connect_to_ipython.py",
		"/C/dev/src/pylive/pylive/__main__.py",
		"/C/dev/src/pylive/expreiments/ipython/notebook_with_ipython.py",
		"/C/dev/src/pylive/expreiments/ipython/notbook_with_chatgpt.py",
		"/C/dev/src/pylive/tests/test_cells.py",
		"/C/dev/src/pylive/pylive/QtScriptEditor/cell_support.py",
		"/C/dev/src/pylive/pylive/QtScriptEditor/components/linter_widget.py",
		"/C/dev/src/pylive/pylive/QtScriptEditor/components/textedit_number_editor.py",
		"/C/dev/src/pylive/pylive/QtScriptEditor/script_edit.py",
		"/C/dev/src/pylive/TODOs.md",
		"/C/dev/src/pylive/script_examples_to_run_live/glcanvas_widget_with_moderngl.py",
		"/C/dev/src/pylive/pylive/QtTerminal/preview_widget.py",
		"/C/dev/src/pylive/pylive/render_engine/GLCanvasWidget_with_painting_signal.py",
		"/C/dev/src/pylive/pylive/QtLiveFramework/live_framework_with_exec.py",
		"/C/dev/src/pylive/expreiments/file_textdocument_link.py",
		"/E/__ANDRIS__/ART/_Applications_/Cynthia Lopez 7000 - 2024/Cynthia Lopez 7000.xlsx",
		"/C/dev/src/pylive/expreiments/glcanvas.py",
		"/C/dev/src/pylive/pylive/render_engine/regl/regl.py",
		"/C/dev/src/pylive/pylive/QtLiveFramework/live_framework_skeleton.py",
		"/C/dev/src/pylive/expreiments/GLCanvasWidget.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/glcanvas.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/GLWindow_with_qopengl.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/GLCanvasWidget_with_request_animation.py",
		"/C/dev/src/pylive/pylive/render_engine/utils/__init__.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/GLCanvasWidget-with_painting_signal.py",
		"/C/dev/src/pylive/pylive/render_engine/glwidget_with_moderngl.py",
		"/C/dev/src/pylive/expreiments/GLCanvasWindow.py",
		"/C/Users/andris/AppData/Local/Temp/2ea7c807-5541-48c5-9e23-9d4d4826a0ed_Microsoft Office 2021 Pro Plus.zip.0ed/Microsoft Office 2021 Pro Plus (365 + Patch/readme.txt",
		"/C/Users/andris/Downloads/Microsoft Office 2021 Pro Plus (365 ) + Patch/Microsoft Office 2021 Pro Plus/Microsoft Office 2021 Pro Plus (365 + Patch/readme.txt",
		"/C/dev/src/pylive/expreiments/opengl_boilerplate.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/pygame_moderngl_boilerplate.py",
		"/C/dev/src/pylive/expreiments/opengl_outside_window.py",
		"/C/dev/src/pylive/pylive/render_engine/orbit_control.py",
		"/C/dev/src/pylive/pylive/render_engine/lookAt_standalone.vert",
		"/C/dev/src/pylive/pylive/logwindow.py",
		"/C/dev/src/pylive/pylive/render_engine/render_layers.py",
		"/C/dev/src/pylive/pylive/shaders/billboard.vert",
		"/C/dev/src/pylive/pylive/render_engine/resource_manager.py",
		"/C/dev/src/pylive/pylive/render_engine/examples/1 render layers.py",
		"/C/dev/src/pylive/pylive/QtLiveFramework/live_framework_with_qtconsole.py",
		"/C/dev/src/pylive/expreiments/unified_titlebar.py",
		"/C/dev/src/pylive/pylive/render_engine/camera.py",
		"/C/dev/src/pylive/pylive/shaders/default_vertex_shader.vert",
		"/C/dev/src/pylive/pylive/shaders/flat_fragment_shader.frag",
		"/C/dev/src/pylive/pylive/examples/livescript.py",
		"/C/dev/src/pylive/gloo/render_layers.py",
		"/C/dev/src/pylive/gloo/gl_widget_with_moderngl.py",
		"/C/dev/src/pylive/gloo/camera.py",
		"/C/dev/src/pylive/my_gloo/camera.py",
		"/C/dev/src/pylive/my_gloo/gl_widget_with_moderngl.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/orbit_control.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/gl_widget_with_moderngl.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/gl_window_with_moderngl.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/rendering_with_qt.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/qpygletwidget.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/vispy_and_pyside_1.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/gl_widget (Not Working).py",
		"/C/dev/src/pylive/expreiments/3d_rendering/vispy_and_pyside_2.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/gl_canvas_with_moderngl.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/pyglet_on_QWidget.py",
		"/C/dev/src/pylive/expreiments/ipython/ipython_kernel.py",
		"/C/dev/src/pylive/expreiments/ipython/qtconsole_inprocess1.py",
		"/C/dev/src/pylive/expreiments/ipython/simple_console.py",
		"/C/dev/src/pylive/expreiments/simple_console.py",
		"/C/dev/src/pylive/expreiments/3d_rendering/gl_widget_gpt.py",
		"/C/dev/src/pylive/expreiments/ipython/notebook_with_qtconsole.py",
		"/C/dev/src/pylive/expreiments/live_framework.py",
		"/C/dev/src/pylive/pylive/QtScriptEditor/components/pygments_syntax_highlighter.py",
		"/C/dev/src/pylive/expreiments/ipython_kernel.py",
		"/C/dev/src/pylive/pylive/examples/livenotebook.py",
		"/C/Users/andris/AppData/Local/Packages/PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0/LocalCache/local-packages/Python312/site-packages/PySide6/QtGui.pyi",
		"/C/dev/src/pylive/expreiments/visualize_function_dependencies.py",
		"/C/dev/src/pylive/pylive/QtScriptEditor/components/pygments_syntax_highlighter_OLD.py",
		"/C/dev/src/pylive/pylive/QtScriptEditor/components/textedit_completer.py",
		"/C/dev/src/pylive/pylive/QtScriptEditor/components/WhitespaceHighlighter.py"
	],
	"find":
	{
		"height": 38.0
	},
	"find_in_files":
	{
		"height": 104.0,
		"where_history":
		[
			""
		]
	},
	"find_state":
	{
		"case_sensitive": false,
		"find_history":
		[
			"link.move",
			"move(",
			"move",
			"move(",
			"edges[",
			"move(",
			"import",
			"outletGraphicsObject(",
			"NXGraphModel",
			"modified",
			"LinkW",
			"hoverMoveEvent",
			"ConnectionEvent",
			"NodeWidget",
			"EdgeWidget",
			"change",
			"})\n",
			"handleEdgesRe",
			"nodespropertyChanged.emit",
			"Nodewidget",
			"gradient",
			"makeArrowS",
			"EdgeWidget",
			"addEdge",
			"EdgeWidget",
			"targetChanged",
			"NodeWidget",
			"makeLine",
			"setAccepted",
			"accept",
			"ConnectionDropType",
			"connectionEnterEvent",
			"AlignmentFlag",
			"print(",
			"nodeAt",
			"AttributesTable",
			"setLabelT",
			"size",
			"unchanged",
			"current",
			"print",
			"destroy",
			"_is_connection_entered",
			"QPen",
			"d1 <",
			"d1 >",
			"d2 >",
			"d2>",
			"d1",
			"            \"",
			"CC_CustomBase",
			"CE_ShapedFrame",
			"connectionDrop",
			"connectionDio",
			"_target",
			"ConnectionDropType",
			"connectionDropEvent",
			"]\n",
			"QStyle.PE_PanelMenu    48  The panel for a menu.\n",
			"ConnectionEvent",
			".map",
			"QTransform",
			"makeLineBetweenShapes",
			"print",
			"arrow",
			"line_between",
			"drag",
			"self.loop",
			"PinConnectionTool",
			"eventFilter",
			"edge",
			"edge.target",
			"edge.source",
			"edge.target",
			"setMouseTool",
			"self.connectionTool",
			"node",
			"EdgeConnectionEvent",
			"parent",
			"(\n",
			"block",
			"signal",
			"connected",
			"_edges",
			"removeEdge",
			"setSourceOutlet",
			"sceneGeome",
			"EdgeW",
			"updatePo",
			"contextmenu",
			"dagscene",
			"infini",
			"mousedouble",
			"selectionmodel",
			"handleSelectionChanged",
			"graph(",
			"result_sc",
			"finishConnection",
			"disconnected",
			"onDis",
			"handleNodesProp",
			"runScript",
			"createNodeWidget",
			"cell_at_line",
			"def instance",
			"instance",
			"setAttribute(",
			"setAttribute",
			"get_context",
			"QOpenGLWindow",
			"import QOpenGLWindow",
			"Literal",
			"literal",
			"Searching",
			"Lityeral",
			"dtype",
			"\t\t'",
			"internal_format",
			"dtype",
			"mode",
			"varyings_capture_mode",
			"internal_format",
			"dtype",
			"internal_format",
			"dtype",
			"internal_format",
			"varyings_capture_mode",
			"self"
		],
		"highlight": true,
		"in_selection": false,
		"preserve_case": false,
		"regex": false,
		"replace_history":
		[
			"LinkEvent",
			"VertexWidget",
			"LinkWidget",
			"ConnectionEvent",
			"interactive_edge_moving_pin",
			"interactive_edge_fixed_pin",
			"interactive_edge_moving_pin",
			"EdgeGraphicsItem",
			"InletGraphicsItem",
			"OutletGraphicsItem",
			"PinGraphicsItem",
			"EdgeRef",
			"OutletRef",
			"InletRef",
			"NodeRef",
			"EdgeRef",
			"OutletRef",
			"InletRef",
			"NodeRef",
			"OutletRef",
			"InletRef",
			"EdgeRef",
			"NodeRef",
			"EdgeDataColumn",
			"OutletDataColumn",
			"InletDataColumn",
			"NodeDataColumn",
			"EdgeView",
			"InletView",
			"OutletView",
			"self._edgeTable",
			"self._outletTable",
			"self._inletTable",
			"self._nodeTable"
		],
		"reverse": false,
		"scrollbar_highlights": true,
		"show_context": true,
		"use_buffer2": true,
		"use_gitignore": true,
		"whole_word": false,
		"wrap": true
	},
	"groups":
	[
		{
			"sheets":
			[
				{
					"buffer": 0,
					"file": "pylive/NetworkXGraphEditor/nx_network_scene.py",
					"selected": true,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 16231,
						"regions":
						{
						},
						"selection":
						[
							[
								13065,
								13065
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "<",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								},
								{
									"characters": ".[\"'",
									"selector": "meta.tag, source - comment - string.quoted.double.block - string.quoted.single.block - string.unquoted.heredoc",
									"server": "LSP-pyright"
								}
							],
							"lsp_active": true,
							"lsp_uri": "file:///C:/dev/src/pylive/pylive/NetworkXGraphEditor/nx_network_scene.py",
							"rulers":
							[
								80
							],
							"show_definitions": false,
							"syntax": "Packages/Python/Python.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true,
							"wrap_width": 80
						},
						"translation.x": 0.0,
						"translation.y": 5068.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 1,
					"file": "pylive/NetworkXGraphEditor/nx_graph_model.py",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 4437,
						"regions":
						{
						},
						"selection":
						[
							[
								3001,
								3001
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "<",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								},
								{
									"characters": ".[\"'",
									"selector": "meta.tag, source - comment - string.quoted.double.block - string.quoted.single.block - string.unquoted.heredoc",
									"server": "LSP-pyright"
								}
							],
							"lsp_active": true,
							"lsp_uri": "file:///C:/dev/src/pylive/pylive/NetworkXGraphEditor/nx_graph_model.py",
							"show_definitions": false,
							"syntax": "Packages/Python/Python.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 980.0,
						"zoom_level": 1.0
					},
					"stack_index": 1,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		},
		{
			"sheets":
			[
				{
					"buffer": 2,
					"file": "pylive/NetworkXGraphEditor/nx_graph_shapes.py",
					"selected": true,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 12905,
						"regions":
						{
						},
						"selection":
						[
							[
								10143,
								10143
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "<",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								},
								{
									"characters": ".[\"'",
									"selector": "meta.tag, source - comment - string.quoted.double.block - string.quoted.single.block - string.unquoted.heredoc",
									"server": "LSP-pyright"
								}
							],
							"lsp_active": true,
							"lsp_uri": "file:///C:/dev/src/pylive/pylive/NetworkXGraphEditor/nx_graph_shapes.py",
							"show_definitions": false,
							"syntax": "Packages/Python/Python.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 3864.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		}
	],
	"incremental_find":
	{
		"height": 23.0
	},
	"input":
	{
		"height": 40.0
	},
	"layout":
	{
		"cells":
		[
			[
				0,
				0,
				1,
				1
			],
			[
				1,
				0,
				2,
				1
			]
		],
		"cols":
		[
			0.0,
			0.441845147033,
			1.0
		],
		"rows":
		[
			0.0,
			1.0
		]
	},
	"menu_visible": true,
	"output.Debugger":
	{
		"height": 240.0
	},
	"output.Debugger Console":
	{
		"height": 240.0
	},
	"output.LSP Log Panel":
	{
		"height": 0.0
	},
	"output.SublimeLinter":
	{
		"height": 0.0
	},
	"output.Terminus":
	{
		"height": 412.0
	},
	"output.diagnostics":
	{
		"height": 0.0
	},
	"output.exec":
	{
		"height": 300.0
	},
	"output.find_results":
	{
		"height": 0.0
	},
	"output.mdpopups":
	{
		"height": 0.0
	},
	"pinned_build_system": "Python: Run File (CrossPlatform)",
	"project": "pylive.sublime-project",
	"replace":
	{
		"height": 42.0
	},
	"save_all_on_build": true,
	"select_file":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"graph model",
				"pylive\\NetworkXGraphEditor\\nx_graph_model.py"
			],
			[
				"nx graph mo",
				"pylive\\QtGraphEditor\\nx_graph_model.py"
			],
			[
				"icons",
				"expreiments\\display_builtin_icons.py"
			],
			[
				"nx graph",
				"pylive\\QtGraphEditor\\nx_graph_graphics_scene.py"
			],
			[
				"nxselection",
				"pylive\\QtGraphEditor\\nx_graph_selection_model.py"
			],
			[
				"nx graph graphics",
				"pylive\\QtGraphEditor\\nx_graph_graphics_scene.py"
			],
			[
				"nx graph grap",
				"pylive\\QtGraphEditor\\nx_graph_view.py"
			],
			[
				"nx gr",
				"pylive\\QtGraphEditor\\nx_graph_graphics_scene_with_ports.py"
			],
			[
				"nx",
				"pylive\\QtGraphEditor\\nx_graph_model.py"
			],
			[
				"arrowi",
				"pylive\\QtGraphEditor\\NetrowkXGraphEditor\\qgraphics_arrow_item.py"
			],
			[
				"link",
				"pylive\\QtGraphEditor\\NetrowkXGraphEditor\\link_graphics_items.py"
			],
			[
				"DagSc",
				"pylive\\QtGraphEditor\\dag_graph_graphics_scene.py"
			],
			[
				"nx graph s",
				"pylive\\QtGraphEditor\\nx_graph_selection_model.py"
			],
			[
				"dag graphics ",
				"pylive\\QtGraphEditor\\dag_graph_graphics_scene.py"
			],
			[
				"test py",
				"tests\\test_python_graphmodel.py"
			],
			[
				"python gr",
				"pylive\\examples\\python_function_graph\\python_graph_model.py"
			],
			[
				"main",
				"pylive\\examples\\python_function_graph\\main.py"
			],
			[
				"nxgraphmo",
				"pylive\\QtGraphEditor\\nx_graph_model.py"
			],
			[
				"standard",
				"pylive\\QtGraphEditor\\NetrowkXGraphditor\\standard_graph_delegate.py"
			],
			[
				"graphmodel",
				"pylive\\pylive\\QtGraphEditor\\graphmodel_databased.py"
			],
			[
				"graphview",
				"pylive\\pylive\\QtGraphEditor\\graphview_databased.py"
			],
			[
				"build-a",
				"pylive\\expreiments\\built-a-dependency-graph-of-a-python-codebase.py"
			],
			[
				"conne",
				"pylive\\expreiments\\connect_to_ipython.py"
			],
			[
				"number",
				"pylive\\pylive\\QtScriptEditor\\components\\textedit_number_editor.py"
			],
			[
				"lint",
				"pylive\\pylive\\QtScriptEditor\\components\\linter_widget.py"
			],
			[
				"script_",
				"pylive\\pylive\\QtScriptEditor\\script_edit.py"
			],
			[
				"scriptedit",
				"pylive\\pylive\\QtScriptEditor\\script_edit.py"
			],
			[
				"cell_s",
				"pylive\\pylive\\QtScriptEditor\\cell_support.py"
			],
			[
				"live_framewo",
				"pylive\\pylive\\QtLiveFramework\\live_framework_with_exec.py"
			],
			[
				"link file",
				"pylive\\expreiments\\file_textdocument_link.py"
			],
			[
				"jedi",
				"pylive\\pylive\\QtScriptEditor\\components\\jedi_completer.py"
			],
			[
				"with_exec",
				"pylive\\pylive\\QtLiveFramework\\live_framework_with_exec.py"
			],
			[
				"framew",
				"pylive\\pylive\\QtLiveFramework\\live_framework_skeleton.py"
			],
			[
				"moderngl",
				"pylive\\pylive\\render_engine\\glwidget_with_moderngl.py"
			],
			[
				"modenr",
				"pylive\\expreiments\\3d_rendering\\pygame_moderngl_boilerplate.py"
			],
			[
				"regl",
				"pylive\\pylive\\render_engine\\regl\\regl.py"
			],
			[
				"logwind",
				"pylive\\pylive\\logwindow.py"
			],
			[
				"resou",
				"pylive\\pylive\\render_engine\\resource_manager.py"
			],
			[
				"render",
				"pylive\\pylive\\render_engine\\render_layers.py"
			],
			[
				"resource",
				"pylive\\pylive\\render_engine\\resource_manager.py"
			],
			[
				"modern",
				"pylive\\pylive\\render_engine\\glwidget_with_moderngl.py"
			],
			[
				"unifie",
				"pylive\\expreiments\\unified_titlebar.py"
			],
			[
				"camer",
				"pylive\\pylive\\render_engine\\camera.py"
			],
			[
				"linter",
				"pylive\\pylive\\QtScriptEditor\\components\\linter_widget.py"
			],
			[
				"Script",
				"pylive\\pylive\\QtScriptEditor\\script_edit.py"
			],
			[
				"camera",
				"pylive\\pylive\\render_engine\\camera.py"
			],
			[
				"orbit",
				"pylive\\pylive\\render_engine\\orbit_control.py"
			],
			[
				"renderl",
				"pylive\\pylive\\render_engine\\render_layers.py"
			],
			[
				"live",
				"pylive\\pylive\\examples\\livescript.py"
			],
			[
				"orbitcon",
				"pylive\\expreiments\\3d_rendering\\orbit_control.py"
			],
			[
				"script",
				"pylive\\pylive\\QtScriptEditor\\script_edit.py"
			],
			[
				"number editor",
				"pylive\\pylive\\QtScriptEditor\\components\\textedit_number_editor.py"
			],
			[
				"whitespace",
				"pylive\\pylive\\QtScriptEditor\\components\\WhitespaceHighlighter.py"
			],
			[
				"pygme",
				"pylive\\pylive\\QtScriptEditor\\components\\pygments_syntax_highlighter.py"
			],
			[
				"highlighte",
				"pylive\\pylive\\QtScriptEditor\\highlighters.py"
			],
			[
				"textedito",
				"pylive\\pylive\\QtScriptEditor\\components\\textedit_completer.py"
			],
			[
				"keywo",
				"pylive\\pylive\\QtScriptEditor\\components\\KeywordsCompleter.py"
			],
			[
				"scrip",
				"pylive\\pylive\\QtScriptEditor\\ScriptEdit.py"
			],
			[
				"logw",
				"pylive\\pylive\\logwindow.py"
			],
			[
				"capture",
				"pylive\\.venv\\Lib\\site-packages\\IPython\\utils\\capture.py"
			],
			[
				"preview",
				"pylive\\pylive\\preview_widget.py"
			],
			[
				"pan",
				"pylive\\pylive\\QtGraphEditor\\PanAndZoomGraphicsView.py"
			],
			[
				"panand",
				"pylive\\pylive\\QtGraphEditor\\PanAndZoomGraphicsView.py"
			],
			[
				"visu",
				"pylive\\pylive\\examples\\visual_coding.py"
			],
			[
				"log",
				"pylive\\pylive\\logwindow.py"
			],
			[
				"livescript",
				"pylive\\pylive\\LiveScript.py"
			],
			[
				"mind",
				"pylive\\pylive\\QtGraphEditor\\mindmap_example.py"
			]
		],
		"width": 0.0
	},
	"select_project":
	{
		"height": 500.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 380.0
	},
	"select_symbol":
	{
		"height": 59.3333333333,
		"last_filter": "setSelec",
		"selected_items":
		[
			[
				"setSelec",
				"setSelectionModel"
			],
			[
				"setSource",
				"setSourceOutlet"
			],
			[
				"circle",
				"CircleWidget"
			]
		],
		"width": 592.0
	},
	"selected_group": 0,
	"settings":
	{
		"lsp_show_inlay_hints": false
	},
	"show_minimap": true,
	"show_open_files": false,
	"show_tabs": true,
	"side_bar_visible": true,
	"side_bar_width": 440.0,
	"status_bar_visible": true,
	"template_settings":
	{
	}
}
